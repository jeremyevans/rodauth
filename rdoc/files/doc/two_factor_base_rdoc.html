<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>two_factor_base.rdoc</title>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='file' id='wrapper'>
<div class='header'>
<h1 class='name'>two_factor_base.rdoc
</h1>
<div class='paths'>
doc/two_factor_base.rdoc
</div>
</div>
<div id='content'>
<div id='text'>
<div id='description'>
<h1 id="label-Documentation+for+Two+Factor+Base+Feature">Documentation for Two Factor Base Feature<span><a href="#label-Documentation+for+Two+Factor+Base+Feature">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p>The <a href="two_factor_base_rdoc.html">two_factor_base</a> feature implements shared functionality for the other multifactor authentication features.</p>

<p>To handle multiple and potentially different multifactor authentication setups per user, this feature implements disambiguation pages for multifactor authentication and manage.  If only a single multifactor authentication is available to setup, the manage page will redirect to the appropriate page. Likewise, if only a single multifactor authentication method is available, the authentication page will redirect to the appropriate page.  Otherwise, the authentication and manage pages will show links to the available pages. Additionally, there is a separate page for disabling all multifactor authentication methods and reverting to single factor authentication, so users do not have to disable each multifactor authentication method individually.</p>

<h2 id="label-Auth+Value+Methods">Auth Value Methods<span><a href="#label-Auth+Value+Methods">&para;</a> <a href="#top">&uarr;</a></span></h2>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>two_factor_already_authenticated_error_flash </td><td>
<p>The flash error to show if going to a multifactor authentication page when already multifactor authenticated.</p>
</td></tr><tr><td class='label'>two_factor_already_authenticated_error_status </td><td>
<p>The response status to use if going to a multifactor authentication page when already multifactor authenticated, 403 by default.</p>
</td></tr><tr><td class='label'>two_factor_already_authenticated_redirect </td><td>
<p>Where to redirect if going to a multifactor authentication page when already multifactor authenticated.</p>
</td></tr><tr><td class='label'>two_factor_auth_notice_flash </td><td>
<p>The flash notice to show after a successful multifactor authentication.</p>
</td></tr><tr><td class='label'>two_factor_auth_page_title </td><td>
<p>The page title to use on the page linking to other multifactor authentication pages.</p>
</td></tr><tr><td class='label'>two_factor_auth_redirect </td><td>
<p>Where to redirect after a successful multifactor authentication.</p>
</td></tr><tr><td class='label'>two_factor_auth_redirect_session_key </td><td>
<p>The key in the session hash storing the location to redirect to after successful multifactor authentication.</p>
</td></tr><tr><td class='label'>two_factor_auth_required_redirect </td><td>
<p>Where to redirect if going to a page requiring multifactor authentication when not multifactor authenticated (the multifactor auth page by default).</p>
</td></tr><tr><td class='label'>two_factor_auth_return_to_requested_location? </td><td>
<p>Whether to redirect to the originally requested location after successful multifactor authentication when <code>require_two_factor_authenticated</code> was used, false by default.</p>
</td></tr><tr><td class='label'>two_factor_auth_route </td><td>
<p>The route to the multifactor authentication page. Defaults to <code>multifactor-auth</code>.</p>
</td></tr><tr><td class='label'>two_factor_disable_additional_form_tags </td><td>
<p>HTML fragment containing additional form tags when disabling all multifactor authentication.</p>
</td></tr><tr><td class='label'>two_factor_disable_button </td><td>
<p>Text to use for button on the form to disable all multifactor authentication.</p>
</td></tr><tr><td class='label'>two_factor_disable_error_flash </td><td>
<p>The flash error to show if unable to disable all multifactor authentication.</p>
</td></tr><tr><td class='label'>two_factor_disable_link_text </td><td>
<p>The text to use for the link to disable all multifactor authentication from the multifactor manage page.</p>
</td></tr><tr><td class='label'>two_factor_disable_notice_flash </td><td>
<p>The flash notice to show after a successfully disabling all multifactor authentication.</p>
</td></tr><tr><td class='label'>two_factor_disable_page_title </td><td>
<p>The page title to use on the page for disabling all multifactor authentication.</p>
</td></tr><tr><td class='label'>two_factor_disable_redirect </td><td>
<p>Where to redirect after a successfully disabling all multifactor authentication.</p>
</td></tr><tr><td class='label'>two_factor_disable_route </td><td>
<p>The route to the page to disable all multifactor authentication. Defaults to <code>multifactor-disable</code>.</p>
</td></tr><tr><td class='label'>two_factor_manage_page_title </td><td>
<p>The page title to use on the page linking to other multifactor setup and remove pages.</p>
</td></tr><tr><td class='label'>two_factor_manage_route </td><td>
<p>The route to the page to manage multifactor authentication. Defaults to <code>multifactor-manage</code>.</p>
</td></tr><tr><td class='label'>two_factor_modifications_require_password? </td><td>
<p>Whether modifications to multifactor authentication require the inputing the userâ€™s password.</p>
</td></tr><tr><td class='label'>two_factor_need_authentication_error_flash </td><td>
<p>The flash error to show if going to a page that requires multifactor authentication when not authenticated.</p>
</td></tr><tr><td class='label'>two_factor_need_authentication_error_status </td><td>
<p>The response status to use if going to a page that requires multifactor authentication when not authenticated, 401 by default.</p>
</td></tr><tr><td class='label'>two_factor_need_setup_redirect </td><td>
<p>Where to redirect if going to a multifactor authentication page when multifactor authentication has not been setup (the multifactor manage page by default).</p>
</td></tr><tr><td class='label'>two_factor_not_setup_error_flash </td><td>
<p>The flash error to show if going to a multifactor authentication page when multifactor authentication has not been setup.</p>
</td></tr><tr><td class='label'>two_factor_not_setup_error_status </td><td>
<p>The response status to use if going to a multifactor authentication page when multifactor authentication has not been setup, 403 by default.</p>
</td></tr><tr><td class='label'>two_factor_remove_heading </td><td>
<p>The HTML to use above the remove links on the multifactor manage page.</p>
</td></tr><tr><td class='label'>two_factor_setup_heading </td><td>
<p>The HTML to use above the setup links on the multifactor manage page.</p>
</td></tr><tr><td class='label'>two_factor_setup_session_key </td><td>
<p>The session key used for storing whether multifactor authentication has been setup for the current account.</p>
</td></tr></tbody></table>

<h2 id="label-Auth+Methods">Auth Methods<span><a href="#label-Auth+Methods">&para;</a> <a href="#top">&uarr;</a></span></h2>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>after_two_factor_authentication </td><td>
<p>Any actions to take after successful multifactor authentication.</p>
</td></tr><tr><td class='label'>after_two_factor_disable </td><td>
<p>Any actions to take after successful disabling of all multifactor authentication.</p>
</td></tr><tr><td class='label'>before_two_factor_auth_route </td><td>
<p>Run arbitrary code before handling the multifactor auth route.</p>
</td></tr><tr><td class='label'>before_two_factor_disable </td><td>
<p>Any actions to take before disabling of all multifactor authentication.</p>
</td></tr><tr><td class='label'>before_two_factor_disable_route </td><td>
<p>Run arbitrary code before handling the multifactor disable route.</p>
</td></tr><tr><td class='label'>before_two_factor_manage_route </td><td>
<p>Run arbitrary code before handling the multifactor manage route.</p>
</td></tr><tr><td class='label'>two_factor_auth_links </td><td>
<p>An array of entries for links to show on the multifactor auth page.  Each entry is an array of three elements, sort order (integer), link href, and link text.</p>
</td></tr><tr><td class='label'>two_factor_auth_response </td><td>
<p>Return a response after successful multifactor authentication. By default, redirects to <code>two_factor_auth_redirect</code>  (or the requested location if <code>two_factor_auth_return_to_requested_location?</code> is true).</p>
</td></tr><tr><td class='label'>two_factor_auth_view </td><td>
<p>The HTML to use for the page linking to other multifactor authentication pages.</p>
</td></tr><tr><td class='label'>two_factor_authenticated? </td><td>
<p>Whether the current session has already been multifactor authenticated.</p>
</td></tr><tr><td class='label'>two_factor_disable_response </td><td>
<p>Return a response after successfully disabling multifactor authentication. By default, redirects to <code>two_factor_disable_redirect</code>.</p>
</td></tr><tr><td class='label'>two_factor_disable_view </td><td>
<p>The HTML to use for the page for disabling all multifactor authentication.</p>
</td></tr><tr><td class='label'>two_factor_manage_view </td><td>
<p>The HTML to use for the page linking to other multifactor setup and remove pages.</p>
</td></tr><tr><td class='label'>two_factor_remove </td><td>
<p>Any action to take to remove multifactor authentication, called when closing accounts.</p>
</td></tr><tr><td class='label'>two_factor_remove_auth_failures </td><td>
<p>Any action to take to remove multifactor authentication failures, called after a successful multifactor authentication.</p>
</td></tr><tr><td class='label'>two_factor_remove_links </td><td>
<p>An array of entries for remove links to show on the multifactor manage page.  Each entry is an array of three elements, sort order (integer), link href, and link text.</p>
</td></tr><tr><td class='label'>two_factor_remove_session </td><td>
<p>What actions to take to remove multifactor authentication status from the session, called when disabling multifactor authentication when authenticated using the factor being removed.</p>
</td></tr><tr><td class='label'>two_factor_setup_links </td><td>
<p>An array of entries for setup links to show on the multifactor manage page.  Each entry is an array of three elements, sort order (integer), link href, and link text.</p>
</td></tr><tr><td class='label'>two_factor_update_session(type) </td><td>
<p>How to update the session to reflect a successful multifactor authentication.</p>
</td></tr></tbody></table>
</div>
<div id='context'>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/jeremyevans/hanna"><strong>Hanna</strong> RDoc template</a>
</div>
</body>
</html>
