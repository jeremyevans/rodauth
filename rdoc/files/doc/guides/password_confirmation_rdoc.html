<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>password_confirmation.rdoc</title>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='file' id='wrapper'>
<div class='header'>
<h1 class='name'>password_confirmation.rdoc
</h1>
<div class='paths'>
doc/guides/password_confirmation.rdoc
</div>
</div>
<div id='content'>
<div id='text'>
<div id='description'>
<h1 id="label-Require+password+confirmation+for+certain+actions">Require password confirmation for certain actions<span><a href="#label-Require+password+confirmation+for+certain+actions">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p>You might want to require the user to enter their password before accessing sensitive sections of the app. This functionality is provided by the confirm password feature, which accompanied with the password grace period feature will remember the entered password for a period of time:</p>

<pre class="ruby"><span class="ruby-identifier">plugin</span> <span class="ruby-value">:rodauth</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">enable</span> <span class="ruby-value">:confirm_password</span>, <span class="ruby-value">:password_grace_period</span>

  <span class="ruby-comment"># Remember the password for 1 hour</span>
  <span class="ruby-identifier">password_grace_period</span> <span class="ruby-value">60</span><span class="ruby-operator">*</span><span class="ruby-value">60</span>
<span class="ruby-keyword">end</span>

<span class="ruby-identifier">route</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
  <span class="ruby-identifier">r</span>.<span class="ruby-identifier">rodauth</span>

  <span class="ruby-identifier">r</span>.<span class="ruby-identifier">is</span> <span class="ruby-string">&#39;some-action&#39;</span> <span class="ruby-keyword">do</span>
    <span class="ruby-comment"># Require password authentication if the password has not been</span>
    <span class="ruby-comment"># input recently.</span>
    <span class="ruby-identifier">rodauth</span>.<span class="ruby-identifier">require_password_authentication</span>

    <span class="ruby-comment"># ...</span>
  <span class="ruby-keyword">end</span>
<span class="ruby-keyword">end</span>
</pre>

<p>You can also do this for <a href="../../../classes/Rodauth.html"><code>Rodauth</code></a> actions that normally require a password. Which essentially moves the password confirmation into a separate step, as Rodauthâ€™s behavior with the password grace period feature is to ask for the password on the same form.</p>

<pre class="ruby"><span class="ruby-identifier">plugin</span> <span class="ruby-value">:rodauth</span> <span class="ruby-keyword">do</span>
  <span class="ruby-identifier">enable</span> <span class="ruby-value">:confirm_password</span>, <span class="ruby-value">:password_grace_period</span>, <span class="ruby-value">:change_login</span>, <span class="ruby-value">:change_password</span>

  <span class="ruby-identifier">before_change_login_route</span>    { <span class="ruby-identifier">require_password_authentication</span> }
  <span class="ruby-identifier">before_change_password_route</span> { <span class="ruby-identifier">require_password_authentication</span> }
<span class="ruby-keyword">end</span>
</pre>
</div>
<div id='context'>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/jeremyevans/hanna"><strong>Hanna</strong> RDoc template</a>
</div>
</body>
</html>
