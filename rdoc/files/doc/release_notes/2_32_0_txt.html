<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>2.32.0.txt</title>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='file' id='wrapper'>
<div class='header'>
<h1 class='name'>2.32.0.txt
</h1>
<div class='paths'>
doc/release_notes/2.32.0.txt
</div>
</div>
<div id='content'>
<div id='text'>
<div id='description'>
<h1 id="label-New+Features">New Features<span><a href="#label-New+Features">&para;</a> <a href="#top">&uarr;</a></span></h1>
<ul><li>
<p><a href="../../../classes/Rodauth.html"><code>Rodauth</code></a> now supports secret rotation using the following configuration methods:</p>
<ul><li>
<p>hmac_old_secret</p>
</li><li>
<p>argon2_old_secret (argon2 feature)</p>
</li><li>
<p>jwt_old_secret (jwt feature)</p>
</li></ul>

<p>You can use these methods to specify the previous secret when rotating secrets.  Note that full secret rotation (where you can remove use of the old secret) may not be simple.  Here are some cases that require additional work:</p>
<ul><li>
<p>Rotating the argon2 secret requires the use of the <a href="../update_password_hash_rdoc.html">update_password_hash</a> feature.  You cannot remove the use of argon2_old_secret unless every user who created a password under the old secret has logged in after the new secret was added. Removing the old secret before a user has logged in after the new secret was added will invalidate the password for the user. Thus, full rotation of the argon2 secret requires invalidating passwords for inactive accounts.</p>
</li><li>
<p>Full rotating of the hmac secret when using the remember feature requires that all remember cookies created under the previous secret has been removed.  By default, remember cookies expire in 2 weeks, but it is possible to set them much longer.</p>
</li><li>
<p>Full rotation of the hmac secret when using the <a href="../verify_account_rdoc.html">verify_account</a> feature requires invalidating old verify account links, since verify account links do not have a deadline.  However, after old verify account links have been invalidated, a user can request a new verify account link, which will work.</p>
</li><li>
<p>Full rotation of the hmac secret when using the otp feature requires disabling otp and reenabling otp.  The otp_valid_code_for_old_secret configuration method has been added, which can be used to handle cases where a user successfully authenticated via TOTP using the old secret.  This can be used to direct them to a page to remove the TOTP authenticator and then setup a new TOTP authenticator.</p>
</li></ul>
</li><li>
<p>Many *_response configuration methods have been added, which allow users to override Rodauth’s default behavior in successful cases of setting a flash notice and then redirecting.  Note that using these configuration methods correctly requires that they halt request processing.  You cannot just have them return a response body.  You can use the return_response method to set the response body and halt processing.</p>
</li><li>
<p>An sms_needs_confirmation_notice_flash configuration method has been added, for setting the flash notice when setting up SMS authentication.  By default, it uses the sms_needs_confirmation_error_flash value.</p>
</li></ul>

<h1 id="label-Other+Improvements">Other Improvements<span><a href="#label-Other+Improvements">&para;</a> <a href="#top">&uarr;</a></span></h1>
<ul><li>
<p>The argon2 feature no longer uses the Base64 constant.  Previously, it uses the library without attempting to require the base64 library, which would break if the base64 library was not already required.</p>
</li><li>
<p>Rodauth’s documentation now recommends against the use of the argon2 feature, because for typical interactive login uses (targetting sub-200ms response times), argon2 provides significantly worse security than bcrypt.</p>
</li></ul>
</div>
<div id='context'>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/jeremyevans/hanna"><strong>Hanna</strong> RDoc template</a>
</div>
</body>
</html>
