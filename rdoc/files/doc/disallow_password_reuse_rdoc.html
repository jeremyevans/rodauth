<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>disallow_password_reuse.rdoc</title>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='file' id='wrapper'>
<div class='header'>
<h1 class='name'>disallow_password_reuse.rdoc
</h1>
<div class='paths'>
doc/disallow_password_reuse.rdoc
</div>
</div>
<div id='content'>
<div id='text'>
<div id='description'>
<h1 id="label-Documentation+for+Disallow+Password+Reuse+Feature">Documentation for Disallow Password Reuse Feature<span><a href="#label-Documentation+for+Disallow+Password+Reuse+Feature">&para;</a> <a href="#top">&uarr;</a></span></h1>

<p>The disallow password reuse feature disallows setting of a password that matches a number of previous passwords (6 by default).</p>

<p>On databases where <a href="../../classes/Rodauth.html"><code>Rodauth</code></a> supports the use of database authentication functions, <a href="../../classes/Rodauth.html"><code>Rodauth</code></a> also supports the use of database functions for checking previous passwords, so previous password hashes enjoy the same database security as current password hashes.</p>

<p>It is not recommended to use this feature unless you have a policy that requires it.  This will significantly slow down setting a new password due to the need to check all of the previous stored passwords.  Additionally, storing previous passwords means that if attackers can get access to the the database, they can get the previous stored passwords in addition to the current password.</p>

<h2 id="label-Auth+Value+Methods">Auth Value Methods<span><a href="#label-Auth+Value+Methods">&para;</a> <a href="#top">&uarr;</a></span></h2>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>password_same_as_previous_password_message </td><td>
<p>The error message fragment to display if the given password is the same as a previous password.</p>
</td></tr><tr><td class='label'>previous_password_account_id_column </td><td>
<p>The column in the <code>previous_password_hash_table</code> that stores the account id.</p>
</td></tr><tr><td class='label'>previous_password_hash_column </td><td>
<p>The column in the <code>previous_password_hash_table</code> that stores the password hash.</p>
</td></tr><tr><td class='label'>previous_password_hash_table </td><td>
<p>The table storing previous password hashes.</p>
</td></tr><tr><td class='label'>previous_password_id_column </td><td>
<p>The column in the <code>previous_password_hash_table</code> that stores the autoincrementing primary key.</p>
</td></tr><tr><td class='label'>previous_passwords_to_check </td><td>
<p>The number of previous password hashes to store and check.</p>
</td></tr></tbody></table>

<h2 id="label-Auth+Methods">Auth Methods<span><a href="#label-Auth+Methods">&para;</a> <a href="#top">&uarr;</a></span></h2>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>add_previous_password_hash(hash) </td><td>
<p>Add the given hash to the list of previous hashes for the current account.</p>
</td></tr><tr><td class='label'>password_doesnt_match_previous_password?(password) </td><td>
<p>Whether the password given matches any of the previous passwords.</p>
</td></tr></tbody></table>
</div>
<div id='context'>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/jeremyevans/hanna"><strong>Hanna</strong> RDoc template</a>
</div>
</body>
</html>
