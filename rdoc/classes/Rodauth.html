<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>Rodauth</title>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='class' id='wrapper'>
<div class='header'>
<h1 class='name'><span class='type'>module</span>
Rodauth
</h1>
<ol class='paths'>
<li>
<a href="../files/lib/rodauth_rb.html">lib/rodauth.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/account_expiration_rb.html">lib/rodauth/features/account_expiration.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/active_sessions_rb.html">lib/rodauth/features/active_sessions.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/argon2_rb.html">lib/rodauth/features/argon2.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/audit_logging_rb.html">lib/rodauth/features/audit_logging.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/base_rb.html">lib/rodauth/features/base.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/change_login_rb.html">lib/rodauth/features/change_login.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/change_password_rb.html">lib/rodauth/features/change_password.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/change_password_notify_rb.html">lib/rodauth/features/change_password_notify.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/close_account_rb.html">lib/rodauth/features/close_account.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/confirm_password_rb.html">lib/rodauth/features/confirm_password.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/create_account_rb.html">lib/rodauth/features/create_account.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/disallow_common_passwords_rb.html">lib/rodauth/features/disallow_common_passwords.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/disallow_password_reuse_rb.html">lib/rodauth/features/disallow_password_reuse.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/email_auth_rb.html">lib/rodauth/features/email_auth.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/email_base_rb.html">lib/rodauth/features/email_base.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/http_basic_auth_rb.html">lib/rodauth/features/http_basic_auth.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/internal_request_rb.html">lib/rodauth/features/internal_request.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/json_rb.html">lib/rodauth/features/json.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/jwt_rb.html">lib/rodauth/features/jwt.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/jwt_cors_rb.html">lib/rodauth/features/jwt_cors.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/jwt_refresh_rb.html">lib/rodauth/features/jwt_refresh.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/lockout_rb.html">lib/rodauth/features/lockout.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/login_rb.html">lib/rodauth/features/login.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/login_password_requirements_base_rb.html">lib/rodauth/features/login_password_requirements_base.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/logout_rb.html">lib/rodauth/features/logout.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/otp_rb.html">lib/rodauth/features/otp.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/otp_lockout_email_rb.html">lib/rodauth/features/otp_lockout_email.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/otp_modify_email_rb.html">lib/rodauth/features/otp_modify_email.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/otp_unlock_rb.html">lib/rodauth/features/otp_unlock.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/password_complexity_rb.html">lib/rodauth/features/password_complexity.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/password_expiration_rb.html">lib/rodauth/features/password_expiration.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/password_grace_period_rb.html">lib/rodauth/features/password_grace_period.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/password_pepper_rb.html">lib/rodauth/features/password_pepper.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/path_class_methods_rb.html">lib/rodauth/features/path_class_methods.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/recovery_codes_rb.html">lib/rodauth/features/recovery_codes.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/remember_rb.html">lib/rodauth/features/remember.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/reset_password_rb.html">lib/rodauth/features/reset_password.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/reset_password_notify_rb.html">lib/rodauth/features/reset_password_notify.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/session_expiration_rb.html">lib/rodauth/features/session_expiration.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/single_session_rb.html">lib/rodauth/features/single_session.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/sms_codes_rb.html">lib/rodauth/features/sms_codes.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/two_factor_base_rb.html">lib/rodauth/features/two_factor_base.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/update_password_hash_rb.html">lib/rodauth/features/update_password_hash.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/verify_account_rb.html">lib/rodauth/features/verify_account.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/verify_account_grace_period_rb.html">lib/rodauth/features/verify_account_grace_period.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/verify_login_change_rb.html">lib/rodauth/features/verify_login_change.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/webauthn_rb.html">lib/rodauth/features/webauthn.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/webauthn_autofill_rb.html">lib/rodauth/features/webauthn_autofill.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/webauthn_login_rb.html">lib/rodauth/features/webauthn_login.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/webauthn_modify_email_rb.html">lib/rodauth/features/webauthn_modify_email.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/features/webauthn_verify_account_rb.html">lib/rodauth/features/webauthn_verify_account.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/migrations_rb.html">lib/rodauth/migrations.rb</a>
</li>
<li class='other'>
<a href="../files/lib/rodauth/version_rb.html">lib/rodauth/version.rb</a>
</li>
<li>
<a class='show' href='#' onclick='this.parentNode.parentNode.className += &quot; expanded&quot;; this.parentNode.removeChild(this); return false'>show all</a>
</li>
</ol>
</div>
<div id='content'>
<div id='text'>
<div id='description'>
<p>:nocov:</p>
</div>
<div id='method-list'>
<h2>Methods</h2>
<h3>Public Class</h3>
<ol>
<li><a href="#method-c-configure">configure</a></li>
<li><a href="#method-c-create_database_authentication_functions">create_database_authentication_functions</a></li>
<li><a href="#method-c-create_database_previous_password_check_functions">create_database_previous_password_check_functions</a></li>
<li><a href="#method-c-drop_database_authentication_functions">drop_database_authentication_functions</a></li>
<li><a href="#method-c-drop_database_previous_password_check_functions">drop_database_previous_password_check_functions</a></li>
<li><a href="#method-c-lib">lib</a></li>
<li><a href="#method-c-load_dependencies">load_dependencies</a></li>
<li><a href="#method-c-new">new</a></li>
<li><a href="#method-c-version">version</a></li>
</ol>
<h3>Public Instance</h3>
<ol>
<li><a href="#method-i-_account_from_email_auth_key">_account_from_email_auth_key</a></li>
<li><a href="#method-i-_account_from_id">_account_from_id</a></li>
<li><a href="#method-i-_account_from_login">_account_from_login</a></li>
<li><a href="#method-i-_account_from_refresh_token">_account_from_refresh_token</a></li>
<li><a href="#method-i-_account_from_reset_password_key">_account_from_reset_password_key</a></li>
<li><a href="#method-i-_account_from_session">_account_from_session</a></li>
<li><a href="#method-i-_account_from_unlock_key">_account_from_unlock_key</a></li>
<li><a href="#method-i-_account_from_verify_account_key">_account_from_verify_account_key</a></li>
<li><a href="#method-i-_account_from_verify_login_change_key">_account_from_verify_login_change_key</a></li>
<li><a href="#method-i-_account_refresh_token_split">_account_refresh_token_split</a></li>
<li><a href="#method-i-_around_rodauth">_around_rodauth</a></li>
<li><a href="#method-i-_email_auth_request">_email_auth_request</a></li>
<li><a href="#method-i-_field_attributes">_field_attributes</a></li>
<li><a href="#method-i-_field_error_attributes">_field_error_attributes</a></li>
<li><a href="#method-i-_filter_links">_filter_links</a></li>
<li><a href="#method-i-_formatted_field_error">_formatted_field_error</a></li>
<li><a href="#method-i-_get_remember_cookie">_get_remember_cookie</a></li>
<li><a href="#method-i-_json_response_body">_json_response_body</a></li>
<li><a href="#method-i-_jwt_decode_opts">_jwt_decode_opts</a></li>
<li><a href="#method-i-_jwt_decode_secrets">_jwt_decode_secrets</a></li>
<li><a href="#method-i-_login">_login</a></li>
<li><a href="#method-i-_login_form_footer">_login_form_footer</a></li>
<li><a href="#method-i-_login_form_footer_links">_login_form_footer_links</a></li>
<li><a href="#method-i-_login_response">_login_response</a></li>
<li><a href="#method-i-_merge_fixed_locals_opts">_merge_fixed_locals_opts</a></li>
<li><a href="#method-i-_multi_phase_login_forms">_multi_phase_login_forms</a></li>
<li><a href="#method-i-_new_account">_new_account</a></li>
<li><a href="#method-i-_otp">_otp</a></li>
<li><a href="#method-i-_otp_add_key">_otp_add_key</a></li>
<li><a href="#method-i-_otp_for_key">_otp_for_key</a></li>
<li><a href="#method-i-_otp_interval">_otp_interval</a></li>
<li><a href="#method-i-_otp_key">_otp_key</a></li>
<li><a href="#method-i-_otp_tmp_key">_otp_tmp_key</a></li>
<li><a href="#method-i-_otp_valid_code-3F">_otp_valid_code?</a></li>
<li><a href="#method-i-_otp_valid_code_for_old_secret">_otp_valid_code_for_old_secret</a></li>
<li><a href="#method-i-_override_webauthn_credential_response_verify">_override_webauthn_credential_response_verify</a></li>
<li><a href="#method-i-_process_raw_hmac">_process_raw_hmac</a></li>
<li><a href="#method-i-_recovery_codes">_recovery_codes</a></li>
<li><a href="#method-i-_return_json_response">_return_json_response</a></li>
<li><a href="#method-i-_set_otp_unlock_info">_set_otp_unlock_info</a></li>
<li><a href="#method-i-_set_remember_cookie">_set_remember_cookie</a></li>
<li><a href="#method-i-_setup_account_lockouts_hash">_setup_account_lockouts_hash</a></li>
<li><a href="#method-i-_sms">_sms</a></li>
<li><a href="#method-i-_sms_request_response">_sms_request_response</a></li>
<li><a href="#method-i-_template_opts">_template_opts</a></li>
<li><a href="#method-i-_two_factor_auth_links">_two_factor_auth_links</a></li>
<li><a href="#method-i-_two_factor_auth_response">_two_factor_auth_response</a></li>
<li><a href="#method-i-_two_factor_remove_all_from_session">_two_factor_remove_all_from_session</a></li>
<li><a href="#method-i-_two_factor_remove_links">_two_factor_remove_links</a></li>
<li><a href="#method-i-_two_factor_setup_links">_two_factor_setup_links</a></li>
<li><a href="#method-i-_update_login">_update_login</a></li>
<li><a href="#method-i-_view">_view</a></li>
<li><a href="#method-i-_view_opts">_view_opts</a></li>
<li><a href="#method-i-account-21">account!</a></li>
<li><a href="#method-i-account_activity_ds">account_activity_ds</a></li>
<li><a href="#method-i-account_ds">account_ds</a></li>
<li><a href="#method-i-account_expired-3F">account_expired?</a></li>
<li><a href="#method-i-account_expired_at">account_expired_at</a></li>
<li><a href="#method-i-account_from_email_auth_key">account_from_email_auth_key</a></li>
<li><a href="#method-i-account_from_id">account_from_id</a></li>
<li><a href="#method-i-account_from_key">account_from_key</a></li>
<li><a href="#method-i-account_from_login">account_from_login</a></li>
<li><a href="#method-i-account_from_refresh_token">account_from_refresh_token</a></li>
<li><a href="#method-i-account_from_remember_cookie">account_from_remember_cookie</a></li>
<li><a href="#method-i-account_from_reset_password_key">account_from_reset_password_key</a></li>
<li><a href="#method-i-account_from_session">account_from_session</a></li>
<li><a href="#method-i-account_from_unlock_key">account_from_unlock_key</a></li>
<li><a href="#method-i-account_from_verify_account_key">account_from_verify_account_key</a></li>
<li><a href="#method-i-account_from_verify_login_change_key">account_from_verify_login_change_key</a></li>
<li><a href="#method-i-account_from_webauthn_login">account_from_webauthn_login</a></li>
<li><a href="#method-i-account_id">account_id</a></li>
<li><a href="#method-i-account_in_unverified_grace_period-3F">account_in_unverified_grace_period?</a></li>
<li><a href="#method-i-account_initial_status_value">account_initial_status_value</a></li>
<li><a href="#method-i-account_lockouts_ds">account_lockouts_ds</a></li>
<li><a href="#method-i-account_login_failures_ds">account_login_failures_ds</a></li>
<li><a href="#method-i-account_password_hash_column">account_password_hash_column</a></li>
<li><a href="#method-i-account_session_status_filter">account_session_status_filter</a></li>
<li><a href="#method-i-account_table_ds">account_table_ds</a></li>
<li><a href="#method-i-account_webauthn_ids">account_webauthn_ids</a></li>
<li><a href="#method-i-account_webauthn_usage">account_webauthn_usage</a></li>
<li><a href="#method-i-account_webauthn_user_id">account_webauthn_user_id</a></li>
<li><a href="#method-i-active_remember_key_ds">active_remember_key_ds</a></li>
<li><a href="#method-i-active_sessions_ds">active_sessions_ds</a></li>
<li><a href="#method-i-active_sessions_insert_hash">active_sessions_insert_hash</a></li>
<li><a href="#method-i-active_sessions_update_hash">active_sessions_update_hash</a></li>
<li><a href="#method-i-add_active_session">add_active_session</a></li>
<li><a href="#method-i-add_audit_log">add_audit_log</a></li>
<li><a href="#method-i-add_field_error_class">add_field_error_class</a></li>
<li><a href="#method-i-add_previous_password_hash">add_previous_password_hash</a></li>
<li><a href="#method-i-add_recovery_code">add_recovery_code</a></li>
<li><a href="#method-i-add_recovery_codes">add_recovery_codes</a></li>
<li><a href="#method-i-add_remember_key">add_remember_key</a></li>
<li><a href="#method-i-add_webauthn_credential">add_webauthn_credential</a></li>
<li><a href="#method-i-after_change_password">after_change_password</a></li>
<li><a href="#method-i-after_close_account">after_close_account</a></li>
<li><a href="#method-i-after_create_account">after_create_account</a></li>
<li><a href="#method-i-after_login">after_login</a></li>
<li><a href="#method-i-after_login_entered_during_multi_phase_login">after_login_entered_during_multi_phase_login</a></li>
<li><a href="#method-i-after_login_failure">after_login_failure</a></li>
<li><a href="#method-i-after_logout">after_logout</a></li>
<li><a href="#method-i-after_otp_authentication_failure">after_otp_authentication_failure</a></li>
<li><a href="#method-i-after_otp_disable">after_otp_disable</a></li>
<li><a href="#method-i-after_otp_setup">after_otp_setup</a></li>
<li><a href="#method-i-after_otp_unlock_auth_failure">after_otp_unlock_auth_failure</a></li>
<li><a href="#method-i-after_otp_unlock_auth_success">after_otp_unlock_auth_success</a></li>
<li><a href="#method-i-after_otp_unlock_not_yet_available">after_otp_unlock_not_yet_available</a></li>
<li><a href="#method-i-after_refresh_token">after_refresh_token</a></li>
<li><a href="#method-i-after_reset_password">after_reset_password</a></li>
<li><a href="#method-i-after_sms_disable">after_sms_disable</a></li>
<li><a href="#method-i-after_webauthn_remove">after_webauthn_remove</a></li>
<li><a href="#method-i-after_webauthn_setup">after_webauthn_setup</a></li>
<li><a href="#method-i-allow_email_auth-3F">allow_email_auth?</a></li>
<li><a href="#method-i-allow_resending_verify_account_email-3F">allow_resending_verify_account_email?</a></li>
<li><a href="#method-i-already_logged_in">already_logged_in</a></li>
<li><a href="#method-i-argon2_hash_algorithm-3F">argon2_hash_algorithm?</a></li>
<li><a href="#method-i-argon2_hash_cost">argon2_hash_cost</a></li>
<li><a href="#method-i-argon2_password_hash_match-3F">argon2_password_hash_match?</a></li>
<li><a href="#method-i-argon2_password_hash_using_salt_and_secret">argon2_password_hash_using_salt_and_secret</a></li>
<li><a href="#method-i-argon2_salt_option">argon2_salt_option</a></li>
<li><a href="#method-i-audit_log_ds">audit_log_ds</a></li>
<li><a href="#method-i-audit_log_insert_hash">audit_log_insert_hash</a></li>
<li><a href="#method-i-audit_log_message">audit_log_message</a></li>
<li><a href="#method-i-audit_log_message_default">audit_log_message_default</a></li>
<li><a href="#method-i-audit_log_metadata">audit_log_metadata</a></li>
<li><a href="#method-i-auth_class_eval">auth_class_eval</a></li>
<li><a href="#method-i-authenticated-3F">authenticated?</a></li>
<li><a href="#method-i-authenticated_by">authenticated_by</a></li>
<li><a href="#method-i-authenticated_webauthn_id">authenticated_webauthn_id</a></li>
<li><a href="#method-i-auto_add_missing_recovery_codes">auto_add_missing_recovery_codes</a></li>
<li><a href="#method-i-auto_remove_recovery_codes">auto_remove_recovery_codes</a></li>
<li><a href="#method-i-autocomplete_for_field-3F">autocomplete_for_field?</a></li>
<li><a href="#method-i-autologin_session">autologin_session</a></li>
<li><a href="#method-i-autologin_type">autologin_type</a></li>
<li><a href="#method-i-base32_encode">base32_encode</a></li>
<li><a href="#method-i-base_url">base_url</a></li>
<li><a href="#method-i-before_change_login_route">before_change_login_route</a></li>
<li><a href="#method-i-before_change_password_route">before_change_password_route</a></li>
<li><a href="#method-i-before_create_account_route">before_create_account_route</a></li>
<li><a href="#method-i-before_login_attempt">before_login_attempt</a></li>
<li><a href="#method-i-before_logout">before_logout</a></li>
<li><a href="#method-i-before_otp_setup_route">before_otp_setup_route</a></li>
<li><a href="#method-i-before_reset_password">before_reset_password</a></li>
<li><a href="#method-i-before_reset_password_request">before_reset_password_request</a></li>
<li><a href="#method-i-before_rodauth">before_rodauth</a></li>
<li><a href="#method-i-before_two_factor_auth_route">before_two_factor_auth_route</a></li>
<li><a href="#method-i-before_two_factor_manage_route">before_two_factor_manage_route</a></li>
<li><a href="#method-i-before_unlock_account">before_unlock_account</a></li>
<li><a href="#method-i-before_unlock_account_request">before_unlock_account_request</a></li>
<li><a href="#method-i-before_verify_account">before_verify_account</a></li>
<li><a href="#method-i-before_verify_account_route">before_verify_account_route</a></li>
<li><a href="#method-i-before_view_recovery_codes">before_view_recovery_codes</a></li>
<li><a href="#method-i-before_webauthn_auth_route">before_webauthn_auth_route</a></li>
<li><a href="#method-i-before_webauthn_login_route">before_webauthn_login_route</a></li>
<li><a href="#method-i-before_webauthn_remove_route">before_webauthn_remove_route</a></li>
<li><a href="#method-i-before_webauthn_setup_route">before_webauthn_setup_route</a></li>
<li><a href="#method-i-button">button</a></li>
<li><a href="#method-i-button_fixed_locals">button_fixed_locals</a></li>
<li><a href="#method-i-button_opts">button_opts</a></li>
<li><a href="#method-i-can_add_recovery_codes-3F">can_add_recovery_codes?</a></li>
<li><a href="#method-i-catch_error">catch_error</a></li>
<li><a href="#method-i-change_login">change_login</a></li>
<li><a href="#method-i-change_login_notice_flash">change_login_notice_flash</a></li>
<li><a href="#method-i-change_login_requires_password-3F">change_login_requires_password?</a></li>
<li><a href="#method-i-change_password_requires_password-3F">change_password_requires_password?</a></li>
<li><a href="#method-i-check_account_expiration">check_account_expiration</a></li>
<li><a href="#method-i-check_active_session">check_active_session</a></li>
<li><a href="#method-i-check_already_logged_in">check_already_logged_in</a></li>
<li><a href="#method-i-check_csrf">check_csrf</a></li>
<li><a href="#method-i-check_csrf-3F">check_csrf?</a></li>
<li><a href="#method-i-check_password_change_allowed">check_password_change_allowed</a></li>
<li><a href="#method-i-check_session_expiration">check_session_expiration</a></li>
<li><a href="#method-i-check_single_session">check_single_session</a></li>
<li><a href="#method-i-clear_cached_otp">clear_cached_otp</a></li>
<li><a href="#method-i-clear_invalid_login_attempts">clear_invalid_login_attempts</a></li>
<li><a href="#method-i-clear_session">clear_session</a></li>
<li><a href="#method-i-close_account">close_account</a></li>
<li><a href="#method-i-close_account_requires_password-3F">close_account_requires_password?</a></li>
<li><a href="#method-i-compute_hmac">compute_hmac</a></li>
<li><a href="#method-i-compute_hmacs">compute_hmacs</a></li>
<li><a href="#method-i-compute_old_hmac">compute_old_hmac</a></li>
<li><a href="#method-i-compute_raw_hmac">compute_raw_hmac</a></li>
<li><a href="#method-i-compute_raw_hmac_with_secret">compute_raw_hmac_with_secret</a></li>
<li><a href="#method-i-confirm_password">confirm_password</a></li>
<li><a href="#method-i-confirm_password_redirect">confirm_password_redirect</a></li>
<li><a href="#method-i-convert_email_token_key">convert_email_token_key</a></li>
<li><a href="#method-i-convert_response_header_key">convert_response_header_key</a></li>
<li><a href="#method-i-convert_session_key">convert_session_key</a></li>
<li><a href="#method-i-convert_timestamp">convert_timestamp</a></li>
<li><a href="#method-i-convert_token_id">convert_token_id</a></li>
<li><a href="#method-i-convert_token_id_to_integer">convert_token_id_to_integer</a></li>
<li><a href="#method-i-convert_token_key">convert_token_key</a></li>
<li><a href="#method-i-create_account_autologin-3F">create_account_autologin?</a></li>
<li><a href="#method-i-create_account_notice_flash">create_account_notice_flash</a></li>
<li><a href="#method-i-create_account_set_password-3F">create_account_set_password?</a></li>
<li><a href="#method-i-create_email">create_email</a></li>
<li><a href="#method-i-create_email_auth_key">create_email_auth_key</a></li>
<li><a href="#method-i-create_email_to">create_email_to</a></li>
<li><a href="#method-i-create_reset_password_key">create_reset_password_key</a></li>
<li><a href="#method-i-create_verify_account_key">create_verify_account_key</a></li>
<li><a href="#method-i-create_verify_login_change_email">create_verify_login_change_email</a></li>
<li><a href="#method-i-create_verify_login_change_key">create_verify_login_change_key</a></li>
<li><a href="#method-i-csrf_tag">csrf_tag</a></li>
<li><a href="#method-i-currently_active_session-3F">currently_active_session?</a></li>
<li><a href="#method-i-database_function_password_match-3F">database_function_password_match?</a></li>
<li><a href="#method-i-db">db</a></li>
<li><a href="#method-i-delete_account">delete_account</a></li>
<li><a href="#method-i-delete_account_on_close-3F">delete_account_on_close?</a></li>
<li><a href="#method-i-disable_remember_login">disable_remember_login</a></li>
<li><a href="#method-i-domain">domain</a></li>
<li><a href="#method-i-email_auth_ds">email_auth_ds</a></li>
<li><a href="#method-i-email_auth_email_link">email_auth_email_link</a></li>
<li><a href="#method-i-email_auth_email_recently_sent-3F">email_auth_email_recently_sent?</a></li>
<li><a href="#method-i-email_auth_key_insert_hash">email_auth_key_insert_hash</a></li>
<li><a href="#method-i-email_auth_request_form">email_auth_request_form</a></li>
<li><a href="#method-i-email_from">email_from</a></li>
<li><a href="#method-i-email_to">email_to</a></li>
<li><a href="#method-i-expire_session">expire_session</a></li>
<li><a href="#method-i-extend_remember_deadline">extend_remember_deadline</a></li>
<li><a href="#method-i-extend_remember_deadline_while_logged_in-3F">extend_remember_deadline_while_logged_in?</a></li>
<li><a href="#method-i-extract_password_hash_cost">extract_password_hash_cost</a></li>
<li><a href="#method-i-features">features</a></li>
<li><a href="#method-i-field_attributes">field_attributes</a></li>
<li><a href="#method-i-field_error">field_error</a></li>
<li><a href="#method-i-field_error_attributes">field_error_attributes</a></li>
<li><a href="#method-i-flash">flash</a></li>
<li><a href="#method-i-forget_login">forget_login</a></li>
<li><a href="#method-i-formatted_field_error">formatted_field_error</a></li>
<li><a href="#method-i-function_name">function_name</a></li>
<li><a href="#method-i-generate_active_sessions_key">generate_active_sessions_key</a></li>
<li><a href="#method-i-generate_email_auth_key_value">generate_email_auth_key_value</a></li>
<li><a href="#method-i-generate_refresh_token">generate_refresh_token</a></li>
<li><a href="#method-i-generate_remember_key_value">generate_remember_key_value</a></li>
<li><a href="#method-i-generate_reset_password_key_value">generate_reset_password_key_value</a></li>
<li><a href="#method-i-generate_unlock_account_key">generate_unlock_account_key</a></li>
<li><a href="#method-i-generate_verify_account_key_value">generate_verify_account_key_value</a></li>
<li><a href="#method-i-generate_verify_login_change_key_value">generate_verify_login_change_key_value</a></li>
<li><a href="#method-i-get_active_refresh_token">get_active_refresh_token</a></li>
<li><a href="#method-i-get_activity_timestamp">get_activity_timestamp</a></li>
<li><a href="#method-i-get_email_auth_email_last_sent">get_email_auth_email_last_sent</a></li>
<li><a href="#method-i-get_email_auth_key">get_email_auth_key</a></li>
<li><a href="#method-i-get_password_changed_at">get_password_changed_at</a></li>
<li><a href="#method-i-get_password_hash">get_password_hash</a></li>
<li><a href="#method-i-get_password_reset_key">get_password_reset_key</a></li>
<li><a href="#method-i-get_remember_key">get_remember_key</a></li>
<li><a href="#method-i-get_reset_password_email_last_sent">get_reset_password_email_last_sent</a></li>
<li><a href="#method-i-get_unlock_account_email_last_sent">get_unlock_account_email_last_sent</a></li>
<li><a href="#method-i-get_unlock_account_key">get_unlock_account_key</a></li>
<li><a href="#method-i-get_verify_account_email_last_sent">get_verify_account_email_last_sent</a></li>
<li><a href="#method-i-get_verify_account_key">get_verify_account_key</a></li>
<li><a href="#method-i-get_verify_login_change_login_and_key">get_verify_login_change_login_and_key</a></li>
<li><a href="#method-i-handle_duplicate_active_session_id">handle_duplicate_active_session_id</a></li>
<li><a href="#method-i-handle_webauthn_sign_count_verification_error">handle_webauthn_sign_count_verification_error</a></li>
<li><a href="#method-i-has_password-3F">has_password?</a></li>
<li><a href="#method-i-hmac_secret_rotation-3F">hmac_secret_rotation?</a></li>
<li><a href="#method-i-hook_action">hook_action</a></li>
<li><a href="#method-i-http_basic_auth">http_basic_auth</a></li>
<li><a href="#method-i-inactive_session_cond">inactive_session_cond</a></li>
<li><a href="#method-i-include_success_messages-3F">include_success_messages?</a></li>
<li><a href="#method-i-input_field_string">input_field_string</a></li>
<li><a href="#method-i-inputmode_for_field-3F">inputmode_for_field?</a></li>
<li><a href="#method-i-internal_request-3F">internal_request?</a></li>
<li><a href="#method-i-internal_request_configuration">internal_request_configuration</a></li>
<li><a href="#method-i-invalid_login_attempted">invalid_login_attempted</a></li>
<li><a href="#method-i-invalid_previous_password_message">invalid_previous_password_message</a></li>
<li><a href="#method-i-json_request-3F">json_request?</a></li>
<li><a href="#method-i-json_response">json_response</a></li>
<li><a href="#method-i-json_response_error-3F">json_response_error?</a></li>
<li><a href="#method-i-jwt_cors_allow-3F">jwt_cors_allow?</a></li>
<li><a href="#method-i-jwt_payload">jwt_payload</a></li>
<li><a href="#method-i-jwt_refresh_token_account_ds">jwt_refresh_token_account_ds</a></li>
<li><a href="#method-i-jwt_refresh_token_account_token_ds">jwt_refresh_token_account_token_ds</a></li>
<li><a href="#method-i-jwt_refresh_token_ds">jwt_refresh_token_ds</a></li>
<li><a href="#method-i-jwt_refresh_token_insert_hash">jwt_refresh_token_insert_hash</a></li>
<li><a href="#method-i-jwt_refresh_token_match-3F">jwt_refresh_token_match?</a></li>
<li><a href="#method-i-jwt_secret">jwt_secret</a></li>
<li><a href="#method-i-jwt_session_hash">jwt_session_hash</a></li>
<li><a href="#method-i-jwt_token">jwt_token</a></li>
<li><a href="#method-i-last_account_activity_at">last_account_activity_at</a></li>
<li><a href="#method-i-last_account_login_at">last_account_login_at</a></li>
<li><a href="#method-i-load_memory">load_memory</a></li>
<li><a href="#method-i-loaded_templates">loaded_templates</a></li>
<li><a href="#method-i-locked_out-3F">locked_out?</a></li>
<li><a href="#method-i-logged_in_via_remember_key-3F">logged_in_via_remember_key?</a></li>
<li><a href="#method-i-login">login</a></li>
<li><a href="#method-i-login_confirm_label">login_confirm_label</a></li>
<li><a href="#method-i-login_confirmation_matches-3F">login_confirmation_matches?</a></li>
<li><a href="#method-i-login_does_not_meet_requirements_message">login_does_not_meet_requirements_message</a></li>
<li><a href="#method-i-login_failed_reset_password_request_form">login_failed_reset_password_request_form</a></li>
<li><a href="#method-i-login_field_autocomplete_value">login_field_autocomplete_value</a></li>
<li><a href="#method-i-login_form_footer_links">login_form_footer_links</a></li>
<li><a href="#method-i-login_hidden_field">login_hidden_field</a></li>
<li><a href="#method-i-login_input_type">login_input_type</a></li>
<li><a href="#method-i-login_meets_email_requirements-3F">login_meets_email_requirements?</a></li>
<li><a href="#method-i-login_meets_length_requirements-3F">login_meets_length_requirements?</a></li>
<li><a href="#method-i-login_meets_requirements-3F">login_meets_requirements?</a></li>
<li><a href="#method-i-login_param_value">login_param_value</a></li>
<li><a href="#method-i-login_required">login_required</a></li>
<li><a href="#method-i-login_return_to_requested_location_path">login_return_to_requested_location_path</a></li>
<li><a href="#method-i-login_session">login_session</a></li>
<li><a href="#method-i-login_too_long_message">login_too_long_message</a></li>
<li><a href="#method-i-login_too_many_bytes_message">login_too_many_bytes_message</a></li>
<li><a href="#method-i-login_too_short_message">login_too_short_message</a></li>
<li><a href="#method-i-login_uses_email-3F">login_uses_email?</a></li>
<li><a href="#method-i-login_valid_email-3F">login_valid_email?</a></li>
<li><a href="#method-i-logout">logout</a></li>
<li><a href="#method-i-logout_additional_form_tags">logout_additional_form_tags</a></li>
<li><a href="#method-i-modifications_require_password-3F">modifications_require_password?</a></li>
<li><a href="#method-i-new_account">new_account</a></li>
<li><a href="#method-i-new_recovery_code">new_recovery_code</a></li>
<li><a href="#method-i-new_webauthn_credential">new_webauthn_credential</a></li>
<li><a href="#method-i-no_longer_active_session">no_longer_active_session</a></li>
<li><a href="#method-i-normalize_login">normalize_login</a></li>
<li><a href="#method-i-normalize_session_or_flash_key">normalize_session_or_flash_key</a></li>
<li><a href="#method-i-null_byte_parameter_value">null_byte_parameter_value</a></li>
<li><a href="#method-i-only_json-3F">only_json?</a></li>
<li><a href="#method-i-open_account-3F">open_account?</a></li>
<li><a href="#method-i-otp_add_key">otp_add_key</a></li>
<li><a href="#method-i-otp_available-3F">otp_available?</a></li>
<li><a href="#method-i-otp_exists-3F">otp_exists?</a></li>
<li><a href="#method-i-otp_hmac_old_secret">otp_hmac_old_secret</a></li>
<li><a href="#method-i-otp_hmac_secret">otp_hmac_secret</a></li>
<li><a href="#method-i-otp_issuer">otp_issuer</a></li>
<li><a href="#method-i-otp_key_ds">otp_key_ds</a></li>
<li><a href="#method-i-otp_keys_use_hmac-3F">otp_keys_use_hmac?</a></li>
<li><a href="#method-i-otp_last_use">otp_last_use</a></li>
<li><a href="#method-i-otp_locked_out-3F">otp_locked_out?</a></li>
<li><a href="#method-i-otp_lockout_redirect">otp_lockout_redirect</a></li>
<li><a href="#method-i-otp_new_secret">otp_new_secret</a></li>
<li><a href="#method-i-otp_provisioning_name">otp_provisioning_name</a></li>
<li><a href="#method-i-otp_provisioning_uri">otp_provisioning_uri</a></li>
<li><a href="#method-i-otp_qr_code">otp_qr_code</a></li>
<li><a href="#method-i-otp_record_authentication_failure">otp_record_authentication_failure</a></li>
<li><a href="#method-i-otp_remove">otp_remove</a></li>
<li><a href="#method-i-otp_remove_auth_failures">otp_remove_auth_failures</a></li>
<li><a href="#method-i-otp_tmp_key">otp_tmp_key</a></li>
<li><a href="#method-i-otp_unlock_auth_failure">otp_unlock_auth_failure</a></li>
<li><a href="#method-i-otp_unlock_auth_success">otp_unlock_auth_success</a></li>
<li><a href="#method-i-otp_unlock_available-3F">otp_unlock_available?</a></li>
<li><a href="#method-i-otp_unlock_data">otp_unlock_data</a></li>
<li><a href="#method-i-otp_unlock_deadline">otp_unlock_deadline</a></li>
<li><a href="#method-i-otp_unlock_deadline_passed-3F">otp_unlock_deadline_passed?</a></li>
<li><a href="#method-i-otp_unlock_ds">otp_unlock_ds</a></li>
<li><a href="#method-i-otp_unlock_next_auth_attempt_after">otp_unlock_next_auth_attempt_after</a></li>
<li><a href="#method-i-otp_unlock_not_available_set_refresh_header">otp_unlock_not_available_set_refresh_header</a></li>
<li><a href="#method-i-otp_unlock_num_successes">otp_unlock_num_successes</a></li>
<li><a href="#method-i-otp_unlock_refresh_tag">otp_unlock_refresh_tag</a></li>
<li><a href="#method-i-otp_unlock_reset">otp_unlock_reset</a></li>
<li><a href="#method-i-otp_unlock_success_cooldown_seconds">otp_unlock_success_cooldown_seconds</a></li>
<li><a href="#method-i-otp_update_last_use">otp_update_last_use</a></li>
<li><a href="#method-i-otp_user_key">otp_user_key</a></li>
<li><a href="#method-i-otp_valid_code-3F">otp_valid_code?</a></li>
<li><a href="#method-i-otp_valid_key-3F">otp_valid_key?</a></li>
<li><a href="#method-i-over_max_bytesize_param_value">over_max_bytesize_param_value</a></li>
<li><a href="#method-i-param">param</a></li>
<li><a href="#method-i-param_or_nil">param_or_nil</a></li>
<li><a href="#method-i-password_confirm_label">password_confirm_label</a></li>
<li><a href="#method-i-password_does_not_contain_null_byte-3F">password_does_not_contain_null_byte?</a></li>
<li><a href="#method-i-password_does_not_meet_requirements_message">password_does_not_meet_requirements_message</a></li>
<li><a href="#method-i-password_doesnt_match_previous_password-3F">password_doesnt_match_previous_password?</a></li>
<li><a href="#method-i-password_expiration_ds">password_expiration_ds</a></li>
<li><a href="#method-i-password_expired-3F">password_expired?</a></li>
<li><a href="#method-i-password_field_autocomplete_value">password_field_autocomplete_value</a></li>
<li><a href="#method-i-password_has_enough_character_groups-3F">password_has_enough_character_groups?</a></li>
<li><a href="#method-i-password_has_no_invalid_pattern-3F">password_has_no_invalid_pattern?</a></li>
<li><a href="#method-i-password_hash">password_hash</a></li>
<li><a href="#method-i-password_hash_cost">password_hash_cost</a></li>
<li><a href="#method-i-password_hash_ds">password_hash_ds</a></li>
<li><a href="#method-i-password_hash_match-3F">password_hash_match?</a></li>
<li><a href="#method-i-password_hash_using_salt">password_hash_using_salt</a></li>
<li><a href="#method-i-password_match-3F">password_match?</a></li>
<li><a href="#method-i-password_meets_length_requirements-3F">password_meets_length_requirements?</a></li>
<li><a href="#method-i-password_meets_requirements-3F">password_meets_requirements?</a></li>
<li><a href="#method-i-password_not_in_dictionary-3F">password_not_in_dictionary?</a></li>
<li><a href="#method-i-password_not_one_of_the_most_common-3F">password_not_one_of_the_most_common?</a></li>
<li><a href="#method-i-password_not_too_many_repeating_characters-3F">password_not_too_many_repeating_characters?</a></li>
<li><a href="#method-i-password_one_of_most_common-3F">password_one_of_most_common?</a></li>
<li><a href="#method-i-password_recently_entered-3F">password_recently_entered?</a></li>
<li><a href="#method-i-password_reset_ds">password_reset_ds</a></li>
<li><a href="#method-i-password_too_long_message">password_too_long_message</a></li>
<li><a href="#method-i-password_too_many_bytes_message">password_too_many_bytes_message</a></li>
<li><a href="#method-i-password_too_short_message">password_too_short_message</a></li>
<li><a href="#method-i-possible_authentication_methods">possible_authentication_methods</a></li>
<li><a href="#method-i-post_configure">post_configure</a></li>
<li><a href="#method-i-previous_password_ds">previous_password_ds</a></li>
<li><a href="#method-i-raises_uniqueness_violation-3F">raises_uniqueness_violation?</a></li>
<li><a href="#method-i-random_key">random_key</a></li>
<li><a href="#method-i-raw_param">raw_param</a></li>
<li><a href="#method-i-recovery_code_match-3F">recovery_code_match?</a></li>
<li><a href="#method-i-recovery_codes_available-3F">recovery_codes_available?</a></li>
<li><a href="#method-i-recovery_codes_ds">recovery_codes_ds</a></li>
<li><a href="#method-i-recovery_codes_primary-3F">recovery_codes_primary?</a></li>
<li><a href="#method-i-recovery_codes_remove">recovery_codes_remove</a></li>
<li><a href="#method-i-redirect">redirect</a></li>
<li><a href="#method-i-remember_key_ds">remember_key_ds</a></li>
<li><a href="#method-i-remember_login">remember_login</a></li>
<li><a href="#method-i-remembered_session_id">remembered_session_id</a></li>
<li><a href="#method-i-remove_active_session">remove_active_session</a></li>
<li><a href="#method-i-remove_all_active_sessions">remove_all_active_sessions</a></li>
<li><a href="#method-i-remove_all_active_sessions_except_current">remove_all_active_sessions_except_current</a></li>
<li><a href="#method-i-remove_all_active_sessions_except_for">remove_all_active_sessions_except_for</a></li>
<li><a href="#method-i-remove_all_webauthn_keys_and_user_ids">remove_all_webauthn_keys_and_user_ids</a></li>
<li><a href="#method-i-remove_current_session">remove_current_session</a></li>
<li><a href="#method-i-remove_email_auth_key">remove_email_auth_key</a></li>
<li><a href="#method-i-remove_inactive_sessions">remove_inactive_sessions</a></li>
<li><a href="#method-i-remove_jwt_refresh_token_key">remove_jwt_refresh_token_key</a></li>
<li><a href="#method-i-remove_lockout_metadata">remove_lockout_metadata</a></li>
<li><a href="#method-i-remove_remember_key">remove_remember_key</a></li>
<li><a href="#method-i-remove_reset_password_key">remove_reset_password_key</a></li>
<li><a href="#method-i-remove_session_value">remove_session_value</a></li>
<li><a href="#method-i-remove_verify_account_key">remove_verify_account_key</a></li>
<li><a href="#method-i-remove_verify_login_change_key">remove_verify_login_change_key</a></li>
<li><a href="#method-i-remove_webauthn_key">remove_webauthn_key</a></li>
<li><a href="#method-i-render">render</a></li>
<li><a href="#method-i-render_multi_phase_login_forms">render_multi_phase_login_forms</a></li>
<li><a href="#method-i-request">request</a></li>
<li><a href="#method-i-require_account">require_account</a></li>
<li><a href="#method-i-require_account_session">require_account_session</a></li>
<li><a href="#method-i-require_authentication">require_authentication</a></li>
<li><a href="#method-i-require_current_password">require_current_password</a></li>
<li><a href="#method-i-require_http_basic_auth">require_http_basic_auth</a></li>
<li><a href="#method-i-require_login">require_login</a></li>
<li><a href="#method-i-require_login_confirmation-3F">require_login_confirmation?</a></li>
<li><a href="#method-i-require_login_redirect">require_login_redirect</a></li>
<li><a href="#method-i-require_otp_setup">require_otp_setup</a></li>
<li><a href="#method-i-require_password_authentication">require_password_authentication</a></li>
<li><a href="#method-i-require_password_authentication-3F">require_password_authentication?</a></li>
<li><a href="#method-i-require_response">require_response</a></li>
<li><a href="#method-i-require_sms_available">require_sms_available</a></li>
<li><a href="#method-i-require_sms_not_setup">require_sms_not_setup</a></li>
<li><a href="#method-i-require_sms_setup">require_sms_setup</a></li>
<li><a href="#method-i-require_two_factor_authenticated">require_two_factor_authenticated</a></li>
<li><a href="#method-i-require_two_factor_not_authenticated">require_two_factor_not_authenticated</a></li>
<li><a href="#method-i-require_two_factor_setup">require_two_factor_setup</a></li>
<li><a href="#method-i-require_webauthn_setup">require_webauthn_setup</a></li>
<li><a href="#method-i-rescue_jwt_payload">rescue_jwt_payload</a></li>
<li><a href="#method-i-reset_password_email_link">reset_password_email_link</a></li>
<li><a href="#method-i-reset_password_email_recently_sent-3F">reset_password_email_recently_sent?</a></li>
<li><a href="#method-i-reset_password_key_insert_hash">reset_password_key_insert_hash</a></li>
<li><a href="#method-i-reset_password_request_for_unverified_account">reset_password_request_for_unverified_account</a></li>
<li><a href="#method-i-reset_single_session_key">reset_single_session_key</a></li>
<li><a href="#method-i-response">response</a></li>
<li><a href="#method-i-retry_on_uniqueness_violation">retry_on_uniqueness_violation</a></li>
<li><a href="#method-i-return_json_response">return_json_response</a></li>
<li><a href="#method-i-return_response">return_response</a></li>
<li><a href="#method-i-route-21">route!</a></li>
<li><a href="#method-i-route_path">route_path</a></li>
<li><a href="#method-i-route_url">route_url</a></li>
<li><a href="#method-i-save_account">save_account</a></li>
<li><a href="#method-i-send_email">send_email</a></li>
<li><a href="#method-i-send_verify_login_change_email">send_verify_login_change_email</a></li>
<li><a href="#method-i-serialize_audit_log_metadata">serialize_audit_log_metadata</a></li>
<li><a href="#method-i-session">session</a></li>
<li><a href="#method-i-session_inactivity_deadline_condition">session_inactivity_deadline_condition</a></li>
<li><a href="#method-i-session_jwt">session_jwt</a></li>
<li><a href="#method-i-session_lifetime_deadline_condition">session_lifetime_deadline_condition</a></li>
<li><a href="#method-i-session_value">session_value</a></li>
<li><a href="#method-i-set_deadline_value">set_deadline_value</a></li>
<li><a href="#method-i-set_deadline_values-3F">set_deadline_values?</a></li>
<li><a href="#method-i-set_email_auth_email_last_sent">set_email_auth_email_last_sent</a></li>
<li><a href="#method-i-set_error_flash">set_error_flash</a></li>
<li><a href="#method-i-set_error_reason">set_error_reason</a></li>
<li><a href="#method-i-set_expired">set_expired</a></li>
<li><a href="#method-i-set_field_error">set_field_error</a></li>
<li><a href="#method-i-set_http_basic_auth_error_response">set_http_basic_auth_error_response</a></li>
<li><a href="#method-i-set_jwt">set_jwt</a></li>
<li><a href="#method-i-set_jwt_refresh_token_hmac_session_key">set_jwt_refresh_token_hmac_session_key</a></li>
<li><a href="#method-i-set_jwt_token">set_jwt_token</a></li>
<li><a href="#method-i-set_last_password_entry">set_last_password_entry</a></li>
<li><a href="#method-i-set_login_requirement_error_message">set_login_requirement_error_message</a></li>
<li><a href="#method-i-set_new_account_password">set_new_account_password</a></li>
<li><a href="#method-i-set_notice_flash">set_notice_flash</a></li>
<li><a href="#method-i-set_notice_now_flash">set_notice_now_flash</a></li>
<li><a href="#method-i-set_password">set_password</a></li>
<li><a href="#method-i-set_password_requirement_error_message">set_password_requirement_error_message</a></li>
<li><a href="#method-i-set_redirect_error_flash">set_redirect_error_flash</a></li>
<li><a href="#method-i-set_redirect_error_status">set_redirect_error_status</a></li>
<li><a href="#method-i-set_remember_cookie">set_remember_cookie</a></li>
<li><a href="#method-i-set_reset_password_email_last_sent">set_reset_password_email_last_sent</a></li>
<li><a href="#method-i-set_response_error_reason_status">set_response_error_reason_status</a></li>
<li><a href="#method-i-set_response_error_status">set_response_error_status</a></li>
<li><a href="#method-i-set_response_header">set_response_header</a></li>
<li><a href="#method-i-set_session_value">set_session_value</a></li>
<li><a href="#method-i-set_single_session_key">set_single_session_key</a></li>
<li><a href="#method-i-set_title">set_title</a></li>
<li><a href="#method-i-set_unlock_account_email_last_sent">set_unlock_account_email_last_sent</a></li>
<li><a href="#method-i-set_verify_account_email_last_sent">set_verify_account_email_last_sent</a></li>
<li><a href="#method-i-setup_account_verification">setup_account_verification</a></li>
<li><a href="#method-i-show_lockout_page">show_lockout_page</a></li>
<li><a href="#method-i-show_otp_auth_link-3F">show_otp_auth_link?</a></li>
<li><a href="#method-i-single_session_ds">single_session_ds</a></li>
<li><a href="#method-i-skip_login_field_on_login-3F">skip_login_field_on_login?</a></li>
<li><a href="#method-i-skip_password_field_on_login-3F">skip_password_field_on_login?</a></li>
<li><a href="#method-i-skip_status_checks-3F">skip_status_checks?</a></li>
<li><a href="#method-i-sms_auth_message">sms_auth_message</a></li>
<li><a href="#method-i-sms_available-3F">sms_available?</a></li>
<li><a href="#method-i-sms_code">sms_code</a></li>
<li><a href="#method-i-sms_code_issued_at">sms_code_issued_at</a></li>
<li><a href="#method-i-sms_code_match-3F">sms_code_match?</a></li>
<li><a href="#method-i-sms_codes_primary-3F">sms_codes_primary?</a></li>
<li><a href="#method-i-sms_confirm">sms_confirm</a></li>
<li><a href="#method-i-sms_confirm_failure">sms_confirm_failure</a></li>
<li><a href="#method-i-sms_confirm_message">sms_confirm_message</a></li>
<li><a href="#method-i-sms_confirmation_match-3F">sms_confirmation_match?</a></li>
<li><a href="#method-i-sms_current_auth-3F">sms_current_auth?</a></li>
<li><a href="#method-i-sms_disable">sms_disable</a></li>
<li><a href="#method-i-sms_ds">sms_ds</a></li>
<li><a href="#method-i-sms_failures">sms_failures</a></li>
<li><a href="#method-i-sms_locked_out-3F">sms_locked_out?</a></li>
<li><a href="#method-i-sms_needs_confirmation-3F">sms_needs_confirmation?</a></li>
<li><a href="#method-i-sms_needs_confirmation_notice_flash">sms_needs_confirmation_notice_flash</a></li>
<li><a href="#method-i-sms_new_auth_code">sms_new_auth_code</a></li>
<li><a href="#method-i-sms_new_confirm_code">sms_new_confirm_code</a></li>
<li><a href="#method-i-sms_normalize_phone">sms_normalize_phone</a></li>
<li><a href="#method-i-sms_phone">sms_phone</a></li>
<li><a href="#method-i-sms_record_failure">sms_record_failure</a></li>
<li><a href="#method-i-sms_remove_expired_confirm_code">sms_remove_expired_confirm_code</a></li>
<li><a href="#method-i-sms_remove_failures">sms_remove_failures</a></li>
<li><a href="#method-i-sms_send">sms_send</a></li>
<li><a href="#method-i-sms_send_auth_code">sms_send_auth_code</a></li>
<li><a href="#method-i-sms_send_confirm_code">sms_send_confirm_code</a></li>
<li><a href="#method-i-sms_set_code">sms_set_code</a></li>
<li><a href="#method-i-sms_setup">sms_setup</a></li>
<li><a href="#method-i-sms_setup-3F">sms_setup?</a></li>
<li><a href="#method-i-sms_valid_phone-3F">sms_valid_phone?</a></li>
<li><a href="#method-i-split_token">split_token</a></li>
<li><a href="#method-i-template_path">template_path</a></li>
<li><a href="#method-i-throw_basic_auth_error">throw_basic_auth_error</a></li>
<li><a href="#method-i-throw_error">throw_error</a></li>
<li><a href="#method-i-throw_error_reason">throw_error_reason</a></li>
<li><a href="#method-i-throw_error_status">throw_error_status</a></li>
<li><a href="#method-i-throw_rodauth_error">throw_rodauth_error</a></li>
<li><a href="#method-i-timing_safe_eql-3F">timing_safe_eql?</a></li>
<li><a href="#method-i-token_link">token_link</a></li>
<li><a href="#method-i-token_param_value">token_param_value</a></li>
<li><a href="#method-i-transaction">transaction</a></li>
<li><a href="#method-i-translate">translate</a></li>
<li><a href="#method-i-two_factor_auth_links">two_factor_auth_links</a></li>
<li><a href="#method-i-two_factor_authenticate">two_factor_authenticate</a></li>
<li><a href="#method-i-two_factor_authenticated-3F">two_factor_authenticated?</a></li>
<li><a href="#method-i-two_factor_authentication_setup-3F">two_factor_authentication_setup?</a></li>
<li><a href="#method-i-two_factor_login_type_match-3F">two_factor_login_type_match?</a></li>
<li><a href="#method-i-two_factor_modifications_require_password-3F">two_factor_modifications_require_password?</a></li>
<li><a href="#method-i-two_factor_partially_authenticated-3F">two_factor_partially_authenticated?</a></li>
<li><a href="#method-i-two_factor_password_match-3F">two_factor_password_match?</a></li>
<li><a href="#method-i-two_factor_remove">two_factor_remove</a></li>
<li><a href="#method-i-two_factor_remove_auth_failures">two_factor_remove_auth_failures</a></li>
<li><a href="#method-i-two_factor_remove_links">two_factor_remove_links</a></li>
<li><a href="#method-i-two_factor_remove_session">two_factor_remove_session</a></li>
<li><a href="#method-i-two_factor_setup_links">two_factor_setup_links</a></li>
<li><a href="#method-i-two_factor_update_session">two_factor_update_session</a></li>
<li><a href="#method-i-unique_constraint_violation_class">unique_constraint_violation_class</a></li>
<li><a href="#method-i-unlock_account">unlock_account</a></li>
<li><a href="#method-i-unlock_account_email_link">unlock_account_email_link</a></li>
<li><a href="#method-i-unlock_account_email_recently_sent-3F">unlock_account_email_recently_sent?</a></li>
<li><a href="#method-i-unverified_grace_period_expired-3F">unverified_grace_period_expired?</a></li>
<li><a href="#method-i-update_account">update_account</a></li>
<li><a href="#method-i-update_activity">update_activity</a></li>
<li><a href="#method-i-update_current_session-3F">update_current_session?</a></li>
<li><a href="#method-i-update_hash_ds">update_hash_ds</a></li>
<li><a href="#method-i-update_last_activity">update_last_activity</a></li>
<li><a href="#method-i-update_last_login">update_last_login</a></li>
<li><a href="#method-i-update_login">update_login</a></li>
<li><a href="#method-i-update_password_changed_at">update_password_changed_at</a></li>
<li><a href="#method-i-update_password_hash-3F">update_password_hash?</a></li>
<li><a href="#method-i-update_session">update_session</a></li>
<li><a href="#method-i-update_single_session_key">update_single_session_key</a></li>
<li><a href="#method-i-update_sms">update_sms</a></li>
<li><a href="#method-i-use_database_authentication_functions-3F">use_database_authentication_functions?</a></li>
<li><a href="#method-i-use_date_arithmetic-3F">use_date_arithmetic?</a></li>
<li><a href="#method-i-use_json-3F">use_json?</a></li>
<li><a href="#method-i-use_jwt-3F">use_jwt?</a></li>
<li><a href="#method-i-use_multi_phase_login-3F">use_multi_phase_login?</a></li>
<li><a href="#method-i-use_request_specific_csrf_tokens-3F">use_request_specific_csrf_tokens?</a></li>
<li><a href="#method-i-use_scope_clear_session-3F">use_scope_clear_session?</a></li>
<li><a href="#method-i-uses_two_factor_authentication-3F">uses_two_factor_authentication?</a></li>
<li><a href="#method-i-valid_jwt-3F">valid_jwt?</a></li>
<li><a href="#method-i-valid_login_entered-3F">valid_login_entered?</a></li>
<li><a href="#method-i-valid_new_webauthn_credential-3F">valid_new_webauthn_credential?</a></li>
<li><a href="#method-i-valid_webauthn_credential_auth-3F">valid_webauthn_credential_auth?</a></li>
<li><a href="#method-i-verified_account-3F">verified_account?</a></li>
<li><a href="#method-i-verify_account">verify_account</a></li>
<li><a href="#method-i-verify_account_check_already_logged_in">verify_account_check_already_logged_in</a></li>
<li><a href="#method-i-verify_account_ds">verify_account_ds</a></li>
<li><a href="#method-i-verify_account_email_link">verify_account_email_link</a></li>
<li><a href="#method-i-verify_account_email_recently_sent-3F">verify_account_email_recently_sent?</a></li>
<li><a href="#method-i-verify_account_email_resend">verify_account_email_resend</a></li>
<li><a href="#method-i-verify_account_key_insert_hash">verify_account_key_insert_hash</a></li>
<li><a href="#method-i-verify_account_set_password-3F">verify_account_set_password?</a></li>
<li><a href="#method-i-verify_account_view">verify_account_view</a></li>
<li><a href="#method-i-verify_login_change">verify_login_change</a></li>
<li><a href="#method-i-verify_login_change_ds">verify_login_change_ds</a></li>
<li><a href="#method-i-verify_login_change_email_body">verify_login_change_email_body</a></li>
<li><a href="#method-i-verify_login_change_email_link">verify_login_change_email_link</a></li>
<li><a href="#method-i-verify_login_change_key_insert_hash">verify_login_change_key_insert_hash</a></li>
<li><a href="#method-i-verify_login_change_old_login">verify_login_change_old_login</a></li>
<li><a href="#method-i-view">view</a></li>
<li><a href="#method-i-webauthn_account_id">webauthn_account_id</a></li>
<li><a href="#method-i-webauthn_allow">webauthn_allow</a></li>
<li><a href="#method-i-webauthn_auth_additional_form_tags">webauthn_auth_additional_form_tags</a></li>
<li><a href="#method-i-webauthn_auth_credential_from_form_submission">webauthn_auth_credential_from_form_submission</a></li>
<li><a href="#method-i-webauthn_auth_data">webauthn_auth_data</a></li>
<li><a href="#method-i-webauthn_auth_form_path">webauthn_auth_form_path</a></li>
<li><a href="#method-i-webauthn_authenticator_selection">webauthn_authenticator_selection</a></li>
<li><a href="#method-i-webauthn_create_relying_party_opts">webauthn_create_relying_party_opts</a></li>
<li><a href="#method-i-webauthn_credential_options_for_get">webauthn_credential_options_for_get</a></li>
<li><a href="#method-i-webauthn_extensions">webauthn_extensions</a></li>
<li><a href="#method-i-webauthn_form_submission_call">webauthn_form_submission_call</a></li>
<li><a href="#method-i-webauthn_key_insert_hash">webauthn_key_insert_hash</a></li>
<li><a href="#method-i-webauthn_keys_ds">webauthn_keys_ds</a></li>
<li><a href="#method-i-webauthn_login_options-3F">webauthn_login_options?</a></li>
<li><a href="#method-i-webauthn_login_verification_factor-3F">webauthn_login_verification_factor?</a></li>
<li><a href="#method-i-webauthn_origin">webauthn_origin</a></li>
<li><a href="#method-i-webauthn_relying_party">webauthn_relying_party</a></li>
<li><a href="#method-i-webauthn_remove_authenticated_session">webauthn_remove_authenticated_session</a></li>
<li><a href="#method-i-webauthn_rp_id">webauthn_rp_id</a></li>
<li><a href="#method-i-webauthn_rp_name">webauthn_rp_name</a></li>
<li><a href="#method-i-webauthn_setup-3F">webauthn_setup?</a></li>
<li><a href="#method-i-webauthn_setup_credential_from_form_submission">webauthn_setup_credential_from_form_submission</a></li>
<li><a href="#method-i-webauthn_setup_data">webauthn_setup_data</a></li>
<li><a href="#method-i-webauthn_update_session">webauthn_update_session</a></li>
<li><a href="#method-i-webauthn_user_ids_ds">webauthn_user_ids_ds</a></li>
<li><a href="#method-i-webauthn_user_name">webauthn_user_name</a></li>
<li><a href="#method-i-webauthn_user_verification">webauthn_user_verification</a></li>
</ol>
</div>
<div id='context'>
</div>
<div id='class-list'>
<h2>Classes and Modules</h2>
<ol>
<li><a href="Rodauth/ClassMethods.html">Rodauth::ClassMethods</a></li>
<li><a href="Rodauth/InstanceMethods.html">Rodauth::InstanceMethods</a></li>
<li><a href="Rodauth/InternalRequestClassMethods.html">Rodauth::InternalRequestClassMethods</a></li>
<li><a href="Rodauth/InternalRequestMethods.html">Rodauth::InternalRequestMethods</a></li>
<li><a href="Rodauth/RequestMethods.html">Rodauth::RequestMethods</a></li>
<li><a href="Rodauth/Auth.html">Rodauth::Auth</a></li>
<li><a href="Rodauth/Configuration.html">Rodauth::Configuration</a></li>
<li><a href="Rodauth/ConfigurationError.html">Rodauth::ConfigurationError</a></li>
<li><a href="Rodauth/Feature.html">Rodauth::Feature</a></li>
<li><a href="Rodauth/FeatureConfiguration.html">Rodauth::FeatureConfiguration</a></li>
<li><a href="Rodauth/InternalRequestError.html">Rodauth::InternalRequestError</a></li>
</ol>
</div>
<div id='section'>
<div id='constants-list'>
<h2>Constants</h2>
<div class='name-list'>
<table summary='Constants'>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>FEATURES</td>
<td>=</td>
<td class='context-item-value'>{}</td>
<td>&nbsp;</td>
<td class='context-item-desc'></td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>INVALID_DOMAIN</td>
<td>=</td>
<td class='context-item-value'>"invalidurl @@.com"</td>
<td>&nbsp;</td>
<td class='context-item-desc'></td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>MAJOR</td>
<td>=</td>
<td class='context-item-value'>2</td>
<td>&nbsp;</td>
<td class='context-item-desc'>
<p>The major version of <a href="Rodauth.html"><code>Rodauth</code></a>, updated only for major changes that are likely to require modification to apps using <a href="Rodauth.html"><code>Rodauth</code></a>.</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>MINOR</td>
<td>=</td>
<td class='context-item-value'>40</td>
<td>&nbsp;</td>
<td class='context-item-desc'>
<p>The minor version of <a href="Rodauth.html"><code>Rodauth</code></a>, updated for new feature releases of <a href="Rodauth.html"><code>Rodauth</code></a>.</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>TINY</td>
<td>=</td>
<td class='context-item-value'>0</td>
<td>&nbsp;</td>
<td class='context-item-desc'>
<p>The patch version of <a href="Rodauth.html"><code>Rodauth</code></a>, updated only for bug fixes from the last feature release.</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>VERSION</td>
<td>=</td>
<td class='context-item-value'>"#{MAJOR}.#{MINOR}.#{TINY}".freeze</td>
<td>&nbsp;</td>
<td class='context-item-desc'>
<p>The full version of <a href="Rodauth.html"><code>Rodauth</code></a> as a string</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>VERSION_NUMBER</td>
<td>=</td>
<td class='context-item-value'>MAJOR*10000 + MINOR*100 + TINY</td>
<td>&nbsp;</td>
<td class='context-item-desc'>
<p>The full version of <a href="Rodauth.html"><code>Rodauth</code></a> as a number (<a href="../files/doc/release_notes/1_17_0_txt.html">1.17.0</a> =&gt; 11700)</p>
</td>
</tr>
</table>
</div>
</div>
<div id='aliases-list'>
<h2>Public Instance Aliases</h2>
<div class='name-list'>
<table summary='Public Instance Aliases'>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>account_session_value</td>
<td>-&gt;</td>
<td class='context-item-value'><a href="#method-i-account_id">account_id</a></td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>ignore_uniqueness_violation</td>
<td>-&gt;</td>
<td class='context-item-value'><a href="#method-i-raises_uniqueness_violation-3F">raises_uniqueness_violation?</a></td>
<td class='context-item-desc'>
<p>If you just want to ignore uniqueness violations, this alias makes more sense.</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>logged_in?</td>
<td>-&gt;</td>
<td class='context-item-value'><a href="#method-i-session_value">session_value</a></td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>raised_uniqueness_violation</td>
<td>-&gt;</td>
<td class='context-item-value'><a href="#method-i-raises_uniqueness_violation-3F">raises_uniqueness_violation?</a></td>
<td class='context-item-desc'>
<p>If you would like to operate/reraise the exception, this alias makes more sense.</p>
</td>
</tr>
<tr class='top-aligned-row context-row'>
<td class='context-item-name'>webauthn_get_relying_party_opts</td>
<td>-&gt;</td>
<td class='context-item-value'><a href="#method-i-webauthn_create_relying_party_opts">webauthn_create_relying_party_opts</a></td>
</tr>
</table>
</div>
</div>
<div id='methods'>
<h2>Public Class methods</h2>
<div class='method public-class' id='method-method-c-configure'>
<a name='method-c-configure'></a>
<div class='synopsis'>
<span class='name'>configure</span><span class='arguments'>(app, opts={}, &block)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-configure-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-configure-source'>   <span class="ruby-comment"># File lib/rodauth.rb</span>
<span class="line-num">48</span> <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">configure</span>(<span class="ruby-identifier">app</span>, <span class="ruby-identifier">opts</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">49</span>   <span class="ruby-identifier">json_opt</span> = <span class="ruby-identifier">app</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauth_json</span>] = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:json</span>, <span class="ruby-identifier">app</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauth_json</span>])
<span class="line-num">50</span>   <span class="ruby-identifier">csrf</span> = <span class="ruby-identifier">app</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauth_csrf</span>] = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:csrf</span>, <span class="ruby-identifier">app</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauth_csrf</span>])
<span class="line-num">51</span>   <span class="ruby-identifier">app</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauth_route_csrf</span>] = <span class="ruby-keyword">case</span> <span class="ruby-identifier">csrf</span>
<span class="line-num">52</span>   <span class="ruby-keyword">when</span> <span class="ruby-keyword">false</span>, <span class="ruby-value">:rack_csrf</span>
<span class="line-num">53</span>     <span class="ruby-keyword">false</span>
<span class="line-num">54</span>   <span class="ruby-keyword">else</span>
<span class="line-num">55</span>     <span class="ruby-identifier">json_opt</span> <span class="ruby-operator">!=</span> <span class="ruby-value">:only</span>
<span class="line-num">56</span>   <span class="ruby-keyword">end</span>
<span class="line-num">57</span>   <span class="ruby-identifier">auth_class</span> = (<span class="ruby-identifier">app</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauths</span>] <span class="ruby-operator">||=</span> {})[<span class="ruby-identifier">opts</span>[<span class="ruby-value">:name</span>]] <span class="ruby-operator">||=</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:auth_class</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Auth</span>)
<span class="line-num">58</span>   <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">auth_class</span>.<span class="ruby-identifier">roda_class</span>
<span class="line-num">59</span>     <span class="ruby-identifier">auth_class</span>.<span class="ruby-identifier">roda_class</span> = <span class="ruby-identifier">app</span>
<span class="line-num">60</span>   <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">auth_class</span>.<span class="ruby-identifier">roda_class</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">app</span>
<span class="line-num">61</span>     <span class="ruby-identifier">auth_class</span> = <span class="ruby-identifier">app</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauths</span>][<span class="ruby-identifier">opts</span>[<span class="ruby-value">:name</span>]] = <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">auth_class</span>)
<span class="line-num">62</span>     <span class="ruby-identifier">auth_class</span>.<span class="ruby-identifier">roda_class</span> = <span class="ruby-identifier">app</span>
<span class="line-num">63</span>   <span class="ruby-keyword">end</span>
<span class="line-num">64</span>   <span class="ruby-identifier">auth_class</span>.<span class="ruby-identifier">class_eval</span>{<span class="ruby-ivar">@configuration_name</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:name</span>] <span class="ruby-keyword">unless</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@configuration_name</span>)}
<span class="line-num">65</span>   <span class="ruby-identifier">auth_class</span>.<span class="ruby-identifier">configure</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">block</span>
<span class="line-num">66</span>   <span class="ruby-identifier">auth_class</span>.<span class="ruby-identifier">allocate</span>.<span class="ruby-identifier">post_configure</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">auth_class</span>.<span class="ruby-identifier">method_defined?</span>(<span class="ruby-value">:post_configure</span>)
<span class="line-num">67</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-class' id='method-method-c-create_database_authentication_functions'>
<a name='method-c-create_database_authentication_functions'></a>
<div class='synopsis'>
<span class='name'>create_database_authentication_functions</span><span class='arguments'>(db, opts={})</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-create_database_authentication_functions-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-create_database_authentication_functions-source'>    <span class="ruby-comment"># File lib/rodauth/migrations.rb</span>
<span class="line-num">  4</span>   <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">create_database_authentication_functions</span>(<span class="ruby-identifier">db</span>, <span class="ruby-identifier">opts</span>={})
<span class="line-num">  5</span>     <span class="ruby-identifier">table_name</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:table_name</span>] <span class="ruby-operator">||</span> <span class="ruby-value">:account_password_hashes</span>
<span class="line-num">  6</span>     <span class="ruby-identifier">get_salt_name</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:get_salt_name</span>] <span class="ruby-operator">||</span> <span class="ruby-value">:rodauth_get_salt</span>
<span class="line-num">  7</span>     <span class="ruby-identifier">valid_hash_name</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:valid_hash_name</span>] <span class="ruby-operator">||</span> <span class="ruby-value">:rodauth_valid_password_hash</span>
<span class="line-num">  8</span>     <span class="ruby-identifier">argon2</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:argon2</span>]
<span class="line-num">  9</span> 
<span class="line-num"> 10</span>     <span class="ruby-keyword">case</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">database_type</span>
<span class="line-num"> 11</span>     <span class="ruby-keyword">when</span> <span class="ruby-value">:postgres</span>
<span class="line-num"> 12</span>       <span class="ruby-identifier">search_path</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:search_path</span>] <span class="ruby-operator">||</span> <span class="ruby-string">&#39;public, pg_temp&#39;</span>
<span class="line-num"> 13</span>       <span class="ruby-identifier">primary_key_type</span> =
<span class="line-num"> 14</span>         <span class="ruby-keyword">case</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">schema</span>(<span class="ruby-identifier">table_name</span>).<span class="ruby-identifier">find</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span> <span class="ruby-identifier">row</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">==</span> <span class="ruby-value">:id</span> }[<span class="ruby-value">1</span>][<span class="ruby-value">:db_type</span>]
<span class="line-num"> 15</span>         <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;uuid&#39;</span> <span class="ruby-keyword">then</span> <span class="ruby-value">:uuid</span>
<span class="line-num"> 16</span>         <span class="ruby-keyword">else</span> <span class="ruby-value">:int8</span>
<span class="line-num"> 17</span>         <span class="ruby-keyword">end</span>
<span class="line-num"> 18</span>       <span class="ruby-identifier">table_name</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">literal</span>(<span class="ruby-identifier">table_name</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">table_name</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)
<span class="line-num"> 19</span> 
<span class="line-num"> 20</span>       <span class="ruby-identifier">argon_sql</span> = <span class="ruby-identifier">&lt;&lt;END</span>
<span class="line-num"> 21</span> <span class="ruby-value">CASE
<span class="line-num"> 22</span>     WHEN password_hash ~ &#39;^\\$argon2id&#39;
<span class="line-num"> 23</span>       THEN substring(password_hash from &#39;\\$argon2id\\$v=\\d+\\$m=\\d+,t=\\d+,p=\\d+\\$.+\\$&#39;)
<span class="line-num"> 24</span>     ELSE substr(password_hash, 0, 30)
<span class="line-num"> 25</span>   END INTO salt
<span class="line-num"> 26</span> </span><span class="ruby-identifier">END</span>
<span class="line-num"> 27</span>       <span class="ruby-identifier">db</span>.<span class="ruby-identifier">run</span> <span class="ruby-identifier">&lt;&lt;END</span>
<span class="line-num"> 28</span> <span class="ruby-value">CREATE OR REPLACE FUNCTION #{get_salt_name}(acct_id #{primary_key_type}) RETURNS text AS $$
<span class="line-num"> 29</span> DECLARE salt text;
<span class="line-num"> 30</span> BEGIN
<span class="line-num"> 31</span> SELECT
<span class="line-num"> 32</span> #{argon2 ? argon_sql : &quot;substr(password_hash, 0, 30) INTO salt&quot;}
<span class="line-num"> 33</span> FROM #{table_name}
<span class="line-num"> 34</span> WHERE acct_id = id;
<span class="line-num"> 35</span> RETURN salt;
<span class="line-num"> 36</span> END;
<span class="line-num"> 37</span> $$ LANGUAGE plpgsql
<span class="line-num"> 38</span> SECURITY DEFINER
<span class="line-num"> 39</span> SET search_path = #{search_path};
<span class="line-num"> 40</span> </span><span class="ruby-identifier">END</span>
<span class="line-num"> 41</span> 
<span class="line-num"> 42</span>       <span class="ruby-identifier">db</span>.<span class="ruby-identifier">run</span> <span class="ruby-identifier">&lt;&lt;END</span>
<span class="line-num"> 43</span> <span class="ruby-value">CREATE OR REPLACE FUNCTION #{valid_hash_name}(acct_id #{primary_key_type}, hash text) RETURNS boolean AS $$
<span class="line-num"> 44</span> DECLARE valid boolean;
<span class="line-num"> 45</span> BEGIN
<span class="line-num"> 46</span> SELECT password_hash = hash INTO valid 
<span class="line-num"> 47</span> FROM #{table_name}
<span class="line-num"> 48</span> WHERE acct_id = id;
<span class="line-num"> 49</span> RETURN valid;
<span class="line-num"> 50</span> END;
<span class="line-num"> 51</span> $$ LANGUAGE plpgsql
<span class="line-num"> 52</span> SECURITY DEFINER
<span class="line-num"> 53</span> SET search_path = #{search_path};
<span class="line-num"> 54</span> </span><span class="ruby-identifier">END</span>
<span class="line-num"> 55</span>     <span class="ruby-keyword">when</span> <span class="ruby-value">:mysql</span>
<span class="line-num"> 56</span>       <span class="ruby-identifier">argon_sql</span> = <span class="ruby-identifier">&lt;&lt;END</span>
<span class="line-num"> 57</span> <span class="ruby-value">CASE
<span class="line-num"> 58</span>   WHEN password_hash REGEXP &#39;^.argon2id&#39;
<span class="line-num"> 59</span>     THEN left(password_hash, CHAR_LENGTH(password_hash) - INSTR(REVERSE(password_hash), &#39;$&#39;))
<span class="line-num"> 60</span>   ELSE substr(password_hash, 1, 30)
<span class="line-num"> 61</span>   END
<span class="line-num"> 62</span> </span><span class="ruby-identifier">END</span>
<span class="line-num"> 63</span>       <span class="ruby-identifier">db</span>.<span class="ruby-identifier">run</span> <span class="ruby-identifier">&lt;&lt;END</span>
<span class="line-num"> 64</span> <span class="ruby-value">CREATE FUNCTION #{get_salt_name}(acct_id int8) RETURNS varchar(255)
<span class="line-num"> 65</span> SQL SECURITY DEFINER
<span class="line-num"> 66</span> READS SQL DATA
<span class="line-num"> 67</span> BEGIN
<span class="line-num"> 68</span> RETURN (SELECT
<span class="line-num"> 69</span> #{argon2 ? argon_sql : &quot;substr(password_hash, 1, 30)&quot;}
<span class="line-num"> 70</span> FROM #{table_name}
<span class="line-num"> 71</span> WHERE acct_id = id);
<span class="line-num"> 72</span> END;
<span class="line-num"> 73</span> </span><span class="ruby-identifier">END</span>
<span class="line-num"> 74</span> 
<span class="line-num"> 75</span>       <span class="ruby-identifier">db</span>.<span class="ruby-identifier">run</span> <span class="ruby-identifier">&lt;&lt;END</span>
<span class="line-num"> 76</span> <span class="ruby-value">CREATE FUNCTION #{valid_hash_name}(acct_id int8, hash varchar(255)) RETURNS tinyint(1)
<span class="line-num"> 77</span> SQL SECURITY DEFINER
<span class="line-num"> 78</span> READS SQL DATA
<span class="line-num"> 79</span> BEGIN
<span class="line-num"> 80</span> DECLARE valid tinyint(1);
<span class="line-num"> 81</span> DECLARE csr CURSOR FOR 
<span class="line-num"> 82</span> SELECT password_hash = hash
<span class="line-num"> 83</span> FROM #{table_name}
<span class="line-num"> 84</span> WHERE acct_id = id;
<span class="line-num"> 85</span> OPEN csr;
<span class="line-num"> 86</span> FETCH csr INTO valid;
<span class="line-num"> 87</span> CLOSE csr;
<span class="line-num"> 88</span> RETURN valid;
<span class="line-num"> 89</span> END;
<span class="line-num"> 90</span> </span><span class="ruby-identifier">END</span>
<span class="line-num"> 91</span>     <span class="ruby-keyword">when</span> <span class="ruby-value">:mssql</span>
<span class="line-num"> 92</span>       <span class="ruby-identifier">argon_sql</span> = <span class="ruby-identifier">&lt;&lt;END</span>
<span class="line-num"> 93</span> <span class="ruby-value">CASE
<span class="line-num"> 94</span>   WHEN password_hash LIKE &#39;[$]argon2id%&#39;
<span class="line-num"> 95</span>     THEN left(password_hash, len(password_hash) - charindex(&#39;$&#39;, reverse(password_hash)))
<span class="line-num"> 96</span>   ELSE substring(password_hash, 0, 30)
<span class="line-num"> 97</span>   END
<span class="line-num"> 98</span> </span><span class="ruby-identifier">END</span>
<span class="line-num"> 99</span>       <span class="ruby-identifier">db</span>.<span class="ruby-identifier">run</span> <span class="ruby-identifier">&lt;&lt;END</span>
<span class="line-num">100</span> <span class="ruby-value">CREATE FUNCTION #{get_salt_name}(@account_id bigint) RETURNS nvarchar(255)
<span class="line-num">101</span> WITH EXECUTE AS OWNER
<span class="line-num">102</span> AS
<span class="line-num">103</span> BEGIN
<span class="line-num">104</span> DECLARE @salt nvarchar(255);
<span class="line-num">105</span> SELECT @salt =
<span class="line-num">106</span> #{argon2 ? argon_sql : &quot;substring(password_hash, 0, 30)&quot;}
<span class="line-num">107</span> FROM #{table_name}
<span class="line-num">108</span> WHERE id = @account_id;
<span class="line-num">109</span> RETURN @salt;
<span class="line-num">110</span> END;
<span class="line-num">111</span> </span><span class="ruby-identifier">END</span>
<span class="line-num">112</span> 
<span class="line-num">113</span>       <span class="ruby-identifier">db</span>.<span class="ruby-identifier">run</span> <span class="ruby-identifier">&lt;&lt;END</span>
<span class="line-num">114</span> <span class="ruby-value">CREATE FUNCTION #{valid_hash_name}(@account_id bigint, @hash nvarchar(255)) RETURNS bit
<span class="line-num">115</span> WITH EXECUTE AS OWNER
<span class="line-num">116</span> AS
<span class="line-num">117</span> BEGIN
<span class="line-num">118</span> DECLARE @valid bit;
<span class="line-num">119</span> DECLARE @ph nvarchar(255);
<span class="line-num">120</span> SELECT @ph = password_hash
<span class="line-num">121</span> FROM #{table_name}
<span class="line-num">122</span> WHERE id = @account_id;
<span class="line-num">123</span> IF(@hash = @ph)
<span class="line-num">124</span>   SET @valid = 1;
<span class="line-num">125</span> ELSE
<span class="line-num">126</span>   SET @valid = 0
<span class="line-num">127</span> RETURN @valid;
<span class="line-num">128</span> END;
<span class="line-num">129</span> </span><span class="ruby-identifier">END</span>
<span class="line-num">130</span>     <span class="ruby-keyword">end</span>
<span class="line-num">131</span>   <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-class' id='method-method-c-create_database_previous_password_check_functions'>
<a name='method-c-create_database_previous_password_check_functions'></a>
<div class='synopsis'>
<span class='name'>create_database_previous_password_check_functions</span><span class='arguments'>(db, opts={})</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-create_database_previous_password_check_functions-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-create_database_previous_password_check_functions-source'>    <span class="ruby-comment"># File lib/rodauth/migrations.rb</span>
<span class="line-num">153</span> <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">create_database_previous_password_check_functions</span>(<span class="ruby-identifier">db</span>, <span class="ruby-identifier">opts</span>={})
<span class="line-num">154</span>   <span class="ruby-identifier">create_database_authentication_functions</span>(<span class="ruby-identifier">db</span>, {<span class="ruby-value">:table_name</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:account_previous_password_hashes</span>, <span class="ruby-value">:get_salt_name</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:rodauth_get_previous_salt</span>, <span class="ruby-value">:valid_hash_name</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:rodauth_previous_password_hash_match</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>))
<span class="line-num">155</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-class' id='method-method-c-drop_database_authentication_functions'>
<a name='method-c-drop_database_authentication_functions'></a>
<div class='synopsis'>
<span class='name'>drop_database_authentication_functions</span><span class='arguments'>(db, opts={})</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-drop_database_authentication_functions-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-drop_database_authentication_functions-source'>    <span class="ruby-comment"># File lib/rodauth/migrations.rb</span>
<span class="line-num">133</span> <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">drop_database_authentication_functions</span>(<span class="ruby-identifier">db</span>, <span class="ruby-identifier">opts</span>={})
<span class="line-num">134</span>   <span class="ruby-identifier">table_name</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:table_name</span>] <span class="ruby-operator">||</span> <span class="ruby-value">:account_password_hashes</span>
<span class="line-num">135</span>   <span class="ruby-identifier">get_salt_name</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:get_salt_name</span>] <span class="ruby-operator">||</span> <span class="ruby-value">:rodauth_get_salt</span>
<span class="line-num">136</span>   <span class="ruby-identifier">valid_hash_name</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:valid_hash_name</span>] <span class="ruby-operator">||</span> <span class="ruby-value">:rodauth_valid_password_hash</span>
<span class="line-num">137</span> 
<span class="line-num">138</span>   <span class="ruby-keyword">case</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">database_type</span>
<span class="line-num">139</span>   <span class="ruby-keyword">when</span> <span class="ruby-value">:postgres</span>
<span class="line-num">140</span>     <span class="ruby-identifier">primary_key_type</span> =
<span class="line-num">141</span>       <span class="ruby-keyword">case</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">schema</span>(<span class="ruby-identifier">table_name</span>).<span class="ruby-identifier">find</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span> <span class="ruby-identifier">row</span>.<span class="ruby-identifier">first</span> <span class="ruby-operator">==</span> <span class="ruby-value">:id</span> }[<span class="ruby-value">1</span>][<span class="ruby-value">:db_type</span>]
<span class="line-num">142</span>       <span class="ruby-keyword">when</span> <span class="ruby-string">&#39;uuid&#39;</span> <span class="ruby-keyword">then</span> <span class="ruby-value">:uuid</span>
<span class="line-num">143</span>       <span class="ruby-keyword">else</span> <span class="ruby-value">:int8</span>
<span class="line-num">144</span>       <span class="ruby-keyword">end</span>
<span class="line-num">145</span>     <span class="ruby-identifier">db</span>.<span class="ruby-identifier">run</span> <span class="ruby-node">&quot;DROP FUNCTION #{get_salt_name}(#{primary_key_type})&quot;</span>
<span class="line-num">146</span>     <span class="ruby-identifier">db</span>.<span class="ruby-identifier">run</span> <span class="ruby-node">&quot;DROP FUNCTION #{valid_hash_name}(#{primary_key_type}, text)&quot;</span>
<span class="line-num">147</span>   <span class="ruby-keyword">when</span> <span class="ruby-value">:mysql</span>, <span class="ruby-value">:mssql</span>
<span class="line-num">148</span>     <span class="ruby-identifier">db</span>.<span class="ruby-identifier">run</span> <span class="ruby-node">&quot;DROP FUNCTION #{get_salt_name}&quot;</span>
<span class="line-num">149</span>     <span class="ruby-identifier">db</span>.<span class="ruby-identifier">run</span> <span class="ruby-node">&quot;DROP FUNCTION #{valid_hash_name}&quot;</span>
<span class="line-num">150</span>   <span class="ruby-keyword">end</span>
<span class="line-num">151</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-class' id='method-method-c-drop_database_previous_password_check_functions'>
<a name='method-c-drop_database_previous_password_check_functions'></a>
<div class='synopsis'>
<span class='name'>drop_database_previous_password_check_functions</span><span class='arguments'>(db, opts={})</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-drop_database_previous_password_check_functions-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-drop_database_previous_password_check_functions-source'>    <span class="ruby-comment"># File lib/rodauth/migrations.rb</span>
<span class="line-num">157</span> <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">drop_database_previous_password_check_functions</span>(<span class="ruby-identifier">db</span>, <span class="ruby-identifier">opts</span>={})
<span class="line-num">158</span>   <span class="ruby-identifier">drop_database_authentication_functions</span>(<span class="ruby-identifier">db</span>, {<span class="ruby-value">:table_name</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:account_previous_password_hashes</span>, <span class="ruby-value">:get_salt_name</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:rodauth_get_previous_salt</span>, <span class="ruby-value">:valid_hash_name</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:rodauth_previous_password_hash_match</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>))
<span class="line-num">159</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-class' id='method-method-c-lib'>
<a name='method-c-lib'></a>
<div class='synopsis'>
<span class='name'>lib</span><span class='arguments'>(opts={}, &block)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-lib-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-lib-source'>   <span class="ruby-comment"># File lib/rodauth.rb</span>
<span class="line-num"> 8</span> <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">lib</span>(<span class="ruby-identifier">opts</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>) 
<span class="line-num"> 9</span>   <span class="ruby-identifier">require</span> <span class="ruby-string">&#39;roda&#39;</span>
<span class="line-num">10</span>   <span class="ruby-identifier">c</span> = <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Roda</span>)
<span class="line-num">11</span>   <span class="ruby-identifier">c</span>.<span class="ruby-identifier">plugin</span>(<span class="ruby-value">:rodauth</span>, <span class="ruby-identifier">opts</span>) <span class="ruby-keyword">do</span>
<span class="line-num">12</span>     <span class="ruby-identifier">enable</span> <span class="ruby-value">:internal_request</span>
<span class="line-num">13</span>     <span class="ruby-identifier">instance_exec</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">14</span>   <span class="ruby-keyword">end</span>
<span class="line-num">15</span>   <span class="ruby-identifier">c</span>.<span class="ruby-identifier">freeze</span>
<span class="line-num">16</span>   <span class="ruby-identifier">c</span>.<span class="ruby-identifier">rodauth</span>
<span class="line-num">17</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-class' id='method-method-c-load_dependencies'>
<a name='method-c-load_dependencies'></a>
<div class='synopsis'>
<span class='name'>load_dependencies</span><span class='arguments'>(app, opts={}, &_)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-load_dependencies-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-load_dependencies-source'>   <span class="ruby-comment"># File lib/rodauth.rb</span>
<span class="line-num">19</span> <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">load_dependencies</span>(<span class="ruby-identifier">app</span>, <span class="ruby-identifier">opts</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">_</span>)
<span class="line-num">20</span>   <span class="ruby-identifier">json_opt</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:json</span>, <span class="ruby-identifier">app</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauth_json</span>])
<span class="line-num">21</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">json_opt</span>
<span class="line-num">22</span>     <span class="ruby-identifier">app</span>.<span class="ruby-identifier">plugin</span> <span class="ruby-value">:json</span>
<span class="line-num">23</span>     <span class="ruby-identifier">app</span>.<span class="ruby-identifier">plugin</span> <span class="ruby-value">:json_parser</span>
<span class="line-num">24</span>   <span class="ruby-keyword">end</span>
<span class="line-num">25</span> 
<span class="line-num">26</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">json_opt</span> <span class="ruby-operator">==</span> <span class="ruby-value">:only</span>
<span class="line-num">27</span>     <span class="ruby-keyword">unless</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:render</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span>
<span class="line-num">28</span>       <span class="ruby-identifier">require</span> <span class="ruby-string">&#39;tilt/string&#39;</span>
<span class="line-num">29</span>       <span class="ruby-identifier">app</span>.<span class="ruby-identifier">plugin</span> <span class="ruby-value">:render</span>
<span class="line-num">30</span>     <span class="ruby-keyword">end</span>
<span class="line-num">31</span> 
<span class="line-num">32</span>     <span class="ruby-keyword">case</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:csrf</span>, <span class="ruby-identifier">app</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauth_csrf</span>])
<span class="line-num">33</span>     <span class="ruby-keyword">when</span> <span class="ruby-keyword">false</span>
<span class="line-num">34</span>       <span class="ruby-comment"># nothing</span>
<span class="line-num">35</span>     <span class="ruby-keyword">when</span> <span class="ruby-value">:rack_csrf</span>
<span class="line-num">36</span>       <span class="ruby-comment"># :nocov:</span>
<span class="line-num">37</span>       <span class="ruby-identifier">app</span>.<span class="ruby-identifier">plugin</span> <span class="ruby-value">:csrf</span>
<span class="line-num">38</span>       <span class="ruby-comment"># :nocov:</span>
<span class="line-num">39</span>     <span class="ruby-keyword">else</span>
<span class="line-num">40</span>       <span class="ruby-identifier">app</span>.<span class="ruby-identifier">plugin</span> <span class="ruby-value">:route_csrf</span>
<span class="line-num">41</span>     <span class="ruby-keyword">end</span>
<span class="line-num">42</span> 
<span class="line-num">43</span>     <span class="ruby-identifier">app</span>.<span class="ruby-identifier">plugin</span> <span class="ruby-value">:flash</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:flash</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span>
<span class="line-num">44</span>     <span class="ruby-identifier">app</span>.<span class="ruby-identifier">plugin</span> <span class="ruby-value">:h</span>
<span class="line-num">45</span>   <span class="ruby-keyword">end</span>
<span class="line-num">46</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-class' id='method-method-c-new'>
<a name='method-c-new'></a>
<div class='synopsis'>
<span class='name'>new</span><span class='arguments'>(scope)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-new-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-new-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">145</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">initialize</span>(<span class="ruby-identifier">scope</span>)
<span class="line-num">146</span>   <span class="ruby-ivar">@scope</span> = <span class="ruby-identifier">scope</span>
<span class="line-num">147</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-class' id='method-method-c-version'>
<a name='method-c-version'></a>
<div class='synopsis'>
<span class='name'>version</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-version-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-version-source'>   <span class="ruby-comment"># File lib/rodauth/version.rb</span>
<span class="line-num">21</span> <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">version</span>
<span class="line-num">22</span>   <span class="ruby-constant">VERSION</span>
<span class="line-num">23</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<h2>Public Instance methods</h2>
<div class='method public-instance' id='method-method-i-_account_from_email_auth_key'>
<a name='method-i-_account_from_email_auth_key'></a>
<div class='synopsis'>
<span class='name'>_account_from_email_auth_key</span><span class='arguments'>(token)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_account_from_email_auth_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_account_from_email_auth_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/email_auth.rb</span>
<span class="line-num">236</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_account_from_email_auth_key</span>(<span class="ruby-identifier">token</span>)
<span class="line-num">237</span>   <span class="ruby-identifier">account_from_key</span>(<span class="ruby-identifier">token</span>, <span class="ruby-identifier">account_open_status_value</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">id</span><span class="ruby-operator">|</span> <span class="ruby-identifier">get_email_auth_key</span>(<span class="ruby-identifier">id</span>)}
<span class="line-num">238</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_account_from_id'>
<a name='method-i-_account_from_id'></a>
<div class='synopsis'>
<span class='name'>_account_from_id</span><span class='arguments'>(id, status_id=nil)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_account_from_id-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_account_from_id-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">810</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_account_from_id</span>(<span class="ruby-identifier">id</span>, <span class="ruby-identifier">status_id</span>=<span class="ruby-keyword">nil</span>)
<span class="line-num">811</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">account_ds</span>(<span class="ruby-identifier">id</span>)
<span class="line-num">812</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">account_status_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">status_id</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">status_id</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">skip_status_checks?</span>
<span class="line-num">813</span>   <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">first</span>
<span class="line-num">814</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_account_from_login'>
<a name='method-i-_account_from_login'></a>
<div class='synopsis'>
<span class='name'>_account_from_login</span><span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_account_from_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_account_from_login-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">797</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_account_from_login</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">798</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">account_table_ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">login_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">login</span>)
<span class="line-num">799</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">account_select</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">account_select</span>
<span class="line-num">800</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">account_status_column</span><span class="ruby-operator">=&gt;</span>[<span class="ruby-identifier">account_unverified_status_value</span>, <span class="ruby-identifier">account_open_status_value</span>]) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">skip_status_checks?</span>
<span class="line-num">801</span>   <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">first</span>
<span class="line-num">802</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_account_from_refresh_token'>
<a name='method-i-_account_from_refresh_token'></a>
<div class='synopsis'>
<span class='name'>_account_from_refresh_token</span><span class='arguments'>(token)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_account_from_refresh_token-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_account_from_refresh_token-source'>    <span class="ruby-comment"># File lib/rodauth/features/jwt_refresh.rb</span>
<span class="line-num">111</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_account_from_refresh_token</span>(<span class="ruby-identifier">token</span>)
<span class="line-num">112</span>   <span class="ruby-identifier">id</span>, <span class="ruby-identifier">token_id</span>, <span class="ruby-identifier">key</span> = <span class="ruby-identifier">_account_refresh_token_split</span>(<span class="ruby-identifier">token</span>)
<span class="line-num">113</span> 
<span class="line-num">114</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">key</span> <span class="ruby-operator">&amp;&amp;</span>
<span class="line-num">115</span>          (<span class="ruby-identifier">id</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">session_value</span>.<span class="ruby-identifier">to_s</span>) <span class="ruby-operator">&amp;&amp;</span>
<span class="line-num">116</span>          (<span class="ruby-identifier">actual</span> = <span class="ruby-identifier">get_active_refresh_token</span>(<span class="ruby-identifier">id</span>, <span class="ruby-identifier">token_id</span>)) <span class="ruby-operator">&amp;&amp;</span>
<span class="line-num">117</span>          (<span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">convert_token_key</span>(<span class="ruby-identifier">actual</span>)) <span class="ruby-operator">||</span> (<span class="ruby-identifier">hmac_secret_rotation?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">compute_old_hmac</span>(<span class="ruby-identifier">actual</span>)))) <span class="ruby-operator">&amp;&amp;</span>
<span class="line-num">118</span>          <span class="ruby-identifier">jwt_refresh_token_match?</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">119</span>     <span class="ruby-keyword">return</span>
<span class="line-num">120</span>   <span class="ruby-keyword">end</span>
<span class="line-num">121</span> 
<span class="line-num">122</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">account_ds</span>(<span class="ruby-identifier">id</span>)
<span class="line-num">123</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">account_session_status_filter</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">skip_status_checks?</span>
<span class="line-num">124</span>   <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">first</span>
<span class="line-num">125</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_account_from_reset_password_key'>
<a name='method-i-_account_from_reset_password_key'></a>
<div class='synopsis'>
<span class='name'>_account_from_reset_password_key</span><span class='arguments'>(token)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_account_from_reset_password_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_account_from_reset_password_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/reset_password.rb</span>
<span class="line-num">256</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_account_from_reset_password_key</span>(<span class="ruby-identifier">token</span>)
<span class="line-num">257</span>   <span class="ruby-identifier">account_from_key</span>(<span class="ruby-identifier">token</span>, <span class="ruby-identifier">account_open_status_value</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">id</span><span class="ruby-operator">|</span> <span class="ruby-identifier">get_password_reset_key</span>(<span class="ruby-identifier">id</span>)}
<span class="line-num">258</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_account_from_session'>
<a name='method-i-_account_from_session'></a>
<div class='synopsis'>
<span class='name'>_account_from_session</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_account_from_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_account_from_session-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">804</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_account_from_session</span>
<span class="line-num">805</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">account_ds</span>(<span class="ruby-identifier">session_value</span>)
<span class="line-num">806</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">account_session_status_filter</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">skip_status_checks?</span>
<span class="line-num">807</span>   <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">first</span>
<span class="line-num">808</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_account_from_unlock_key'>
<a name='method-i-_account_from_unlock_key'></a>
<div class='synopsis'>
<span class='name'>_account_from_unlock_key</span><span class='arguments'>(token)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_account_from_unlock_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_account_from_unlock_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/lockout.rb</span>
<span class="line-num">297</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_account_from_unlock_key</span>(<span class="ruby-identifier">token</span>)
<span class="line-num">298</span>   <span class="ruby-identifier">account_from_key</span>(<span class="ruby-identifier">token</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">id</span><span class="ruby-operator">|</span> <span class="ruby-identifier">account_lockouts_ds</span>(<span class="ruby-identifier">id</span>).<span class="ruby-identifier">get</span>(<span class="ruby-identifier">account_lockouts_key_column</span>)}
<span class="line-num">299</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_account_from_verify_account_key'>
<a name='method-i-_account_from_verify_account_key'></a>
<div class='synopsis'>
<span class='name'>_account_from_verify_account_key</span><span class='arguments'>(token)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_account_from_verify_account_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_account_from_verify_account_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_account.rb</span>
<span class="line-num">302</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_account_from_verify_account_key</span>(<span class="ruby-identifier">token</span>)
<span class="line-num">303</span>   <span class="ruby-identifier">account_from_key</span>(<span class="ruby-identifier">token</span>, <span class="ruby-identifier">account_unverified_status_value</span>){<span class="ruby-operator">|</span><span class="ruby-identifier">id</span><span class="ruby-operator">|</span> <span class="ruby-identifier">get_verify_account_key</span>(<span class="ruby-identifier">id</span>)}
<span class="line-num">304</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_account_from_verify_login_change_key'>
<a name='method-i-_account_from_verify_login_change_key'></a>
<div class='synopsis'>
<span class='name'>_account_from_verify_login_change_key</span><span class='arguments'>(token)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_account_from_verify_login_change_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_account_from_verify_login_change_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb</span>
<span class="line-num">210</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_account_from_verify_login_change_key</span>(<span class="ruby-identifier">token</span>)
<span class="line-num">211</span>   <span class="ruby-identifier">account_from_key</span>(<span class="ruby-identifier">token</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">id</span><span class="ruby-operator">|</span>
<span class="line-num">212</span>     <span class="ruby-ivar">@verify_login_change_new_login</span>, <span class="ruby-identifier">key</span> = <span class="ruby-identifier">get_verify_login_change_login_and_key</span>(<span class="ruby-identifier">id</span>)
<span class="line-num">213</span>     <span class="ruby-identifier">key</span>
<span class="line-num">214</span>   <span class="ruby-keyword">end</span>
<span class="line-num">215</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_account_refresh_token_split'>
<a name='method-i-_account_refresh_token_split'></a>
<div class='synopsis'>
<span class='name'>_account_refresh_token_split</span><span class='arguments'>(token)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_account_refresh_token_split-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_account_refresh_token_split-source'>    <span class="ruby-comment"># File lib/rodauth/features/jwt_refresh.rb</span>
<span class="line-num">127</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_account_refresh_token_split</span>(<span class="ruby-identifier">token</span>)
<span class="line-num">128</span>   <span class="ruby-identifier">id</span>, <span class="ruby-identifier">token</span> = <span class="ruby-identifier">split_token</span>(<span class="ruby-identifier">token</span>)
<span class="line-num">129</span>   <span class="ruby-identifier">id</span> = <span class="ruby-identifier">convert_token_id</span>(<span class="ruby-identifier">id</span>)
<span class="line-num">130</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">id</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">token</span>
<span class="line-num">131</span> 
<span class="line-num">132</span>   <span class="ruby-identifier">token_id</span>, <span class="ruby-identifier">key</span> = <span class="ruby-identifier">split_token</span>(<span class="ruby-identifier">token</span>)
<span class="line-num">133</span>   <span class="ruby-identifier">token_id</span> = <span class="ruby-identifier">convert_token_id</span>(<span class="ruby-identifier">token_id</span>)
<span class="line-num">134</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">token_id</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">key</span>
<span class="line-num">135</span> 
<span class="line-num">136</span>   [<span class="ruby-identifier">id</span>, <span class="ruby-identifier">token_id</span>, <span class="ruby-identifier">key</span>]
<span class="line-num">137</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_around_rodauth'>
<a name='method-i-_around_rodauth'></a>
<div class='synopsis'>
<span class='name'>_around_rodauth</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_around_rodauth-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_around_rodauth-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">555</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_around_rodauth</span>
<span class="line-num">556</span>   <span class="ruby-keyword">yield</span>
<span class="line-num">557</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_email_auth_request'>
<a name='method-i-_email_auth_request'></a>
<div class='synopsis'>
<span class='name'>_email_auth_request</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_email_auth_request-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_email_auth_request-source'>    <span class="ruby-comment"># File lib/rodauth/features/email_auth.rb</span>
<span class="line-num">178</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_email_auth_request</span>
<span class="line-num">179</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">email_auth_email_recently_sent?</span>
<span class="line-num">180</span>     <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">email_auth_email_recently_sent_error_flash</span>
<span class="line-num">181</span>     <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">email_auth_email_recently_sent_redirect</span>
<span class="line-num">182</span>   <span class="ruby-keyword">end</span>
<span class="line-num">183</span> 
<span class="line-num">184</span>   <span class="ruby-identifier">generate_email_auth_key_value</span>
<span class="line-num">185</span>   <span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>
<span class="line-num">186</span>     <span class="ruby-identifier">before_email_auth_request</span>
<span class="line-num">187</span>     <span class="ruby-identifier">create_email_auth_key</span>
<span class="line-num">188</span>     <span class="ruby-identifier">send_email_auth_email</span>
<span class="line-num">189</span>     <span class="ruby-identifier">after_email_auth_request</span>
<span class="line-num">190</span>   <span class="ruby-keyword">end</span>
<span class="line-num">191</span> 
<span class="line-num">192</span>   <span class="ruby-identifier">email_auth_email_sent_response</span>
<span class="line-num">193</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_field_attributes'>
<a name='method-i-_field_attributes'></a>
<div class='synopsis'>
<span class='name'>_field_attributes</span><span class='arguments'>(field)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_field_attributes-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_field_attributes-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">829</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_field_attributes</span>(<span class="ruby-identifier">field</span>)
<span class="line-num">830</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">831</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_field_error_attributes'>
<a name='method-i-_field_error_attributes'></a>
<div class='synopsis'>
<span class='name'>_field_error_attributes</span><span class='arguments'>(field)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_field_error_attributes-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_field_error_attributes-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">833</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_field_error_attributes</span>(<span class="ruby-identifier">field</span>)
<span class="line-num">834</span>   <span class="ruby-node">&quot; aria-invalid=\&quot;true\&quot; aria-describedby=\&quot;#{field}_error_message\&quot; &quot;</span>
<span class="line-num">835</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_filter_links'>
<a name='method-i-_filter_links'></a>
<div class='synopsis'>
<span class='name'>_filter_links</span><span class='arguments'>(links)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_filter_links-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_filter_links-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">924</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_filter_links</span>(<span class="ruby-identifier">links</span>)
<span class="line-num">925</span>   <span class="ruby-identifier">links</span>.<span class="ruby-identifier">select!</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">_</span>, <span class="ruby-identifier">link</span><span class="ruby-operator">|</span> <span class="ruby-identifier">link</span>}
<span class="line-num">926</span>   <span class="ruby-identifier">links</span>.<span class="ruby-identifier">sort!</span>
<span class="line-num">927</span>   <span class="ruby-identifier">links</span>
<span class="line-num">928</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_formatted_field_error'>
<a name='method-i-_formatted_field_error'></a>
<div class='synopsis'>
<span class='name'>_formatted_field_error</span><span class='arguments'>(field, error)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_formatted_field_error-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_formatted_field_error-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">837</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_formatted_field_error</span>(<span class="ruby-identifier">field</span>, <span class="ruby-identifier">error</span>)
<span class="line-num">838</span>   <span class="ruby-node">&quot;&lt;span class=\&quot;#{input_field_error_message_class}\&quot; id=\&quot;#{field}_error_message\&quot;&gt;#{error}&lt;/span&gt;&quot;</span>
<span class="line-num">839</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_get_remember_cookie'>
<a name='method-i-_get_remember_cookie'></a>
<div class='synopsis'>
<span class='name'>_get_remember_cookie</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_get_remember_cookie-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_get_remember_cookie-source'>    <span class="ruby-comment"># File lib/rodauth/features/remember.rb</span>
<span class="line-num">231</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_get_remember_cookie</span>
<span class="line-num">232</span>   <span class="ruby-identifier">request</span>.<span class="ruby-identifier">cookies</span>[<span class="ruby-identifier">remember_cookie_key</span>]
<span class="line-num">233</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_json_response_body'>
<a name='method-i-_json_response_body'></a>
<div class='synopsis'>
<span class='name'>_json_response_body</span><span class='arguments'>(hash)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_json_response_body-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_json_response_body-source'>    <span class="ruby-comment"># File lib/rodauth/features/json.rb</span>
<span class="line-num">220</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_json_response_body</span>(<span class="ruby-identifier">hash</span>)
<span class="line-num">221</span>   <span class="ruby-identifier">request</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:convert_to_json</span>, <span class="ruby-identifier">hash</span>)
<span class="line-num">222</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_jwt_decode_opts'>
<a name='method-i-_jwt_decode_opts'></a>
<div class='synopsis'>
<span class='name'>_jwt_decode_opts</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_jwt_decode_opts-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_jwt_decode_opts-source'>    <span class="ruby-comment"># File lib/rodauth/features/jwt.rb</span>
<span class="line-num">104</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_jwt_decode_opts</span>
<span class="line-num">105</span>   <span class="ruby-identifier">jwt_decode_opts</span>
<span class="line-num">106</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_jwt_decode_secrets'>
<a name='method-i-_jwt_decode_secrets'></a>
<div class='synopsis'>
<span class='name'>_jwt_decode_secrets</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_jwt_decode_secrets-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_jwt_decode_secrets-source'>    <span class="ruby-comment"># File lib/rodauth/features/jwt.rb</span>
<span class="line-num">109</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_jwt_decode_secrets</span>
<span class="line-num">110</span>   <span class="ruby-identifier">secrets</span> = [<span class="ruby-identifier">jwt_secret</span>, <span class="ruby-identifier">jwt_old_secret</span>]
<span class="line-num">111</span>   <span class="ruby-identifier">secrets</span>.<span class="ruby-identifier">compact!</span>
<span class="line-num">112</span>   <span class="ruby-identifier">secrets</span>
<span class="line-num">113</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_login'>
<a name='method-i-_login'></a>
<div class='synopsis'>
<span class='name'>_login</span><span class='arguments'>(auth_type)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_login-source'>    <span class="ruby-comment"># File lib/rodauth/features/login.rb</span>
<span class="line-num">168</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_login</span>(<span class="ruby-identifier">auth_type</span>)
<span class="line-num">169</span>   <span class="ruby-identifier">warn</span>(<span class="ruby-string">&quot;Deprecated #_login method called, use #login instead.&quot;</span>)
<span class="line-num">170</span>   <span class="ruby-identifier">login</span>(<span class="ruby-identifier">auth_type</span>)
<span class="line-num">171</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_login_form_footer'>
<a name='method-i-_login_form_footer'></a>
<div class='synopsis'>
<span class='name'>_login_form_footer</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_login_form_footer-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_login_form_footer-source'>    <span class="ruby-comment"># File lib/rodauth/features/login.rb</span>
<span class="line-num">163</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_login_form_footer</span>
<span class="line-num">164</span>   <span class="ruby-keyword">return</span> <span class="ruby-string">&#39;&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">_login_form_footer_links</span>.<span class="ruby-identifier">empty?</span>
<span class="line-num">165</span>   <span class="ruby-identifier">render</span>(<span class="ruby-string">&#39;login-form-footer&#39;</span>)
<span class="line-num">166</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_login_form_footer_links'>
<a name='method-i-_login_form_footer_links'></a>
<div class='synopsis'>
<span class='name'>_login_form_footer_links</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_login_form_footer_links-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_login_form_footer_links-source'>    <span class="ruby-comment"># File lib/rodauth/features/create_account.rb</span>
<span class="line-num">117</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_login_form_footer_links</span>
<span class="line-num">118</span>   <span class="ruby-keyword">super</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-value">10</span>, <span class="ruby-identifier">create_account_path</span>, <span class="ruby-identifier">create_account_link_text</span>]
<span class="line-num">119</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_login_response'>
<a name='method-i-_login_response'></a>
<div class='synopsis'>
<span class='name'>_login_response</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_login_response-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_login_response-source'>    <span class="ruby-comment"># File lib/rodauth/features/login.rb</span>
<span class="line-num">148</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_login_response</span>
<span class="line-num">149</span>   <span class="ruby-identifier">set_notice_flash</span> <span class="ruby-identifier">login_notice_flash</span>
<span class="line-num">150</span>   <span class="ruby-identifier">redirect</span>(<span class="ruby-identifier">saved_login_redirect</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">login_redirect</span>)
<span class="line-num">151</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_merge_fixed_locals_opts'>
<a name='method-i-_merge_fixed_locals_opts'></a>
<div class='synopsis'>
<span class='name'>_merge_fixed_locals_opts</span><span class='arguments'>(opts, fixed_locals)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_merge_fixed_locals_opts-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_merge_fixed_locals_opts-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">975</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_merge_fixed_locals_opts</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-identifier">fixed_locals</span>)
<span class="line-num">976</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_template_fixed_locals?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">opts</span>[<span class="ruby-value">:locals</span>]
<span class="line-num">977</span>     <span class="ruby-identifier">fixed_locals_opts</span> = {<span class="ruby-value">default_fixed_locals:</span> <span class="ruby-identifier">fixed_locals</span>}
<span class="line-num">978</span>     <span class="ruby-identifier">fixed_locals_opts</span>.<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>[<span class="ruby-value">:template_opts</span>]) <span class="ruby-keyword">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:template_opts</span>]
<span class="line-num">979</span>     <span class="ruby-identifier">opts</span>[<span class="ruby-value">:template_opts</span>] = <span class="ruby-identifier">fixed_locals_opts</span>
<span class="line-num">980</span>   <span class="ruby-keyword">end</span>
<span class="line-num">981</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_multi_phase_login_forms'>
<a name='method-i-_multi_phase_login_forms'></a>
<div class='synopsis'>
<span class='name'>_multi_phase_login_forms</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_multi_phase_login_forms-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_multi_phase_login_forms-source'>    <span class="ruby-comment"># File lib/rodauth/features/email_auth.rb</span>
<span class="line-num">172</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_multi_phase_login_forms</span>
<span class="line-num">173</span>   <span class="ruby-identifier">forms</span> = <span class="ruby-keyword">super</span>
<span class="line-num">174</span>   <span class="ruby-identifier">forms</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-value">30</span>, <span class="ruby-identifier">email_auth_request_form</span>, <span class="ruby-value">:_email_auth_request</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">valid_login_entered?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">allow_email_auth?</span>
<span class="line-num">175</span>   <span class="ruby-identifier">forms</span>
<span class="line-num">176</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_new_account'>
<a name='method-i-_new_account'></a>
<div class='synopsis'>
<span class='name'>_new_account</span><span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_new_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_new_account-source'>    <span class="ruby-comment"># File lib/rodauth/features/create_account.rb</span>
<span class="line-num">121</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_new_account</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">122</span>   <span class="ruby-identifier">acc</span> = {<span class="ruby-identifier">login_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">login</span>}
<span class="line-num">123</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">skip_status_checks?</span>
<span class="line-num">124</span>     <span class="ruby-identifier">acc</span>[<span class="ruby-identifier">account_status_column</span>] = <span class="ruby-identifier">account_initial_status_value</span>
<span class="line-num">125</span>   <span class="ruby-keyword">end</span>
<span class="line-num">126</span>   <span class="ruby-identifier">acc</span>
<span class="line-num">127</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_otp'>
<a name='method-i-_otp'></a>
<div class='synopsis'>
<span class='name'>_otp</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_otp-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_otp-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">446</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_otp</span>
<span class="line-num">447</span>   <span class="ruby-identifier">_otp_for_key</span>(<span class="ruby-identifier">otp_user_key</span>)
<span class="line-num">448</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_otp_add_key'>
<a name='method-i-_otp_add_key'></a>
<div class='synopsis'>
<span class='name'>_otp_add_key</span><span class='arguments'>(secret)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_otp_add_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_otp_add_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">431</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_otp_add_key</span>(<span class="ruby-identifier">secret</span>)
<span class="line-num">432</span>   <span class="ruby-comment"># Uniqueness errors can&#39;t be handled here, as we can&#39;t be sure the secret provided</span>
<span class="line-num">433</span>   <span class="ruby-comment"># is the same as the current secret.</span>
<span class="line-num">434</span>   <span class="ruby-identifier">otp_key_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">otp_keys_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session_value</span>, <span class="ruby-identifier">otp_keys_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">secret</span>)
<span class="line-num">435</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_otp_for_key'>
<a name='method-i-_otp_for_key'></a>
<div class='synopsis'>
<span class='name'>_otp_for_key</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_otp_for_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_otp_for_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">442</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_otp_for_key</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">443</span>   <span class="ruby-identifier">otp_class</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">key</span>, <span class="ruby-value">:issuer</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">otp_issuer</span>, <span class="ruby-value">:digits</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">otp_digits</span>, <span class="ruby-value">:interval</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">otp_interval</span>)
<span class="line-num">444</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_otp_interval'>
<a name='method-i-_otp_interval'></a>
<div class='synopsis'>
<span class='name'>_otp_interval</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_otp_interval-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_otp_interval-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">423</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_otp_interval</span>
<span class="line-num">424</span>   <span class="ruby-identifier">otp_interval</span> <span class="ruby-operator">||</span> <span class="ruby-value">30</span>
<span class="line-num">425</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_otp_key'>
<a name='method-i-_otp_key'></a>
<div class='synopsis'>
<span class='name'>_otp_key</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_otp_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_otp_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">437</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_otp_key</span>
<span class="line-num">438</span>   <span class="ruby-ivar">@otp_user_key</span> = <span class="ruby-keyword">nil</span>
<span class="line-num">439</span>   <span class="ruby-identifier">otp_key_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">otp_keys_column</span>)
<span class="line-num">440</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_otp_tmp_key'>
<a name='method-i-_otp_tmp_key'></a>
<div class='synopsis'>
<span class='name'>_otp_tmp_key</span><span class='arguments'>(secret)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_otp_tmp_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_otp_tmp_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">417</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_otp_tmp_key</span>(<span class="ruby-identifier">secret</span>)
<span class="line-num">418</span>   <span class="ruby-ivar">@otp_tmp_key</span> = <span class="ruby-keyword">true</span>
<span class="line-num">419</span>   <span class="ruby-ivar">@otp_user_key</span> = <span class="ruby-keyword">nil</span>
<span class="line-num">420</span>   <span class="ruby-ivar">@otp_key</span> = <span class="ruby-identifier">secret</span>
<span class="line-num">421</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_otp_valid_code-3F'>
<a name='method-i-_otp_valid_code-3F'></a>
<div class='synopsis'>
<span class='name'>_otp_valid_code?</span><span class='arguments'>(ot_pass, otp)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_otp_valid_code-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_otp_valid_code-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">262</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_otp_valid_code?</span>(<span class="ruby-identifier">ot_pass</span>, <span class="ruby-identifier">otp</span>)
<span class="line-num">263</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">otp_exists?</span>
<span class="line-num">264</span>   <span class="ruby-identifier">ot_pass</span> = <span class="ruby-identifier">ot_pass</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/\s+/</span>, <span class="ruby-string">&#39;&#39;</span>)
<span class="line-num">265</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">drift</span> = <span class="ruby-identifier">otp_drift</span>
<span class="line-num">266</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">otp</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:verify_with_drift</span>)
<span class="line-num">267</span>       <span class="ruby-comment"># :nocov:</span>
<span class="line-num">268</span>       <span class="ruby-identifier">otp</span>.<span class="ruby-identifier">verify_with_drift</span>(<span class="ruby-identifier">ot_pass</span>, <span class="ruby-identifier">drift</span>)
<span class="line-num">269</span>       <span class="ruby-comment"># :nocov:</span>
<span class="line-num">270</span>     <span class="ruby-keyword">else</span>
<span class="line-num">271</span>       <span class="ruby-identifier">otp</span>.<span class="ruby-identifier">verify</span>(<span class="ruby-identifier">ot_pass</span>, <span class="ruby-value">:drift_behind</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">drift</span>, <span class="ruby-value">:drift_ahead</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">drift</span>)
<span class="line-num">272</span>     <span class="ruby-keyword">end</span>
<span class="line-num">273</span>   <span class="ruby-keyword">else</span>
<span class="line-num">274</span>     <span class="ruby-identifier">otp</span>.<span class="ruby-identifier">verify</span>(<span class="ruby-identifier">ot_pass</span>)
<span class="line-num">275</span>   <span class="ruby-keyword">end</span>
<span class="line-num">276</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_otp_valid_code_for_old_secret'>
<a name='method-i-_otp_valid_code_for_old_secret'></a>
<div class='synopsis'>
<span class='name'>_otp_valid_code_for_old_secret</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>Called for valid OTP codes for old secrets</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_otp_valid_code_for_old_secret-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_otp_valid_code_for_old_secret-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">428</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_otp_valid_code_for_old_secret</span>
<span class="line-num">429</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_override_webauthn_credential_response_verify'>
<a name='method-i-_override_webauthn_credential_response_verify'></a>
<div class='synopsis'>
<span class='name'>_override_webauthn_credential_response_verify</span><span class='arguments'>(webauthn_credential)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_override_webauthn_credential_response_verify-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_override_webauthn_credential_response_verify-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">443</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_override_webauthn_credential_response_verify</span>(<span class="ruby-identifier">webauthn_credential</span>)
<span class="line-num">444</span>   <span class="ruby-comment"># no need to override</span>
<span class="line-num">445</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_process_raw_hmac'>
<a name='method-i-_process_raw_hmac'></a>
<div class='synopsis'>
<span class='name'>_process_raw_hmac</span><span class='arguments'>(hmac)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_process_raw_hmac-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_process_raw_hmac-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">559</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_process_raw_hmac</span>(<span class="ruby-identifier">hmac</span>)
<span class="line-num">560</span>   <span class="ruby-identifier">s</span> = [<span class="ruby-identifier">hmac</span>].<span class="ruby-identifier">pack</span>(<span class="ruby-string">&#39;m&#39;</span>)
<span class="line-num">561</span>   <span class="ruby-identifier">s</span>.<span class="ruby-identifier">chomp!</span>(<span class="ruby-string">&quot;=\n&quot;</span>)
<span class="line-num">562</span>   <span class="ruby-identifier">s</span>.<span class="ruby-identifier">tr!</span>(<span class="ruby-string">&#39;+/&#39;</span>, <span class="ruby-string">&#39;-_&#39;</span>)
<span class="line-num">563</span>   <span class="ruby-identifier">s</span>
<span class="line-num">564</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_recovery_codes'>
<a name='method-i-_recovery_codes'></a>
<div class='synopsis'>
<span class='name'>_recovery_codes</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_recovery_codes-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_recovery_codes-source'>    <span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb</span>
<span class="line-num">260</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_recovery_codes</span>
<span class="line-num">261</span>   <span class="ruby-identifier">recovery_codes_ds</span>.<span class="ruby-identifier">select_map</span>(<span class="ruby-identifier">recovery_codes_column</span>)
<span class="line-num">262</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_return_json_response'>
<a name='method-i-_return_json_response'></a>
<div class='synopsis'>
<span class='name'>_return_json_response</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_return_json_response-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_return_json_response-source'>    <span class="ruby-comment"># File lib/rodauth/features/json.rb</span>
<span class="line-num">210</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_return_json_response</span>
<span class="line-num">211</span>   <span class="ruby-identifier">response</span>.<span class="ruby-identifier">status</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">json_response_error_status</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">json_response_error?</span>
<span class="line-num">212</span>   <span class="ruby-identifier">response</span>.<span class="ruby-identifier">headers</span>[<span class="ruby-identifier">convert_response_header_key</span>(<span class="ruby-string">&#39;content-type&#39;</span>)] <span class="ruby-operator">||=</span> <span class="ruby-identifier">json_response_content_type</span>
<span class="line-num">213</span>   <span class="ruby-identifier">return_response</span> <span class="ruby-identifier">_json_response_body</span>(<span class="ruby-identifier">json_response</span>)
<span class="line-num">214</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_set_otp_unlock_info'>
<a name='method-i-_set_otp_unlock_info'></a>
<div class='synopsis'>
<span class='name'>_set_otp_unlock_info</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_set_otp_unlock_info-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_set_otp_unlock_info-source'>   <span class="ruby-comment"># File lib/rodauth/features/json.rb</span>
<span class="line-num">80</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_set_otp_unlock_info</span>
<span class="line-num">81</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_json?</span>
<span class="line-num">82</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-value">:num_successes</span>] = <span class="ruby-identifier">otp_unlock_num_successes</span>
<span class="line-num">83</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-value">:required_successes</span>] = <span class="ruby-identifier">otp_unlock_auths_required</span>
<span class="line-num">84</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-value">:next_attempt_after</span>] = <span class="ruby-identifier">otp_unlock_next_auth_attempt_after</span>.<span class="ruby-identifier">to_i</span>
<span class="line-num">85</span>   <span class="ruby-keyword">end</span>
<span class="line-num">86</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_set_remember_cookie'>
<a name='method-i-_set_remember_cookie'></a>
<div class='synopsis'>
<span class='name'>_set_remember_cookie</span><span class='arguments'>(account_id, remember_key_value, deadline)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_set_remember_cookie-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_set_remember_cookie-source'>    <span class="ruby-comment"># File lib/rodauth/features/remember.rb</span>
<span class="line-num">180</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_set_remember_cookie</span>(<span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">remember_key_value</span>, <span class="ruby-identifier">deadline</span>)
<span class="line-num">181</span>   <span class="ruby-identifier">opts</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-identifier">remember_cookie_options</span>]
<span class="line-num">182</span>   <span class="ruby-identifier">opts</span>[<span class="ruby-value">:value</span>] = <span class="ruby-node">&quot;#{account_id}_#{convert_token_key(remember_key_value)}&quot;</span>
<span class="line-num">183</span>   <span class="ruby-identifier">opts</span>[<span class="ruby-value">:expires</span>] = <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">deadline</span>)
<span class="line-num">184</span>   <span class="ruby-identifier">opts</span>[<span class="ruby-value">:path</span>] = <span class="ruby-string">&quot;/&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-value">:path</span>)
<span class="line-num">185</span>   <span class="ruby-identifier">opts</span>[<span class="ruby-value">:httponly</span>] = <span class="ruby-keyword">true</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-value">:httponly</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-value">:http_only</span>)
<span class="line-num">186</span>   <span class="ruby-identifier">opts</span>[<span class="ruby-value">:secure</span>] = <span class="ruby-keyword">true</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-value">:secure</span>) <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">request</span>.<span class="ruby-identifier">ssl?</span>
<span class="line-num">187</span>   <span class="ruby-operator">::</span><span class="ruby-constant">Rack</span><span class="ruby-operator">::</span><span class="ruby-constant">Utils</span>.<span class="ruby-identifier">set_cookie_header!</span>(<span class="ruby-identifier">response</span>.<span class="ruby-identifier">headers</span>, <span class="ruby-identifier">remember_cookie_key</span>, <span class="ruby-identifier">opts</span>)
<span class="line-num">188</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_setup_account_lockouts_hash'>
<a name='method-i-_setup_account_lockouts_hash'></a>
<div class='synopsis'>
<span class='name'>_setup_account_lockouts_hash</span><span class='arguments'>(account_id, key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_setup_account_lockouts_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_setup_account_lockouts_hash-source'>    <span class="ruby-comment"># File lib/rodauth/features/lockout.rb</span>
<span class="line-num">169</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_setup_account_lockouts_hash</span>(<span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">key</span>)
<span class="line-num">170</span>   <span class="ruby-identifier">hash</span> = {<span class="ruby-identifier">account_lockouts_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">account_lockouts_key_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">key</span>}
<span class="line-num">171</span>   <span class="ruby-identifier">set_deadline_value</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">account_lockouts_deadline_column</span>, <span class="ruby-identifier">account_lockouts_deadline_interval</span>)
<span class="line-num">172</span>   <span class="ruby-identifier">hash</span>
<span class="line-num">173</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_sms'>
<a name='method-i-_sms'></a>
<div class='synopsis'>
<span class='name'>_sms</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_sms-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_sms-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">524</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_sms</span>
<span class="line-num">525</span>   <span class="ruby-identifier">sms_ds</span>.<span class="ruby-identifier">first</span>
<span class="line-num">526</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_sms_request_response'>
<a name='method-i-_sms_request_response'></a>
<div class='synopsis'>
<span class='name'>_sms_request_response</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_sms_request_response-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_sms_request_response-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">472</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_sms_request_response</span>
<span class="line-num">473</span>   <span class="ruby-identifier">set_notice_flash</span> <span class="ruby-identifier">sms_request_notice_flash</span>
<span class="line-num">474</span>   <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">sms_auth_redirect</span>
<span class="line-num">475</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_template_opts'>
<a name='method-i-_template_opts'></a>
<div class='synopsis'>
<span class='name'>_template_opts</span><span class='arguments'>(opts, page)</span>

</div>
<div class='description'>

<p>Set the template path only if there isn’t an overridden template in the application. Result should replace existing template opts.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_template_opts-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_template_opts-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">985</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_template_opts</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-identifier">page</span>)
<span class="line-num">986</span>   <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:find_template</span>, <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:parse_template_opts</span>, <span class="ruby-identifier">page</span>, <span class="ruby-identifier">opts</span>))
<span class="line-num">987</span>   <span class="ruby-keyword">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">file?</span>(<span class="ruby-identifier">scope</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:template_path</span>, <span class="ruby-identifier">opts</span>))
<span class="line-num">988</span>     <span class="ruby-identifier">opts</span>[<span class="ruby-value">:path</span>] = <span class="ruby-identifier">template_path</span>(<span class="ruby-identifier">page</span>)
<span class="line-num">989</span>   <span class="ruby-keyword">end</span>
<span class="line-num">990</span>   <span class="ruby-identifier">opts</span>
<span class="line-num">991</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_two_factor_auth_links'>
<a name='method-i-_two_factor_auth_links'></a>
<div class='synopsis'>
<span class='name'>_two_factor_auth_links</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_two_factor_auth_links-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_two_factor_auth_links-source'>   <span class="ruby-comment"># File lib/rodauth/features/confirm_password.rb</span>
<span class="line-num">79</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_two_factor_auth_links</span>
<span class="line-num">80</span>   <span class="ruby-identifier">links</span> = (<span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)) <span class="ruby-operator">||</span> []
<span class="line-num">81</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">authenticated_by</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">authenticated_by</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">&#39;password&#39;</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">has_password?</span>
<span class="line-num">82</span>     <span class="ruby-identifier">links</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-value">5</span>, <span class="ruby-identifier">confirm_password_path</span>, <span class="ruby-identifier">confirm_password_link_text</span>]
<span class="line-num">83</span>   <span class="ruby-keyword">end</span>
<span class="line-num">84</span>   <span class="ruby-identifier">links</span>
<span class="line-num">85</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_two_factor_auth_response'>
<a name='method-i-_two_factor_auth_response'></a>
<div class='synopsis'>
<span class='name'>_two_factor_auth_response</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_two_factor_auth_response-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_two_factor_auth_response-source'>    <span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb</span>
<span class="line-num">248</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_two_factor_auth_response</span>
<span class="line-num">249</span>   <span class="ruby-identifier">saved_two_factor_auth_redirect</span> = <span class="ruby-identifier">remove_session_value</span>(<span class="ruby-identifier">two_factor_auth_redirect_session_key</span>)
<span class="line-num">250</span>   <span class="ruby-identifier">set_notice_flash</span> <span class="ruby-identifier">two_factor_auth_notice_flash</span>
<span class="line-num">251</span>   <span class="ruby-identifier">redirect</span>(<span class="ruby-identifier">saved_two_factor_auth_redirect</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">two_factor_auth_redirect</span>)
<span class="line-num">252</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_two_factor_remove_all_from_session'>
<a name='method-i-_two_factor_remove_all_from_session'></a>
<div class='synopsis'>
<span class='name'>_two_factor_remove_all_from_session</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_two_factor_remove_all_from_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_two_factor_remove_all_from_session-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">365</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_two_factor_remove_all_from_session</span>
<span class="line-num">366</span>   <span class="ruby-identifier">two_factor_remove_session</span>(<span class="ruby-string">&#39;totp&#39;</span>)
<span class="line-num">367</span>   <span class="ruby-keyword">super</span>
<span class="line-num">368</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_two_factor_remove_links'>
<a name='method-i-_two_factor_remove_links'></a>
<div class='synopsis'>
<span class='name'>_two_factor_remove_links</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_two_factor_remove_links-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_two_factor_remove_links-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">359</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_two_factor_remove_links</span>
<span class="line-num">360</span>   <span class="ruby-identifier">links</span> = <span class="ruby-keyword">super</span>
<span class="line-num">361</span>   <span class="ruby-identifier">links</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-value">20</span>, <span class="ruby-identifier">otp_disable_path</span>, <span class="ruby-identifier">otp_disable_link_text</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">otp_exists?</span>
<span class="line-num">362</span>   <span class="ruby-identifier">links</span>
<span class="line-num">363</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_two_factor_setup_links'>
<a name='method-i-_two_factor_setup_links'></a>
<div class='synopsis'>
<span class='name'>_two_factor_setup_links</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_two_factor_setup_links-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_two_factor_setup_links-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">353</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_two_factor_setup_links</span>
<span class="line-num">354</span>   <span class="ruby-identifier">links</span> = <span class="ruby-keyword">super</span>
<span class="line-num">355</span>   <span class="ruby-identifier">links</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-value">20</span>, <span class="ruby-identifier">otp_setup_path</span>, <span class="ruby-identifier">otp_setup_link_text</span>] <span class="ruby-keyword">unless</span> <span class="ruby-identifier">otp_exists?</span>
<span class="line-num">356</span>   <span class="ruby-identifier">links</span>
<span class="line-num">357</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_update_login'>
<a name='method-i-_update_login'></a>
<div class='synopsis'>
<span class='name'>_update_login</span><span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_update_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_update_login-source'>   <span class="ruby-comment"># File lib/rodauth/features/change_login.rb</span>
<span class="line-num">83</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_update_login</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">84</span>   <span class="ruby-identifier">updated</span> = <span class="ruby-keyword">nil</span>
<span class="line-num">85</span>   <span class="ruby-identifier">raised</span> = <span class="ruby-identifier">raises_uniqueness_violation?</span>{<span class="ruby-identifier">updated</span> = <span class="ruby-identifier">update_account</span>({<span class="ruby-identifier">login_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">login</span>}, <span class="ruby-identifier">account_ds</span>.<span class="ruby-identifier">exclude</span>(<span class="ruby-identifier">login_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">login</span>)) <span class="ruby-operator">==</span> <span class="ruby-value">1</span>}
<span class="line-num">86</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">raised</span>
<span class="line-num">87</span>     <span class="ruby-identifier">set_login_requirement_error_message</span>(<span class="ruby-value">:already_an_account_with_this_login</span>, <span class="ruby-identifier">already_an_account_with_this_login_message</span>)
<span class="line-num">88</span>   <span class="ruby-keyword">end</span>
<span class="line-num">89</span>   <span class="ruby-identifier">updated</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">raised</span>
<span class="line-num">90</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_view'>
<a name='method-i-_view'></a>
<div class='synopsis'>
<span class='name'>_view</span><span class='arguments'>(meth, page)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_view-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_view-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">993</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_view</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-identifier">page</span>)
<span class="line-num">994</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">meth</span>)
<span class="line-num">995</span>     <span class="ruby-identifier">raise</span> <span class="ruby-constant">ConfigurationError</span>, <span class="ruby-node">&quot;attempted to render a built-in view/email template (#{page.inspect}), but rendering is disabled&quot;</span>
<span class="line-num">996</span>   <span class="ruby-keyword">end</span>
<span class="line-num">997</span> 
<span class="line-num">998</span>   <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-identifier">_view_opts</span>(<span class="ruby-identifier">page</span>))
<span class="line-num">999</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-_view_opts'>
<a name='method-i-_view_opts'></a>
<div class='synopsis'>
<span class='name'>_view_opts</span><span class='arguments'>(page)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-_view_opts-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-_view_opts-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">965</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">_view_opts</span>(<span class="ruby-identifier">page</span>)
<span class="line-num">966</span>   <span class="ruby-identifier">opts</span> = <span class="ruby-identifier">template_opts</span>.<span class="ruby-identifier">dup</span>
<span class="line-num">967</span>   <span class="ruby-identifier">_merge_fixed_locals_opts</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-string">&#39;(rodauth: self.rodauth)&#39;</span>)
<span class="line-num">968</span>   <span class="ruby-identifier">opts</span>[<span class="ruby-value">:locals</span>] = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:locals</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:locals</span>].<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> {}
<span class="line-num">969</span>   <span class="ruby-identifier">opts</span>[<span class="ruby-value">:locals</span>][<span class="ruby-value">:rodauth</span>] = <span class="ruby-keyword">self</span>
<span class="line-num">970</span>   <span class="ruby-identifier">opts</span>[<span class="ruby-value">:cache</span>] = <span class="ruby-identifier">cache_templates</span>
<span class="line-num">971</span>   <span class="ruby-identifier">opts</span>[<span class="ruby-value">:cache_key</span>] = <span class="ruby-value">:&quot;rodauth_#{page}&quot;</span>
<span class="line-num">972</span>   <span class="ruby-identifier">_template_opts</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-identifier">page</span>)
<span class="line-num">973</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account-21'>
<a name='method-i-account-21'></a>
<div class='synopsis'>
<span class='name'>account!</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account-21-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account-21-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">383</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account!</span>
<span class="line-num">384</span>   <span class="ruby-identifier">account</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">session_value</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">account_from_session</span>)
<span class="line-num">385</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_activity_ds'>
<a name='method-i-account_activity_ds'></a>
<div class='synopsis'>
<span class='name'>account_activity_ds</span><span class='arguments'>(account_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_activity_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_activity_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb</span>
<span class="line-num">104</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_activity_ds</span>(<span class="ruby-identifier">account_id</span>)
<span class="line-num">105</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">account_activity_table</span>].
<span class="line-num">106</span>     <span class="ruby-identifier">where</span>(<span class="ruby-identifier">account_activity_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>)
<span class="line-num">107</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_ds'>
<a name='method-i-account_ds'></a>
<div class='synopsis'>
<span class='name'>account_ds</span><span class='arguments'>(id=account_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">849</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_ds</span>(<span class="ruby-identifier">id</span>=<span class="ruby-identifier">account_id</span>)
<span class="line-num">850</span>   <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-string">&quot;invalid account id passed to account_ds&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">id</span>
<span class="line-num">851</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">account_table_ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">account_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">id</span>)
<span class="line-num">852</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">select</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">account_select</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">account_select</span>
<span class="line-num">853</span>   <span class="ruby-identifier">ds</span>
<span class="line-num">854</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_expired-3F'>
<a name='method-i-account_expired-3F'></a>
<div class='synopsis'>
<span class='name'>account_expired?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_expired-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_expired-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb</span>
<span class="line-num">54</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_expired?</span>
<span class="line-num">55</span>   <span class="ruby-identifier">columns</span> = [<span class="ruby-identifier">account_activity_last_activity_column</span>, <span class="ruby-identifier">account_activity_last_login_column</span>, <span class="ruby-identifier">account_activity_expired_column</span>]
<span class="line-num">56</span>   <span class="ruby-identifier">last_activity</span>, <span class="ruby-identifier">last_login</span>, <span class="ruby-identifier">expired</span> = <span class="ruby-identifier">account_activity_ds</span>(<span class="ruby-identifier">account_id</span>).<span class="ruby-identifier">get</span>(<span class="ruby-identifier">columns</span>)
<span class="line-num">57</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">expired</span>
<span class="line-num">58</span>   <span class="ruby-identifier">timestamp</span> = <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">expire_account_on_last_activity?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">last_activity</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">last_login</span>)
<span class="line-num">59</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">timestamp</span>
<span class="line-num">60</span>   <span class="ruby-identifier">timestamp</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">expire_account_after</span>
<span class="line-num">61</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_expired_at'>
<a name='method-i-account_expired_at'></a>
<div class='synopsis'>
<span class='name'>account_expired_at</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_expired_at-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_expired_at-source'>   <span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb</span>
<span class="line-num">35</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_expired_at</span>
<span class="line-num">36</span>   <span class="ruby-identifier">get_activity_timestamp</span>(<span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">account_activity_expired_column</span>)
<span class="line-num">37</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_from_email_auth_key'>
<a name='method-i-account_from_email_auth_key'></a>
<div class='synopsis'>
<span class='name'>account_from_email_auth_key</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_from_email_auth_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_from_email_auth_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/email_auth.rb</span>
<span class="line-num">131</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_from_email_auth_key</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">132</span>   <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">_account_from_email_auth_key</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">133</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_from_id'>
<a name='method-i-account_from_id'></a>
<div class='synopsis'>
<span class='name'>account_from_id</span><span class='arguments'>(id, status_id=nil)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_from_id-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_from_id-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">391</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_from_id</span>(<span class="ruby-identifier">id</span>, <span class="ruby-identifier">status_id</span>=<span class="ruby-keyword">nil</span>)
<span class="line-num">392</span>   <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">_account_from_id</span>(<span class="ruby-identifier">id</span>, <span class="ruby-identifier">status_id</span>)
<span class="line-num">393</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_from_key'>
<a name='method-i-account_from_key'></a>
<div class='synopsis'>
<span class='name'>account_from_key</span><span class='arguments'>(token, status_id=nil)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_from_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_from_key-source'>   <span class="ruby-comment"># File lib/rodauth/features/email_base.rb</span>
<span class="line-num">65</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_from_key</span>(<span class="ruby-identifier">token</span>, <span class="ruby-identifier">status_id</span>=<span class="ruby-keyword">nil</span>)
<span class="line-num">66</span>   <span class="ruby-identifier">id</span>, <span class="ruby-identifier">key</span> = <span class="ruby-identifier">split_token</span>(<span class="ruby-identifier">token</span>)
<span class="line-num">67</span>   <span class="ruby-identifier">id</span> = <span class="ruby-identifier">convert_token_id</span>(<span class="ruby-identifier">id</span>)
<span class="line-num">68</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">id</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">key</span>
<span class="line-num">69</span> 
<span class="line-num">70</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">actual</span> = <span class="ruby-keyword">yield</span>(<span class="ruby-identifier">id</span>)
<span class="line-num">71</span> 
<span class="line-num">72</span>   <span class="ruby-keyword">unless</span> (<span class="ruby-identifier">hmac_secret</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">convert_email_token_key</span>(<span class="ruby-identifier">actual</span>))) <span class="ruby-operator">||</span>
<span class="line-num">73</span>      (<span class="ruby-identifier">hmac_secret_rotation?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">compute_old_hmac</span>(<span class="ruby-identifier">actual</span>))) <span class="ruby-operator">||</span>
<span class="line-num">74</span>      ((<span class="ruby-operator">!</span><span class="ruby-identifier">hmac_secret</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">allow_raw_email_token?</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">actual</span>))
<span class="line-num">75</span>     <span class="ruby-keyword">return</span>
<span class="line-num">76</span>   <span class="ruby-keyword">end</span>
<span class="line-num">77</span>   <span class="ruby-identifier">_account_from_id</span>(<span class="ruby-identifier">id</span>, <span class="ruby-identifier">status_id</span>)
<span class="line-num">78</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_from_login'>
<a name='method-i-account_from_login'></a>
<div class='synopsis'>
<span class='name'>account_from_login</span><span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_from_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_from_login-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">281</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_from_login</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">282</span>   <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">_account_from_login</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">283</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_from_refresh_token'>
<a name='method-i-account_from_refresh_token'></a>
<div class='synopsis'>
<span class='name'>account_from_refresh_token</span><span class='arguments'>(token)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_from_refresh_token-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_from_refresh_token-source'>   <span class="ruby-comment"># File lib/rodauth/features/jwt_refresh.rb</span>
<span class="line-num">88</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_from_refresh_token</span>(<span class="ruby-identifier">token</span>)
<span class="line-num">89</span>   <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">_account_from_refresh_token</span>(<span class="ruby-identifier">token</span>)
<span class="line-num">90</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_from_remember_cookie'>
<a name='method-i-account_from_remember_cookie'></a>
<div class='synopsis'>
<span class='name'>account_from_remember_cookie</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_from_remember_cookie-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_from_remember_cookie-source'>    <span class="ruby-comment"># File lib/rodauth/features/remember.rb</span>
<span class="line-num">211</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_from_remember_cookie</span>
<span class="line-num">212</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">id</span> = <span class="ruby-identifier">remembered_session_id</span>
<span class="line-num">213</span>     <span class="ruby-comment"># Only set expired cookie if there is already a cookie set.</span>
<span class="line-num">214</span>     <span class="ruby-identifier">forget_login</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">_get_remember_cookie</span>
<span class="line-num">215</span>     <span class="ruby-keyword">return</span>
<span class="line-num">216</span>   <span class="ruby-keyword">end</span>
<span class="line-num">217</span> 
<span class="line-num">218</span>   <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">session_key</span>, <span class="ruby-identifier">id</span>)
<span class="line-num">219</span>   <span class="ruby-identifier">account_from_session</span>
<span class="line-num">220</span>   <span class="ruby-identifier">remove_session_value</span>(<span class="ruby-identifier">session_key</span>)
<span class="line-num">221</span> 
<span class="line-num">222</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">account</span>
<span class="line-num">223</span>     <span class="ruby-identifier">remove_remember_key</span>(<span class="ruby-identifier">id</span>)
<span class="line-num">224</span>     <span class="ruby-identifier">forget_login</span>
<span class="line-num">225</span>     <span class="ruby-keyword">return</span>
<span class="line-num">226</span>   <span class="ruby-keyword">end</span>
<span class="line-num">227</span> 
<span class="line-num">228</span>   <span class="ruby-identifier">account</span>
<span class="line-num">229</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_from_reset_password_key'>
<a name='method-i-account_from_reset_password_key'></a>
<div class='synopsis'>
<span class='name'>account_from_reset_password_key</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_from_reset_password_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_from_reset_password_key-source'>   <span class="ruby-comment"># File lib/rodauth/features/password_expiration.rb</span>
<span class="line-num">45</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_from_reset_password_key</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">46</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">a</span> = <span class="ruby-keyword">super</span>
<span class="line-num">47</span>     <span class="ruby-identifier">check_password_change_allowed</span>
<span class="line-num">48</span>   <span class="ruby-keyword">end</span>
<span class="line-num">49</span>   <span class="ruby-identifier">a</span>
<span class="line-num">50</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_from_session'>
<a name='method-i-account_from_session'></a>
<div class='synopsis'>
<span class='name'>account_from_session</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_from_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_from_session-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">387</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_from_session</span>
<span class="line-num">388</span>   <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">_account_from_session</span>
<span class="line-num">389</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_from_unlock_key'>
<a name='method-i-account_from_unlock_key'></a>
<div class='synopsis'>
<span class='name'>account_from_unlock_key</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_from_unlock_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_from_unlock_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/lockout.rb</span>
<span class="line-num">220</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_from_unlock_key</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">221</span>   <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">_account_from_unlock_key</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">222</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_from_verify_account_key'>
<a name='method-i-account_from_verify_account_key'></a>
<div class='synopsis'>
<span class='name'>account_from_verify_account_key</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_from_verify_account_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_from_verify_account_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_account.rb</span>
<span class="line-num">196</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_from_verify_account_key</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">197</span>   <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">_account_from_verify_account_key</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">198</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_from_verify_login_change_key'>
<a name='method-i-account_from_verify_login_change_key'></a>
<div class='synopsis'>
<span class='name'>account_from_verify_login_change_key</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_from_verify_login_change_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_from_verify_login_change_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb</span>
<span class="line-num">120</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_from_verify_login_change_key</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">121</span>   <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">_account_from_verify_login_change_key</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">122</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_from_webauthn_login'>
<a name='method-i-account_from_webauthn_login'></a>
<div class='synopsis'>
<span class='name'>account_from_webauthn_login</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_from_webauthn_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_from_webauthn_login-source'>   <span class="ruby-comment"># File lib/rodauth/features/webauthn_autofill.rb</span>
<span class="line-num">45</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_from_webauthn_login</span>
<span class="line-num">46</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">param_or_nil</span>(<span class="ruby-identifier">login_param</span>)
<span class="line-num">47</span> 
<span class="line-num">48</span>   <span class="ruby-identifier">credential_id</span> = <span class="ruby-identifier">webauthn_auth_data</span>[<span class="ruby-string">&quot;id&quot;</span>]
<span class="line-num">49</span>   <span class="ruby-identifier">account_id</span> = <span class="ruby-identifier">db</span>[<span class="ruby-identifier">webauthn_keys_table</span>]
<span class="line-num">50</span>     .<span class="ruby-identifier">where</span>(<span class="ruby-identifier">webauthn_keys_webauthn_id_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">credential_id</span>)
<span class="line-num">51</span>     .<span class="ruby-identifier">get</span>(<span class="ruby-identifier">webauthn_keys_account_id_column</span>)
<span class="line-num">52</span> 
<span class="line-num">53</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">account_id</span>
<span class="line-num">54</span>     <span class="ruby-identifier">throw_error_reason</span>(<span class="ruby-value">:invalid_webauthn_id</span>, <span class="ruby-identifier">invalid_field_error_status</span>, <span class="ruby-identifier">webauthn_auth_param</span>, <span class="ruby-identifier">webauthn_invalid_webauthn_id_message</span>)
<span class="line-num">55</span>   <span class="ruby-keyword">end</span>
<span class="line-num">56</span> 
<span class="line-num">57</span>   <span class="ruby-identifier">account_from_id</span>(<span class="ruby-identifier">account_id</span>)
<span class="line-num">58</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_id'>
<a name='method-i-account_id'></a>
<div class='synopsis'>
<span class='name'>account_id</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_id-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_id-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">271</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_id</span>
<span class="line-num">272</span>   <span class="ruby-identifier">account</span>[<span class="ruby-identifier">account_id_column</span>]
<span class="line-num">273</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_in_unverified_grace_period-3F'>
<a name='method-i-account_in_unverified_grace_period-3F'></a>
<div class='synopsis'>
<span class='name'>account_in_unverified_grace_period?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_in_unverified_grace_period-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_in_unverified_grace_period-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/verify_account_grace_period.rb</span>
<span class="line-num">85</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_in_unverified_grace_period?</span>
<span class="line-num">86</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">account!</span>
<span class="line-num">87</span>   <span class="ruby-identifier">account</span>[<span class="ruby-identifier">account_status_column</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">account_unverified_status_value</span> <span class="ruby-operator">&amp;&amp;</span>
<span class="line-num">88</span>     <span class="ruby-identifier">verify_account_grace_period</span> <span class="ruby-operator">&amp;&amp;</span>
<span class="line-num">89</span>     <span class="ruby-operator">!</span><span class="ruby-identifier">verify_account_ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">date_add</span>(<span class="ruby-identifier">verification_requested_at_column</span>, <span class="ruby-value">:seconds</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">verify_account_grace_period</span>) <span class="ruby-operator">&gt;</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>).<span class="ruby-identifier">empty?</span>
<span class="line-num">90</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_initial_status_value'>
<a name='method-i-account_initial_status_value'></a>
<div class='synopsis'>
<span class='name'>account_initial_status_value</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_initial_status_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_initial_status_value-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">379</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_initial_status_value</span>
<span class="line-num">380</span>   <span class="ruby-identifier">account_open_status_value</span>
<span class="line-num">381</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_lockouts_ds'>
<a name='method-i-account_lockouts_ds'></a>
<div class='synopsis'>
<span class='name'>account_lockouts_ds</span><span class='arguments'>(id=account_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_lockouts_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_lockouts_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/lockout.rb</span>
<span class="line-num">293</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_lockouts_ds</span>(<span class="ruby-identifier">id</span>=<span class="ruby-identifier">account_id</span>)
<span class="line-num">294</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">account_lockouts_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">account_lockouts_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">id</span>)
<span class="line-num">295</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_login_failures_ds'>
<a name='method-i-account_login_failures_ds'></a>
<div class='synopsis'>
<span class='name'>account_login_failures_ds</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_login_failures_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_login_failures_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/lockout.rb</span>
<span class="line-num">289</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_login_failures_ds</span>
<span class="line-num">290</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">account_login_failures_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">account_login_failures_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>)
<span class="line-num">291</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_password_hash_column'>
<a name='method-i-account_password_hash_column'></a>
<div class='synopsis'>
<span class='name'>account_password_hash_column</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>If the <a href="Rodauth.html#method-i-account_password_hash_column"><code>account_password_hash_column</code></a> is set, the password hash is verified in ruby, it will not use a database function to do so, it will check the password hash using bcrypt.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_password_hash_column-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_password_hash_column-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">305</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_password_hash_column</span>
<span class="line-num">306</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">307</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_session_status_filter'>
<a name='method-i-account_session_status_filter'></a>
<div class='synopsis'>
<span class='name'>account_session_status_filter</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_session_status_filter-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_session_status_filter-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">841</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_session_status_filter</span>
<span class="line-num">842</span>   {<span class="ruby-identifier">account_status_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_open_status_value</span>}
<span class="line-num">843</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_table_ds'>
<a name='method-i-account_table_ds'></a>
<div class='synopsis'>
<span class='name'>account_table_ds</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_table_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_table_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">856</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_table_ds</span>
<span class="line-num">857</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">accounts_table</span>]
<span class="line-num">858</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_webauthn_ids'>
<a name='method-i-account_webauthn_ids'></a>
<div class='synopsis'>
<span class='name'>account_webauthn_ids</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_webauthn_ids-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_webauthn_ids-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">271</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_webauthn_ids</span>
<span class="line-num">272</span>   <span class="ruby-identifier">webauthn_keys_ds</span>.<span class="ruby-identifier">select_map</span>(<span class="ruby-identifier">webauthn_keys_webauthn_id_column</span>)
<span class="line-num">273</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_webauthn_usage'>
<a name='method-i-account_webauthn_usage'></a>
<div class='synopsis'>
<span class='name'>account_webauthn_usage</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_webauthn_usage-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_webauthn_usage-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">275</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_webauthn_usage</span>
<span class="line-num">276</span>   <span class="ruby-identifier">webauthn_keys_ds</span>.<span class="ruby-identifier">select_hash</span>(<span class="ruby-identifier">webauthn_keys_webauthn_id_column</span>, <span class="ruby-identifier">webauthn_keys_last_use_column</span>)
<span class="line-num">277</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-account_webauthn_user_id'>
<a name='method-i-account_webauthn_user_id'></a>
<div class='synopsis'>
<span class='name'>account_webauthn_user_id</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-account_webauthn_user_id-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-account_webauthn_user_id-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">279</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">account_webauthn_user_id</span>
<span class="line-num">280</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">webauthn_id</span> = <span class="ruby-identifier">webauthn_user_ids_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">webauthn_user_ids_webauthn_id_column</span>)
<span class="line-num">281</span>     <span class="ruby-identifier">webauthn_id</span> = <span class="ruby-constant">WebAuthn</span>.<span class="ruby-identifier">generate_user_id</span>
<span class="line-num">282</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">e</span> = <span class="ruby-identifier">raised_uniqueness_violation</span> <span class="ruby-keyword">do</span>
<span class="line-num">283</span>           <span class="ruby-identifier">webauthn_user_ids_ds</span>.<span class="ruby-identifier">insert</span>(
<span class="line-num">284</span>             <span class="ruby-identifier">webauthn_user_ids_account_id_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">webauthn_account_id</span>,
<span class="line-num">285</span>             <span class="ruby-identifier">webauthn_user_ids_webauthn_id_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">webauthn_id</span>
<span class="line-num">286</span>           )
<span class="line-num">287</span>         <span class="ruby-keyword">end</span>
<span class="line-num">288</span>       <span class="ruby-comment"># If two requests to create a webauthn user id are sent at the same time and an insert</span>
<span class="line-num">289</span>       <span class="ruby-comment"># is attempted for both, one will fail with a unique constraint violation.  In that case</span>
<span class="line-num">290</span>       <span class="ruby-comment"># it is safe for the second one to use the webauthn user id inserted by the other request.</span>
<span class="line-num">291</span>       <span class="ruby-comment"># If there is still no webauthn user id at this point, then we&#39;ll just reraise the</span>
<span class="line-num">292</span>       <span class="ruby-comment"># exception.</span>
<span class="line-num">293</span>       <span class="ruby-comment"># :nocov:</span>
<span class="line-num">294</span>       <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">webauthn_id</span> = <span class="ruby-identifier">webauthn_user_ids_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">webauthn_user_ids_webauthn_id_column</span>)
<span class="line-num">295</span>       <span class="ruby-comment"># :nocov:</span>
<span class="line-num">296</span>     <span class="ruby-keyword">end</span>
<span class="line-num">297</span>   <span class="ruby-keyword">end</span>
<span class="line-num">298</span> 
<span class="line-num">299</span>   <span class="ruby-identifier">webauthn_id</span>
<span class="line-num">300</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-active_remember_key_ds'>
<a name='method-i-active_remember_key_ds'></a>
<div class='synopsis'>
<span class='name'>active_remember_key_ds</span><span class='arguments'>(id=account_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-active_remember_key_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-active_remember_key_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/remember.rb</span>
<span class="line-num">259</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">active_remember_key_ds</span>(<span class="ruby-identifier">id</span>=<span class="ruby-identifier">account_id</span>)
<span class="line-num">260</span>   <span class="ruby-identifier">remember_key_ds</span>(<span class="ruby-identifier">id</span>).<span class="ruby-identifier">where</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">expr</span>(<span class="ruby-identifier">remember_deadline_column</span>) <span class="ruby-operator">&gt;</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>)
<span class="line-num">261</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-active_sessions_ds'>
<a name='method-i-active_sessions_ds'></a>
<div class='synopsis'>
<span class='name'>active_sessions_ds</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-active_sessions_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-active_sessions_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">199</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">active_sessions_ds</span>
<span class="line-num">200</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">active_sessions_table</span>].
<span class="line-num">201</span>     <span class="ruby-identifier">where</span>(<span class="ruby-identifier">active_sessions_account_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session_value</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">account_id</span>)
<span class="line-num">202</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-active_sessions_insert_hash'>
<a name='method-i-active_sessions_insert_hash'></a>
<div class='synopsis'>
<span class='name'>active_sessions_insert_hash</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-active_sessions_insert_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-active_sessions_insert_hash-source'>    <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">162</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">active_sessions_insert_hash</span>
<span class="line-num">163</span>   {<span class="ruby-identifier">active_sessions_account_id_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">session_value</span>, <span class="ruby-identifier">active_sessions_session_id_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">compute_hmac</span>(<span class="ruby-identifier">active_sessions_key</span>)}
<span class="line-num">164</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-active_sessions_update_hash'>
<a name='method-i-active_sessions_update_hash'></a>
<div class='synopsis'>
<span class='name'>active_sessions_update_hash</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-active_sessions_update_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-active_sessions_update_hash-source'>    <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">166</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">active_sessions_update_hash</span>
<span class="line-num">167</span>   <span class="ruby-identifier">h</span> = {<span class="ruby-identifier">active_sessions_last_use_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>}
<span class="line-num">168</span> 
<span class="line-num">169</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">hmac_secret_rotation?</span>
<span class="line-num">170</span>     <span class="ruby-identifier">h</span>[<span class="ruby-identifier">active_sessions_session_id_column</span>] = <span class="ruby-identifier">compute_hmac</span>(<span class="ruby-identifier">session</span>[<span class="ruby-identifier">session_id_session_key</span>])
<span class="line-num">171</span>   <span class="ruby-keyword">end</span>
<span class="line-num">172</span> 
<span class="line-num">173</span>   <span class="ruby-identifier">h</span>
<span class="line-num">174</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-add_active_session'>
<a name='method-i-add_active_session'></a>
<div class='synopsis'>
<span class='name'>add_active_session</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-add_active_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-add_active_session-source'>   <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">68</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_active_session</span>
<span class="line-num">69</span>   <span class="ruby-identifier">key</span> = <span class="ruby-identifier">generate_active_sessions_key</span>
<span class="line-num">70</span>   <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">session_id_session_key</span>, <span class="ruby-identifier">key</span>)
<span class="line-num">71</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">e</span> = <span class="ruby-identifier">raises_uniqueness_violation?</span>{<span class="ruby-identifier">active_sessions_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">active_sessions_insert_hash</span>)}
<span class="line-num">72</span>     <span class="ruby-identifier">handle_duplicate_active_session_id</span>(<span class="ruby-identifier">e</span>)
<span class="line-num">73</span>   <span class="ruby-keyword">end</span>
<span class="line-num">74</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">75</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-add_audit_log'>
<a name='method-i-add_audit_log'></a>
<div class='synopsis'>
<span class='name'>add_audit_log</span><span class='arguments'>(account_id, action)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-add_audit_log-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-add_audit_log-source'>   <span class="ruby-comment"># File lib/rodauth/features/audit_logging.rb</span>
<span class="line-num">39</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_audit_log</span>(<span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">action</span>)
<span class="line-num">40</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">hash</span> = <span class="ruby-identifier">audit_log_insert_hash</span>(<span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">action</span>)
<span class="line-num">41</span>     <span class="ruby-identifier">audit_log_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">hash</span>)
<span class="line-num">42</span>   <span class="ruby-keyword">end</span>
<span class="line-num">43</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-add_field_error_class'>
<a name='method-i-add_field_error_class'></a>
<div class='synopsis'>
<span class='name'>add_field_error_class</span><span class='arguments'>(field)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-add_field_error_class-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-add_field_error_class-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">186</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_field_error_class</span>(<span class="ruby-identifier">field</span>)
<span class="line-num">187</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">field_error</span>(<span class="ruby-identifier">field</span>)
<span class="line-num">188</span>     <span class="ruby-node">&quot; #{input_field_error_class}&quot;</span>
<span class="line-num">189</span>   <span class="ruby-keyword">end</span>
<span class="line-num">190</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-add_previous_password_hash'>
<a name='method-i-add_previous_password_hash'></a>
<div class='synopsis'>
<span class='name'>add_previous_password_hash</span><span class='arguments'>(hash)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-add_previous_password_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-add_previous_password_hash-source'>   <span class="ruby-comment"># File lib/rodauth/features/disallow_password_reuse.rb</span>
<span class="line-num">25</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_previous_password_hash</span>(<span class="ruby-identifier">hash</span>) 
<span class="line-num">26</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">previous_password_ds</span>
<span class="line-num">27</span> 
<span class="line-num">28</span>   <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@dont_check_previous_password</span>
<span class="line-num">29</span>     <span class="ruby-identifier">keep_before</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">reverse</span>(<span class="ruby-identifier">previous_password_id_column</span>).
<span class="line-num">30</span>       <span class="ruby-identifier">limit</span>(<span class="ruby-keyword">nil</span>, <span class="ruby-identifier">previous_passwords_to_check</span>).
<span class="line-num">31</span>       <span class="ruby-identifier">get</span>(<span class="ruby-identifier">previous_password_id_column</span>)
<span class="line-num">32</span> 
<span class="line-num">33</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">keep_before</span>
<span class="line-num">34</span>       <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">expr</span>(<span class="ruby-identifier">previous_password_id_column</span>) <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">keep_before</span>).
<span class="line-num">35</span>         <span class="ruby-identifier">delete</span>
<span class="line-num">36</span>     <span class="ruby-keyword">end</span>
<span class="line-num">37</span>   <span class="ruby-keyword">end</span>
<span class="line-num">38</span> 
<span class="line-num">39</span>   <span class="ruby-comment"># This should never raise uniqueness violations, as it uses a serial primary key</span>
<span class="line-num">40</span>   <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">previous_password_account_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">previous_password_hash_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">hash</span>)
<span class="line-num">41</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-add_recovery_code'>
<a name='method-i-add_recovery_code'></a>
<div class='synopsis'>
<span class='name'>add_recovery_code</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-add_recovery_code-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-add_recovery_code-source'>    <span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb</span>
<span class="line-num">187</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_recovery_code</span>
<span class="line-num">188</span>   <span class="ruby-comment"># This should never raise uniqueness violations unless the recovery code is the same, and the odds of that</span>
<span class="line-num">189</span>   <span class="ruby-comment"># are 1/256**32 assuming a good random number generator.  Still, attempt to handle that case by retrying</span>
<span class="line-num">190</span>   <span class="ruby-comment"># on such a uniqueness violation.</span>
<span class="line-num">191</span>   <span class="ruby-identifier">retry_on_uniqueness_violation</span> <span class="ruby-keyword">do</span>
<span class="line-num">192</span>     <span class="ruby-identifier">recovery_codes_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">recovery_codes_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session_value</span>, <span class="ruby-identifier">recovery_codes_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">new_recovery_code</span>)
<span class="line-num">193</span>   <span class="ruby-keyword">end</span>
<span class="line-num">194</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-add_recovery_codes'>
<a name='method-i-add_recovery_codes'></a>
<div class='synopsis'>
<span class='name'>add_recovery_codes</span><span class='arguments'>(number)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-add_recovery_codes-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-add_recovery_codes-source'>    <span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb</span>
<span class="line-num">177</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_recovery_codes</span>(<span class="ruby-identifier">number</span>)
<span class="line-num">178</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">number</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-value">0</span>
<span class="line-num">179</span>   <span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>
<span class="line-num">180</span>     <span class="ruby-identifier">number</span>.<span class="ruby-identifier">times</span> <span class="ruby-keyword">do</span>
<span class="line-num">181</span>       <span class="ruby-identifier">add_recovery_code</span>
<span class="line-num">182</span>     <span class="ruby-keyword">end</span>
<span class="line-num">183</span>   <span class="ruby-keyword">end</span>
<span class="line-num">184</span>   <span class="ruby-identifier">remove_instance_variable</span>(<span class="ruby-value">:@recovery_codes</span>)
<span class="line-num">185</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-add_remember_key'>
<a name='method-i-add_remember_key'></a>
<div class='synopsis'>
<span class='name'>add_remember_key</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-add_remember_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-add_remember_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/remember.rb</span>
<span class="line-num">159</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_remember_key</span>
<span class="line-num">160</span>   <span class="ruby-identifier">hash</span> = {<span class="ruby-identifier">remember_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">remember_key_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">remember_key_value</span>}
<span class="line-num">161</span>   <span class="ruby-identifier">set_deadline_value</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">remember_deadline_column</span>, <span class="ruby-identifier">remember_deadline_interval</span>)
<span class="line-num">162</span> 
<span class="line-num">163</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">e</span> = <span class="ruby-identifier">raised_uniqueness_violation</span>{<span class="ruby-identifier">remember_key_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">hash</span>)}
<span class="line-num">164</span>     <span class="ruby-comment"># If inserting into the remember key table causes a violation, we can pull the</span>
<span class="line-num">165</span>     <span class="ruby-comment"># existing row from the table.  If there is no invalid row, we can then reraise.</span>
<span class="line-num">166</span>     <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@remember_key_value</span> = <span class="ruby-identifier">active_remember_key_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">remember_key_column</span>)
<span class="line-num">167</span>   <span class="ruby-keyword">end</span>
<span class="line-num">168</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-add_webauthn_credential'>
<a name='method-i-add_webauthn_credential'></a>
<div class='synopsis'>
<span class='name'>add_webauthn_credential</span><span class='arguments'>(_)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-add_webauthn_credential-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-add_webauthn_credential-source'>    <span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb</span>
<span class="line-num">151</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">add_webauthn_credential</span>(<span class="ruby-identifier">_</span>)
<span class="line-num">152</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">153</span>   <span class="ruby-identifier">auto_add_missing_recovery_codes</span>
<span class="line-num">154</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_change_password'>
<a name='method-i-after_change_password'></a>
<div class='synopsis'>
<span class='name'>after_change_password</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_change_password-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_change_password-source'>   <span class="ruby-comment"># File lib/rodauth/features/change_password_notify.rb</span>
<span class="line-num">11</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_change_password</span>
<span class="line-num">12</span>   <span class="ruby-keyword">super</span>
<span class="line-num">13</span>   <span class="ruby-identifier">send_password_changed_email</span>
<span class="line-num">14</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_close_account'>
<a name='method-i-after_close_account'></a>
<div class='synopsis'>
<span class='name'>after_close_account</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_close_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_close_account-source'>    <span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb</span>
<span class="line-num"> 99</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_close_account</span>
<span class="line-num">100</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">101</span>   <span class="ruby-identifier">account_activity_ds</span>(<span class="ruby-identifier">account_id</span>).<span class="ruby-identifier">delete</span>
<span class="line-num">102</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_create_account'>
<a name='method-i-after_create_account'></a>
<div class='synopsis'>
<span class='name'>after_create_account</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_create_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_create_account-source'>   <span class="ruby-comment"># File lib/rodauth/features/disallow_password_reuse.rb</span>
<span class="line-num">87</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_create_account</span>
<span class="line-num">88</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">account_password_hash_column</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:verify_account_set_password?</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">verify_account_set_password?</span>)
<span class="line-num">89</span>     <span class="ruby-identifier">add_previous_password_hash</span>(<span class="ruby-identifier">password_hash</span>(<span class="ruby-identifier">param</span>(<span class="ruby-identifier">password_param</span>)))
<span class="line-num">90</span>   <span class="ruby-keyword">end</span>
<span class="line-num">91</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">92</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_login'>
<a name='method-i-after_login'></a>
<div class='synopsis'>
<span class='name'>after_login</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_login-source'>    <span class="ruby-comment"># File lib/rodauth/features/email_auth.rb</span>
<span class="line-num">201</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_login</span>
<span class="line-num">202</span>   <span class="ruby-comment"># Remove the email auth key after any login, even if</span>
<span class="line-num">203</span>   <span class="ruby-comment"># it is a password login.  This is done to invalidate</span>
<span class="line-num">204</span>   <span class="ruby-comment"># the email login when a user has a password and requests</span>
<span class="line-num">205</span>   <span class="ruby-comment"># email authentication, but then remembers their password</span>
<span class="line-num">206</span>   <span class="ruby-comment"># and doesn&#39;t need the link.  At that point, the link</span>
<span class="line-num">207</span>   <span class="ruby-comment"># that allows login access to the account becomes a</span>
<span class="line-num">208</span>   <span class="ruby-comment"># security liability, and it is best to remove it.</span>
<span class="line-num">209</span>   <span class="ruby-identifier">remove_email_auth_key</span>
<span class="line-num">210</span>   <span class="ruby-keyword">super</span>
<span class="line-num">211</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_login_entered_during_multi_phase_login'>
<a name='method-i-after_login_entered_during_multi_phase_login'></a>
<div class='synopsis'>
<span class='name'>after_login_entered_during_multi_phase_login</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_login_entered_during_multi_phase_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_login_entered_during_multi_phase_login-source'>    <span class="ruby-comment"># File lib/rodauth/features/email_auth.rb</span>
<span class="line-num">149</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_login_entered_during_multi_phase_login</span>
<span class="line-num">150</span>   <span class="ruby-comment"># If forcing email auth, just send the email link.</span>
<span class="line-num">151</span>   <span class="ruby-identifier">_email_auth_request</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">force_email_auth?</span>
<span class="line-num">152</span> 
<span class="line-num">153</span>   <span class="ruby-keyword">super</span>
<span class="line-num">154</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_login_failure'>
<a name='method-i-after_login_failure'></a>
<div class='synopsis'>
<span class='name'>after_login_failure</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_login_failure-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_login_failure-source'>    <span class="ruby-comment"># File lib/rodauth/features/lockout.rb</span>
<span class="line-num">260</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_login_failure</span>
<span class="line-num">261</span>   <span class="ruby-identifier">invalid_login_attempted</span>
<span class="line-num">262</span>   <span class="ruby-keyword">super</span>
<span class="line-num">263</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_logout'>
<a name='method-i-after_logout'></a>
<div class='synopsis'>
<span class='name'>after_logout</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_logout-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_logout-source'>    <span class="ruby-comment"># File lib/rodauth/features/remember.rb</span>
<span class="line-num">235</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_logout</span>
<span class="line-num">236</span>   <span class="ruby-identifier">forget_login</span>
<span class="line-num">237</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">238</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_otp_authentication_failure'>
<a name='method-i-after_otp_authentication_failure'></a>
<div class='synopsis'>
<span class='name'>after_otp_authentication_failure</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_otp_authentication_failure-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_otp_authentication_failure-source'>   <span class="ruby-comment"># File lib/rodauth/features/otp_lockout_email.rb</span>
<span class="line-num">18</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_otp_authentication_failure</span>
<span class="line-num">19</span>   <span class="ruby-keyword">super</span>
<span class="line-num">20</span> 
<span class="line-num">21</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">otp_locked_out?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">send_otp_locked_out_email?</span>
<span class="line-num">22</span>     <span class="ruby-identifier">send_otp_locked_out_email</span>
<span class="line-num">23</span>   <span class="ruby-keyword">end</span>
<span class="line-num">24</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_otp_disable'>
<a name='method-i-after_otp_disable'></a>
<div class='synopsis'>
<span class='name'>after_otp_disable</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_otp_disable-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_otp_disable-source'>   <span class="ruby-comment"># File lib/rodauth/features/otp_modify_email.rb</span>
<span class="line-num">18</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_otp_disable</span>
<span class="line-num">19</span>   <span class="ruby-keyword">super</span>
<span class="line-num">20</span>   <span class="ruby-identifier">send_otp_disabled_email</span>
<span class="line-num">21</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_otp_setup'>
<a name='method-i-after_otp_setup'></a>
<div class='synopsis'>
<span class='name'>after_otp_setup</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_otp_setup-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_otp_setup-source'>   <span class="ruby-comment"># File lib/rodauth/features/otp_modify_email.rb</span>
<span class="line-num">13</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_otp_setup</span>
<span class="line-num">14</span>   <span class="ruby-keyword">super</span>
<span class="line-num">15</span>   <span class="ruby-identifier">send_otp_setup_email</span>
<span class="line-num">16</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_otp_unlock_auth_failure'>
<a name='method-i-after_otp_unlock_auth_failure'></a>
<div class='synopsis'>
<span class='name'>after_otp_unlock_auth_failure</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_otp_unlock_auth_failure-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_otp_unlock_auth_failure-source'>   <span class="ruby-comment"># File lib/rodauth/features/json.rb</span>
<span class="line-num">96</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_otp_unlock_auth_failure</span>
<span class="line-num">97</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">98</span>   <span class="ruby-identifier">_set_otp_unlock_info</span>
<span class="line-num">99</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_otp_unlock_auth_success'>
<a name='method-i-after_otp_unlock_auth_success'></a>
<div class='synopsis'>
<span class='name'>after_otp_unlock_auth_success</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_otp_unlock_auth_success-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_otp_unlock_auth_success-source'>   <span class="ruby-comment"># File lib/rodauth/features/json.rb</span>
<span class="line-num">88</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_otp_unlock_auth_success</span>
<span class="line-num">89</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">90</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">otp_locked_out?</span>
<span class="line-num">91</span>     <span class="ruby-identifier">_set_otp_unlock_info</span>
<span class="line-num">92</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-value">:deadline</span>] = <span class="ruby-identifier">otp_unlock_deadline</span>.<span class="ruby-identifier">to_i</span>
<span class="line-num">93</span>   <span class="ruby-keyword">end</span>
<span class="line-num">94</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_otp_unlock_not_yet_available'>
<a name='method-i-after_otp_unlock_not_yet_available'></a>
<div class='synopsis'>
<span class='name'>after_otp_unlock_not_yet_available</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_otp_unlock_not_yet_available-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_otp_unlock_not_yet_available-source'>    <span class="ruby-comment"># File lib/rodauth/features/json.rb</span>
<span class="line-num">101</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_otp_unlock_not_yet_available</span>
<span class="line-num">102</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">103</span>   <span class="ruby-identifier">_set_otp_unlock_info</span>
<span class="line-num">104</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_refresh_token'>
<a name='method-i-after_refresh_token'></a>
<div class='synopsis'>
<span class='name'>after_refresh_token</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_refresh_token-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_refresh_token-source'>    <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">130</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_refresh_token</span>
<span class="line-num">131</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">132</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">prev_key</span> = <span class="ruby-identifier">session</span>[<span class="ruby-identifier">session_id_session_key</span>]
<span class="line-num">133</span>     <span class="ruby-identifier">key</span> = <span class="ruby-identifier">generate_active_sessions_key</span>
<span class="line-num">134</span>     <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">session_id_session_key</span>, <span class="ruby-identifier">key</span>)
<span class="line-num">135</span>     <span class="ruby-identifier">active_sessions_ds</span>.
<span class="line-num">136</span>       <span class="ruby-identifier">where</span>(<span class="ruby-identifier">active_sessions_session_id_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">compute_hmacs</span>(<span class="ruby-identifier">prev_key</span>)).
<span class="line-num">137</span>       <span class="ruby-identifier">update</span>(<span class="ruby-identifier">active_sessions_session_id_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">compute_hmac</span>(<span class="ruby-identifier">key</span>))
<span class="line-num">138</span>   <span class="ruby-keyword">end</span>
<span class="line-num">139</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_reset_password'>
<a name='method-i-after_reset_password'></a>
<div class='synopsis'>
<span class='name'>after_reset_password</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_reset_password-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_reset_password-source'>   <span class="ruby-comment"># File lib/rodauth/features/password_grace_period.rb</span>
<span class="line-num">39</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_reset_password</span>
<span class="line-num">40</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">41</span>   <span class="ruby-ivar">@last_password_entry</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_i</span>
<span class="line-num">42</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_sms_disable'>
<a name='method-i-after_sms_disable'></a>
<div class='synopsis'>
<span class='name'>after_sms_disable</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_sms_disable-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_sms_disable-source'>    <span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb</span>
<span class="line-num">230</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_sms_disable</span>
<span class="line-num">231</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">232</span>   <span class="ruby-identifier">auto_remove_recovery_codes</span>
<span class="line-num">233</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_webauthn_remove'>
<a name='method-i-after_webauthn_remove'></a>
<div class='synopsis'>
<span class='name'>after_webauthn_remove</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_webauthn_remove-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_webauthn_remove-source'>    <span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb</span>
<span class="line-num">235</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_webauthn_remove</span>
<span class="line-num">236</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">237</span>   <span class="ruby-identifier">auto_remove_recovery_codes</span>
<span class="line-num">238</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-after_webauthn_setup'>
<a name='method-i-after_webauthn_setup'></a>
<div class='synopsis'>
<span class='name'>after_webauthn_setup</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-after_webauthn_setup-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-after_webauthn_setup-source'>   <span class="ruby-comment"># File lib/rodauth/features/webauthn_modify_email.rb</span>
<span class="line-num">13</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">after_webauthn_setup</span>
<span class="line-num">14</span>   <span class="ruby-keyword">super</span>
<span class="line-num">15</span>   <span class="ruby-identifier">send_webauthn_authenticator_added_email</span>
<span class="line-num">16</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-allow_email_auth-3F'>
<a name='method-i-allow_email_auth-3F'></a>
<div class='synopsis'>
<span class='name'>allow_email_auth?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-allow_email_auth-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-allow_email_auth-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/email_auth.rb</span>
<span class="line-num">197</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">allow_email_auth?</span>
<span class="line-num">198</span>   <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>) <span class="ruby-operator">?</span> <span class="ruby-keyword">super</span> <span class="ruby-operator">:</span> <span class="ruby-keyword">true</span>
<span class="line-num">199</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-allow_resending_verify_account_email-3F'>
<a name='method-i-allow_resending_verify_account_email-3F'></a>
<div class='synopsis'>
<span class='name'>allow_resending_verify_account_email?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-allow_resending_verify_account_email-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-allow_resending_verify_account_email-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_account.rb</span>
<span class="line-num">163</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">allow_resending_verify_account_email?</span>
<span class="line-num">164</span>   <span class="ruby-identifier">account</span>[<span class="ruby-identifier">account_status_column</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">account_unverified_status_value</span>
<span class="line-num">165</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-already_logged_in'>
<a name='method-i-already_logged_in'></a>
<div class='synopsis'>
<span class='name'>already_logged_in</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-already_logged_in-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-already_logged_in-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">313</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">already_logged_in</span>
<span class="line-num">314</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">315</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-argon2_hash_algorithm-3F'>
<a name='method-i-argon2_hash_algorithm-3F'></a>
<div class='synopsis'>
<span class='name'>argon2_hash_algorithm?</span><span class='arguments'>(hash)</span>

</div>
<div class='description'>

<p>:nocov:</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-argon2_hash_algorithm-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-argon2_hash_algorithm-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/argon2.rb</span>
<span class="line-num">105</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">argon2_hash_algorithm?</span>(<span class="ruby-identifier">hash</span>)
<span class="line-num">106</span>   <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">start_with?</span>(<span class="ruby-string">&#39;$argon2id$&#39;</span>)
<span class="line-num">107</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-argon2_hash_cost'>
<a name='method-i-argon2_hash_cost'></a>
<div class='synopsis'>
<span class='name'>argon2_hash_cost</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-argon2_hash_cost-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-argon2_hash_cost-source'>   <span class="ruby-comment"># File lib/rodauth/features/argon2.rb</span>
<span class="line-num">76</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">argon2_hash_cost</span>
<span class="line-num">77</span>   { <span class="ruby-value">t_cost:</span> <span class="ruby-value">1</span>, <span class="ruby-value">m_cost:</span> <span class="ruby-value">5</span>, <span class="ruby-value">p_cost:</span> <span class="ruby-value">1</span> }
<span class="line-num">78</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-argon2_password_hash_match-3F'>
<a name='method-i-argon2_password_hash_match-3F'></a>
<div class='synopsis'>
<span class='name'>argon2_password_hash_match?</span><span class='arguments'>(hash, password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-argon2_password_hash_match-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-argon2_password_hash_match-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/argon2.rb</span>
<span class="line-num">109</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">argon2_password_hash_match?</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">password</span>)
<span class="line-num">110</span>   <span class="ruby-identifier">ret</span> = <span class="ruby-operator">::</span><span class="ruby-constant">Argon2</span><span class="ruby-operator">::</span><span class="ruby-constant">Password</span>.<span class="ruby-identifier">verify_password</span>(<span class="ruby-identifier">password</span>, <span class="ruby-identifier">hash</span>, <span class="ruby-identifier">argon2_secret</span>)
<span class="line-num">111</span> 
<span class="line-num">112</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">ret</span> <span class="ruby-operator">==</span> <span class="ruby-keyword">false</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">argon2_old_secret</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">argon2_secret</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">ret</span> = <span class="ruby-operator">::</span><span class="ruby-constant">Argon2</span><span class="ruby-operator">::</span><span class="ruby-constant">Password</span>.<span class="ruby-identifier">verify_password</span>(<span class="ruby-identifier">password</span>, <span class="ruby-identifier">hash</span>, <span class="ruby-identifier">argon2_old_secret</span>))
<span class="line-num">113</span>     <span class="ruby-ivar">@update_password_hash</span> = <span class="ruby-keyword">true</span>
<span class="line-num">114</span>   <span class="ruby-keyword">end</span>
<span class="line-num">115</span> 
<span class="line-num">116</span>   <span class="ruby-identifier">ret</span>
<span class="line-num">117</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-argon2_password_hash_using_salt_and_secret'>
<a name='method-i-argon2_password_hash_using_salt_and_secret'></a>
<div class='synopsis'>
<span class='name'>argon2_password_hash_using_salt_and_secret</span><span class='arguments'>(password, salt, secret)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-argon2_password_hash_using_salt_and_secret-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-argon2_password_hash_using_salt_and_secret-source'>   <span class="ruby-comment"># File lib/rodauth/features/argon2.rb</span>
<span class="line-num">60</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">argon2_password_hash_using_salt_and_secret</span>(<span class="ruby-identifier">password</span>, <span class="ruby-identifier">salt</span>, <span class="ruby-identifier">secret</span>)
<span class="line-num">61</span>   <span class="ruby-identifier">argon2_params</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-identifier">extract_password_hash_cost</span>(<span class="ruby-identifier">salt</span>)]
<span class="line-num">62</span>   <span class="ruby-identifier">argon2_params</span>[<span class="ruby-identifier">argon2_salt_option</span>] = <span class="ruby-identifier">salt</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&#39;$&#39;</span>).<span class="ruby-identifier">last</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-string">&quot;m&quot;</span>)[<span class="ruby-value">0</span>]
<span class="line-num">63</span>   <span class="ruby-identifier">argon2_params</span>[<span class="ruby-value">:secret</span>] = <span class="ruby-identifier">secret</span>
<span class="line-num">64</span>   <span class="ruby-operator">::</span><span class="ruby-constant">Argon2</span><span class="ruby-operator">::</span><span class="ruby-constant">Password</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">argon2_params</span>).<span class="ruby-identifier">create</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">65</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-argon2_salt_option'>
<a name='method-i-argon2_salt_option'></a>
<div class='synopsis'>
<span class='name'>argon2_salt_option</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-argon2_salt_option-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-argon2_salt_option-source'>   <span class="ruby-comment"># File lib/rodauth/features/argon2.rb</span>
<span class="line-num">34</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">argon2_salt_option</span>
<span class="line-num">35</span>   <span class="ruby-value">:salt_do_not_supply</span>
<span class="line-num">36</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-audit_log_ds'>
<a name='method-i-audit_log_ds'></a>
<div class='synopsis'>
<span class='name'>audit_log_ds</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-audit_log_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-audit_log_ds-source'>   <span class="ruby-comment"># File lib/rodauth/features/audit_logging.rb</span>
<span class="line-num">83</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">audit_log_ds</span>
<span class="line-num">84</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">db</span>[<span class="ruby-identifier">audit_logging_table</span>]
<span class="line-num">85</span>   <span class="ruby-comment"># :nocov:</span>
<span class="line-num">86</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">database_type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:postgres</span>
<span class="line-num">87</span>   <span class="ruby-comment"># :nocov:</span>
<span class="line-num">88</span>     <span class="ruby-comment"># For PostgreSQL, use RETURNING NULL. This allows the feature</span>
<span class="line-num">89</span>     <span class="ruby-comment"># to be used with INSERT but not SELECT permissions on the</span>
<span class="line-num">90</span>     <span class="ruby-comment"># table, useful for audit logging where the database user</span>
<span class="line-num">91</span>     <span class="ruby-comment"># the application is running as should not need to read the</span>
<span class="line-num">92</span>     <span class="ruby-comment"># logs.</span>
<span class="line-num">93</span>     <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">returning</span>(<span class="ruby-keyword">nil</span>)
<span class="line-num">94</span>   <span class="ruby-keyword">end</span>
<span class="line-num">95</span>   <span class="ruby-identifier">ds</span>
<span class="line-num">96</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-audit_log_insert_hash'>
<a name='method-i-audit_log_insert_hash'></a>
<div class='synopsis'>
<span class='name'>audit_log_insert_hash</span><span class='arguments'>(account_id, action)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-audit_log_insert_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-audit_log_insert_hash-source'>   <span class="ruby-comment"># File lib/rodauth/features/audit_logging.rb</span>
<span class="line-num">45</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">audit_log_insert_hash</span>(<span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">action</span>)
<span class="line-num">46</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">message</span> = <span class="ruby-identifier">audit_log_message</span>(<span class="ruby-identifier">action</span>)
<span class="line-num">47</span>     {
<span class="line-num">48</span>       <span class="ruby-identifier">audit_logging_account_id_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">account_id</span>,
<span class="line-num">49</span>       <span class="ruby-identifier">audit_logging_message_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">message</span>,
<span class="line-num">50</span>       <span class="ruby-identifier">audit_logging_metadata_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">serialize_audit_log_metadata</span>(<span class="ruby-identifier">audit_log_metadata</span>(<span class="ruby-identifier">action</span>))
<span class="line-num">51</span>     }
<span class="line-num">52</span>   <span class="ruby-keyword">end</span>
<span class="line-num">53</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-audit_log_message'>
<a name='method-i-audit_log_message'></a>
<div class='synopsis'>
<span class='name'>audit_log_message</span><span class='arguments'>(action)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-audit_log_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-audit_log_message-source'>   <span class="ruby-comment"># File lib/rodauth/features/audit_logging.rb</span>
<span class="line-num">63</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">audit_log_message</span>(<span class="ruby-identifier">action</span>)
<span class="line-num">64</span>   <span class="ruby-identifier">meth</span> = <span class="ruby-value">:&quot;audit_log_message_for_#{action}&quot;</span>
<span class="line-num">65</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-keyword">true</span>)
<span class="line-num">66</span>     <span class="ruby-identifier">send</span>(<span class="ruby-identifier">meth</span>)
<span class="line-num">67</span>   <span class="ruby-keyword">else</span>
<span class="line-num">68</span>     <span class="ruby-identifier">audit_log_message_default</span>(<span class="ruby-identifier">action</span>)
<span class="line-num">69</span>   <span class="ruby-keyword">end</span>
<span class="line-num">70</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-audit_log_message_default'>
<a name='method-i-audit_log_message_default'></a>
<div class='synopsis'>
<span class='name'>audit_log_message_default</span><span class='arguments'>(action)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-audit_log_message_default-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-audit_log_message_default-source'>   <span class="ruby-comment"># File lib/rodauth/features/audit_logging.rb</span>
<span class="line-num">59</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">audit_log_message_default</span>(<span class="ruby-identifier">action</span>)
<span class="line-num">60</span>   <span class="ruby-identifier">action</span>.<span class="ruby-identifier">to_s</span>
<span class="line-num">61</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-audit_log_metadata'>
<a name='method-i-audit_log_metadata'></a>
<div class='synopsis'>
<span class='name'>audit_log_metadata</span><span class='arguments'>(action)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-audit_log_metadata-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-audit_log_metadata-source'>   <span class="ruby-comment"># File lib/rodauth/features/audit_logging.rb</span>
<span class="line-num">72</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">audit_log_metadata</span>(<span class="ruby-identifier">action</span>)
<span class="line-num">73</span>   <span class="ruby-identifier">meth</span> = <span class="ruby-value">:&quot;audit_log_metadata_for_#{action}&quot;</span>
<span class="line-num">74</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">respond_to?</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-keyword">true</span>)
<span class="line-num">75</span>     <span class="ruby-identifier">send</span>(<span class="ruby-identifier">meth</span>)
<span class="line-num">76</span>   <span class="ruby-keyword">else</span>
<span class="line-num">77</span>     <span class="ruby-identifier">audit_log_metadata_default</span>
<span class="line-num">78</span>   <span class="ruby-keyword">end</span>
<span class="line-num">79</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-auth_class_eval'>
<a name='method-i-auth_class_eval'></a>
<div class='synopsis'>
<span class='name'>auth_class_eval</span><span class='arguments'>(&block)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-auth_class_eval-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-auth_class_eval-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">136</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">auth_class_eval</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">137</span>   <span class="ruby-identifier">auth</span>.<span class="ruby-identifier">class_eval</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">138</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-authenticated-3F'>
<a name='method-i-authenticated-3F'></a>
<div class='synopsis'>
<span class='name'>authenticated?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-authenticated-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-authenticated-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">366</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">authenticated?</span>
<span class="line-num">367</span>   <span class="ruby-identifier">logged_in?</span>
<span class="line-num">368</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-authenticated_by'>
<a name='method-i-authenticated_by'></a>
<div class='synopsis'>
<span class='name'>authenticated_by</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-authenticated_by-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-authenticated_by-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">470</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">authenticated_by</span>
<span class="line-num">471</span>   <span class="ruby-identifier">session</span>[<span class="ruby-identifier">authenticated_by_session_key</span>]
<span class="line-num">472</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-authenticated_webauthn_id'>
<a name='method-i-authenticated_webauthn_id'></a>
<div class='synopsis'>
<span class='name'>authenticated_webauthn_id</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-authenticated_webauthn_id-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-authenticated_webauthn_id-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">251</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">authenticated_webauthn_id</span>
<span class="line-num">252</span>   <span class="ruby-identifier">session</span>[<span class="ruby-identifier">authenticated_webauthn_id_session_key</span>]
<span class="line-num">253</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-auto_add_missing_recovery_codes'>
<a name='method-i-auto_add_missing_recovery_codes'></a>
<div class='synopsis'>
<span class='name'>auto_add_missing_recovery_codes</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-auto_add_missing_recovery_codes-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-auto_add_missing_recovery_codes-source'>    <span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb</span>
<span class="line-num">248</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">auto_add_missing_recovery_codes</span>
<span class="line-num">249</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">auto_add_recovery_codes?</span>
<span class="line-num">250</span>     <span class="ruby-identifier">add_recovery_codes</span>(<span class="ruby-identifier">recovery_codes_limit</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">recovery_codes</span>.<span class="ruby-identifier">length</span>)
<span class="line-num">251</span>   <span class="ruby-keyword">end</span>
<span class="line-num">252</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-auto_remove_recovery_codes'>
<a name='method-i-auto_remove_recovery_codes'></a>
<div class='synopsis'>
<span class='name'>auto_remove_recovery_codes</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-auto_remove_recovery_codes-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-auto_remove_recovery_codes-source'>    <span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb</span>
<span class="line-num">254</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">auto_remove_recovery_codes</span>
<span class="line-num">255</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">auto_remove_recovery_codes?</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-node">%w&#39;totp webauthn sms_code&#39;</span> <span class="ruby-operator">&amp;</span> <span class="ruby-identifier">possible_authentication_methods</span>).<span class="ruby-identifier">empty?</span>
<span class="line-num">256</span>     <span class="ruby-identifier">recovery_codes_remove</span>
<span class="line-num">257</span>   <span class="ruby-keyword">end</span>
<span class="line-num">258</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-autocomplete_for_field-3F'>
<a name='method-i-autocomplete_for_field-3F'></a>
<div class='synopsis'>
<span class='name'>autocomplete_for_field?</span><span class='arguments'>(_param)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-autocomplete_for_field-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-autocomplete_for_field-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">216</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">autocomplete_for_field?</span>(<span class="ruby-identifier">_param</span>)
<span class="line-num">217</span>   <span class="ruby-identifier">mark_input_fields_with_autocomplete?</span>
<span class="line-num">218</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-autologin_session'>
<a name='method-i-autologin_session'></a>
<div class='synopsis'>
<span class='name'>autologin_session</span><span class='arguments'>(autologin_type)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-autologin_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-autologin_session-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">483</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">autologin_session</span>(<span class="ruby-identifier">autologin_type</span>)
<span class="line-num">484</span>   <span class="ruby-identifier">login_session</span>(<span class="ruby-string">&#39;autologin&#39;</span>)
<span class="line-num">485</span>   <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">autologin_type_session_key</span>, <span class="ruby-identifier">autologin_type</span>)
<span class="line-num">486</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-autologin_type'>
<a name='method-i-autologin_type'></a>
<div class='synopsis'>
<span class='name'>autologin_type</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-autologin_type-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-autologin_type-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">479</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">autologin_type</span>
<span class="line-num">480</span>   <span class="ruby-identifier">session</span>[<span class="ruby-identifier">autologin_type_session_key</span>]
<span class="line-num">481</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-base32_encode'>
<a name='method-i-base32_encode'></a>
<div class='synopsis'>
<span class='name'>base32_encode</span><span class='arguments'>(data, length)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-base32_encode-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-base32_encode-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">412</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">base32_encode</span>(<span class="ruby-identifier">data</span>, <span class="ruby-identifier">length</span>)
<span class="line-num">413</span>   <span class="ruby-identifier">chars</span> = <span class="ruby-string">&#39;abcdefghijklmnopqrstuvwxyz234567&#39;</span>
<span class="line-num">414</span>   <span class="ruby-identifier">length</span>.<span class="ruby-identifier">times</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span><span class="ruby-identifier">chars</span>[<span class="ruby-identifier">data</span>[<span class="ruby-identifier">i</span>].<span class="ruby-identifier">ord</span> <span class="ruby-operator">%</span> <span class="ruby-value">32</span>]}.<span class="ruby-identifier">join</span>
<span class="line-num">415</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-base_url'>
<a name='method-i-base_url'></a>
<div class='synopsis'>
<span class='name'>base_url</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-base_url-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-base_url-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">529</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">base_url</span>
<span class="line-num">530</span>   <span class="ruby-identifier">url</span> = <span class="ruby-constant">String</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;#{request.scheme}://#{domain}&quot;</span>)
<span class="line-num">531</span>   <span class="ruby-identifier">url</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;:#{request.port}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">port</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">Rack</span><span class="ruby-operator">::</span><span class="ruby-constant">Request</span><span class="ruby-operator">::</span><span class="ruby-constant">DEFAULT_PORTS</span>[<span class="ruby-identifier">request</span>.<span class="ruby-identifier">scheme</span>]
<span class="line-num">532</span>   <span class="ruby-identifier">url</span>
<span class="line-num">533</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_change_login_route'>
<a name='method-i-before_change_login_route'></a>
<div class='synopsis'>
<span class='name'>before_change_login_route</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_change_login_route-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_change_login_route-source'>   <span class="ruby-comment"># File lib/rodauth/features/verify_account_grace_period.rb</span>
<span class="line-num">58</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_change_login_route</span>
<span class="line-num">59</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">verified_account?</span>
<span class="line-num">60</span>     <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">unverified_change_login_error_flash</span>
<span class="line-num">61</span>     <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">unverified_change_login_redirect</span>
<span class="line-num">62</span>   <span class="ruby-keyword">end</span>
<span class="line-num">63</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">64</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_change_password_route'>
<a name='method-i-before_change_password_route'></a>
<div class='synopsis'>
<span class='name'>before_change_password_route</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_change_password_route-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_change_password_route-source'>   <span class="ruby-comment"># File lib/rodauth/features/password_expiration.rb</span>
<span class="line-num">90</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_change_password_route</span>
<span class="line-num">91</span>   <span class="ruby-identifier">check_password_change_allowed</span>
<span class="line-num">92</span>   <span class="ruby-keyword">super</span>
<span class="line-num">93</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_create_account_route'>
<a name='method-i-before_create_account_route'></a>
<div class='synopsis'>
<span class='name'>before_create_account_route</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_create_account_route-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_create_account_route-source'>   <span class="ruby-comment"># File lib/rodauth/features/disallow_password_reuse.rb</span>
<span class="line-num">77</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_create_account_route</span>
<span class="line-num">78</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">79</span>   <span class="ruby-ivar">@dont_check_previous_password</span> = <span class="ruby-keyword">true</span>
<span class="line-num">80</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_login_attempt'>
<a name='method-i-before_login_attempt'></a>
<div class='synopsis'>
<span class='name'>before_login_attempt</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_login_attempt-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_login_attempt-source'>    <span class="ruby-comment"># File lib/rodauth/features/lockout.rb</span>
<span class="line-num">248</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_login_attempt</span>
<span class="line-num">249</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">locked_out?</span>
<span class="line-num">250</span>     <span class="ruby-identifier">show_lockout_page</span>
<span class="line-num">251</span>   <span class="ruby-keyword">end</span>
<span class="line-num">252</span>   <span class="ruby-keyword">super</span>
<span class="line-num">253</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_logout'>
<a name='method-i-before_logout'></a>
<div class='synopsis'>
<span class='name'>before_logout</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_logout-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_logout-source'>    <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">146</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_logout</span>
<span class="line-num">147</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">param_or_nil</span>(<span class="ruby-identifier">global_logout_param</span>)
<span class="line-num">148</span>     <span class="ruby-identifier">remove_remember_key</span>(<span class="ruby-identifier">session_value</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:remove_remember_key</span>)
<span class="line-num">149</span>     <span class="ruby-identifier">remove_all_active_sessions</span>
<span class="line-num">150</span>   <span class="ruby-keyword">else</span>
<span class="line-num">151</span>     <span class="ruby-identifier">remove_current_session</span>
<span class="line-num">152</span>   <span class="ruby-keyword">end</span>
<span class="line-num">153</span>   <span class="ruby-keyword">super</span>
<span class="line-num">154</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_otp_setup_route'>
<a name='method-i-before_otp_setup_route'></a>
<div class='synopsis'>
<span class='name'>before_otp_setup_route</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_otp_setup_route-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_otp_setup_route-source'>    <span class="ruby-comment"># File lib/rodauth/features/json.rb</span>
<span class="line-num">170</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_otp_setup_route</span>
<span class="line-num">171</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">172</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_json?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">otp_keys_use_hmac?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">param_or_nil</span>(<span class="ruby-identifier">otp_setup_raw_param</span>)
<span class="line-num">173</span>     <span class="ruby-identifier">_otp_tmp_key</span>(<span class="ruby-identifier">otp_new_secret</span>)
<span class="line-num">174</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">otp_setup_param</span>] = <span class="ruby-identifier">otp_user_key</span>
<span class="line-num">175</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">otp_setup_raw_param</span>] = <span class="ruby-identifier">otp_key</span>
<span class="line-num">176</span>   <span class="ruby-keyword">end</span>
<span class="line-num">177</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_reset_password'>
<a name='method-i-before_reset_password'></a>
<div class='synopsis'>
<span class='name'>before_reset_password</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_reset_password-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_reset_password-source'>   <span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb</span>
<span class="line-num">79</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_reset_password</span>
<span class="line-num">80</span>   <span class="ruby-identifier">check_account_expiration</span>
<span class="line-num">81</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">82</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_reset_password_request'>
<a name='method-i-before_reset_password_request'></a>
<div class='synopsis'>
<span class='name'>before_reset_password_request</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_reset_password_request-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_reset_password_request-source'>   <span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb</span>
<span class="line-num">84</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_reset_password_request</span>
<span class="line-num">85</span>   <span class="ruby-identifier">check_account_expiration</span>
<span class="line-num">86</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">87</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_rodauth'>
<a name='method-i-before_rodauth'></a>
<div class='synopsis'>
<span class='name'>before_rodauth</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_rodauth-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_rodauth-source'>    <span class="ruby-comment"># File lib/rodauth/features/json.rb</span>
<span class="line-num">179</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_rodauth</span>
<span class="line-num">180</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">json_request?</span>
<span class="line-num">181</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">json_check_accept?</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">accept</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-string">&#39;HTTP_ACCEPT&#39;</span>]) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">accept</span> <span class="ruby-operator">!~</span> <span class="ruby-identifier">json_accept_regexp</span>
<span class="line-num">182</span>       <span class="ruby-identifier">response</span>.<span class="ruby-identifier">status</span> = <span class="ruby-value">406</span>
<span class="line-num">183</span>       <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">json_response_error_key</span>] = <span class="ruby-identifier">json_not_accepted_error_message</span>
<span class="line-num">184</span>       <span class="ruby-identifier">_return_json_response</span>
<span class="line-num">185</span>     <span class="ruby-keyword">end</span>
<span class="line-num">186</span> 
<span class="line-num">187</span>     <span class="ruby-keyword">unless</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">post?</span>
<span class="line-num">188</span>       <span class="ruby-identifier">response</span>.<span class="ruby-identifier">status</span> = <span class="ruby-value">405</span>
<span class="line-num">189</span>       <span class="ruby-identifier">set_response_header</span>(<span class="ruby-string">&#39;allow&#39;</span>, <span class="ruby-string">&#39;POST&#39;</span>)
<span class="line-num">190</span>       <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">json_response_error_key</span>] = <span class="ruby-identifier">json_non_post_error_message</span>
<span class="line-num">191</span>       <span class="ruby-identifier">return_json_response</span>
<span class="line-num">192</span>     <span class="ruby-keyword">end</span>
<span class="line-num">193</span>   <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">only_json?</span>
<span class="line-num">194</span>     <span class="ruby-identifier">response</span>.<span class="ruby-identifier">status</span> = <span class="ruby-identifier">json_response_error_status</span>
<span class="line-num">195</span>     <span class="ruby-identifier">return_response</span> <span class="ruby-identifier">non_json_request_error_message</span>
<span class="line-num">196</span>   <span class="ruby-keyword">end</span>
<span class="line-num">197</span> 
<span class="line-num">198</span>   <span class="ruby-keyword">super</span>
<span class="line-num">199</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_two_factor_auth_route'>
<a name='method-i-before_two_factor_auth_route'></a>
<div class='synopsis'>
<span class='name'>before_two_factor_auth_route</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_two_factor_auth_route-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_two_factor_auth_route-source'>    <span class="ruby-comment"># File lib/rodauth/features/json.rb</span>
<span class="line-num">116</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_two_factor_auth_route</span>
<span class="line-num">117</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">118</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_json?</span>
<span class="line-num">119</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-value">:auth_links</span>] = <span class="ruby-identifier">two_factor_auth_links</span>.<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">_</span>,<span class="ruby-identifier">link</span><span class="ruby-operator">|</span> <span class="ruby-identifier">link</span>}
<span class="line-num">120</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">json_response_success_key</span>] <span class="ruby-operator">||=</span> <span class="ruby-string">&quot;&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">include_success_messages?</span>
<span class="line-num">121</span>     <span class="ruby-identifier">return_json_response</span>
<span class="line-num">122</span>   <span class="ruby-keyword">end</span>
<span class="line-num">123</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_two_factor_manage_route'>
<a name='method-i-before_two_factor_manage_route'></a>
<div class='synopsis'>
<span class='name'>before_two_factor_manage_route</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_two_factor_manage_route-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_two_factor_manage_route-source'>    <span class="ruby-comment"># File lib/rodauth/features/json.rb</span>
<span class="line-num">106</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_two_factor_manage_route</span>
<span class="line-num">107</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">108</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_json?</span>
<span class="line-num">109</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-value">:setup_links</span>] = <span class="ruby-identifier">two_factor_setup_links</span>.<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">_</span>,<span class="ruby-identifier">link</span><span class="ruby-operator">|</span> <span class="ruby-identifier">link</span>}
<span class="line-num">110</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-value">:remove_links</span>] = <span class="ruby-identifier">two_factor_remove_links</span>.<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">_</span>,<span class="ruby-identifier">link</span><span class="ruby-operator">|</span> <span class="ruby-identifier">link</span>}
<span class="line-num">111</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">json_response_success_key</span>] <span class="ruby-operator">||=</span> <span class="ruby-string">&quot;&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">include_success_messages?</span>
<span class="line-num">112</span>     <span class="ruby-identifier">return_json_response</span>
<span class="line-num">113</span>   <span class="ruby-keyword">end</span>
<span class="line-num">114</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_unlock_account'>
<a name='method-i-before_unlock_account'></a>
<div class='synopsis'>
<span class='name'>before_unlock_account</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_unlock_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_unlock_account-source'>   <span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb</span>
<span class="line-num">89</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_unlock_account</span>
<span class="line-num">90</span>   <span class="ruby-identifier">check_account_expiration</span>
<span class="line-num">91</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">92</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_unlock_account_request'>
<a name='method-i-before_unlock_account_request'></a>
<div class='synopsis'>
<span class='name'>before_unlock_account_request</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_unlock_account_request-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_unlock_account_request-source'>   <span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb</span>
<span class="line-num">94</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_unlock_account_request</span>
<span class="line-num">95</span>   <span class="ruby-identifier">check_account_expiration</span>
<span class="line-num">96</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">97</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_verify_account'>
<a name='method-i-before_verify_account'></a>
<div class='synopsis'>
<span class='name'>before_verify_account</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_verify_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_verify_account-source'>   <span class="ruby-comment"># File lib/rodauth/features/webauthn_verify_account.rb</span>
<span class="line-num">30</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_verify_account</span>
<span class="line-num">31</span>   <span class="ruby-keyword">super</span>
<span class="line-num">32</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">features</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value">:json</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">use_json?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">param_or_nil</span>(<span class="ruby-identifier">webauthn_setup_param</span>)
<span class="line-num">33</span>     <span class="ruby-identifier">cred</span> = <span class="ruby-identifier">new_webauthn_credential</span>
<span class="line-num">34</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">webauthn_setup_param</span>] = <span class="ruby-identifier">cred</span>.<span class="ruby-identifier">as_json</span>
<span class="line-num">35</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">webauthn_setup_challenge_param</span>] = <span class="ruby-identifier">cred</span>.<span class="ruby-identifier">challenge</span>
<span class="line-num">36</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">webauthn_setup_challenge_hmac_param</span>] = <span class="ruby-identifier">compute_hmac</span>(<span class="ruby-identifier">cred</span>.<span class="ruby-identifier">challenge</span>)
<span class="line-num">37</span>   <span class="ruby-keyword">end</span>
<span class="line-num">38</span>   <span class="ruby-ivar">@webauthn_credential</span> = <span class="ruby-identifier">webauthn_setup_credential_from_form_submission</span>
<span class="line-num">39</span>   <span class="ruby-identifier">add_webauthn_credential</span>(<span class="ruby-ivar">@webauthn_credential</span>)
<span class="line-num">40</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_verify_account_route'>
<a name='method-i-before_verify_account_route'></a>
<div class='synopsis'>
<span class='name'>before_verify_account_route</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_verify_account_route-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_verify_account_route-source'>   <span class="ruby-comment"># File lib/rodauth/features/disallow_password_reuse.rb</span>
<span class="line-num">82</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_verify_account_route</span>
<span class="line-num">83</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">84</span>   <span class="ruby-ivar">@dont_check_previous_password</span> = <span class="ruby-keyword">true</span>
<span class="line-num">85</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_view_recovery_codes'>
<a name='method-i-before_view_recovery_codes'></a>
<div class='synopsis'>
<span class='name'>before_view_recovery_codes</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_view_recovery_codes-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_view_recovery_codes-source'>    <span class="ruby-comment"># File lib/rodauth/features/json.rb</span>
<span class="line-num">125</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_view_recovery_codes</span>
<span class="line-num">126</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">127</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_json?</span>
<span class="line-num">128</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-value">:codes</span>] = <span class="ruby-identifier">recovery_codes</span>
<span class="line-num">129</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">json_response_success_key</span>] <span class="ruby-operator">||=</span> <span class="ruby-string">&quot;&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">include_success_messages?</span>
<span class="line-num">130</span>   <span class="ruby-keyword">end</span>
<span class="line-num">131</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_webauthn_auth_route'>
<a name='method-i-before_webauthn_auth_route'></a>
<div class='synopsis'>
<span class='name'>before_webauthn_auth_route</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_webauthn_auth_route-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_webauthn_auth_route-source'>    <span class="ruby-comment"># File lib/rodauth/features/json.rb</span>
<span class="line-num">143</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_webauthn_auth_route</span>
<span class="line-num">144</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">145</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_json?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">param_or_nil</span>(<span class="ruby-identifier">webauthn_auth_param</span>)
<span class="line-num">146</span>     <span class="ruby-identifier">cred</span> = <span class="ruby-identifier">webauthn_credential_options_for_get</span>
<span class="line-num">147</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">webauthn_auth_param</span>] = <span class="ruby-identifier">cred</span>.<span class="ruby-identifier">as_json</span>
<span class="line-num">148</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">webauthn_auth_challenge_param</span>] = <span class="ruby-identifier">cred</span>.<span class="ruby-identifier">challenge</span>
<span class="line-num">149</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">webauthn_auth_challenge_hmac_param</span>] = <span class="ruby-identifier">compute_hmac</span>(<span class="ruby-identifier">cred</span>.<span class="ruby-identifier">challenge</span>)
<span class="line-num">150</span>   <span class="ruby-keyword">end</span>
<span class="line-num">151</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_webauthn_login_route'>
<a name='method-i-before_webauthn_login_route'></a>
<div class='synopsis'>
<span class='name'>before_webauthn_login_route</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_webauthn_login_route-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_webauthn_login_route-source'>    <span class="ruby-comment"># File lib/rodauth/features/json.rb</span>
<span class="line-num">153</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_webauthn_login_route</span>
<span class="line-num">154</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">155</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_json?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">param_or_nil</span>(<span class="ruby-identifier">webauthn_auth_param</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">webauthn_login_options?</span>
<span class="line-num">156</span>     <span class="ruby-identifier">cred</span> = <span class="ruby-identifier">webauthn_credential_options_for_get</span>
<span class="line-num">157</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">webauthn_auth_param</span>] = <span class="ruby-identifier">cred</span>.<span class="ruby-identifier">as_json</span>
<span class="line-num">158</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">webauthn_auth_challenge_param</span>] = <span class="ruby-identifier">cred</span>.<span class="ruby-identifier">challenge</span>
<span class="line-num">159</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">webauthn_auth_challenge_hmac_param</span>] = <span class="ruby-identifier">compute_hmac</span>(<span class="ruby-identifier">cred</span>.<span class="ruby-identifier">challenge</span>)
<span class="line-num">160</span>   <span class="ruby-keyword">end</span>
<span class="line-num">161</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_webauthn_remove_route'>
<a name='method-i-before_webauthn_remove_route'></a>
<div class='synopsis'>
<span class='name'>before_webauthn_remove_route</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_webauthn_remove_route-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_webauthn_remove_route-source'>    <span class="ruby-comment"># File lib/rodauth/features/json.rb</span>
<span class="line-num">163</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_webauthn_remove_route</span>
<span class="line-num">164</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">165</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_json?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">param_or_nil</span>(<span class="ruby-identifier">webauthn_remove_param</span>)
<span class="line-num">166</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">webauthn_remove_param</span>] = <span class="ruby-identifier">account_webauthn_usage</span>
<span class="line-num">167</span>   <span class="ruby-keyword">end</span>
<span class="line-num">168</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-before_webauthn_setup_route'>
<a name='method-i-before_webauthn_setup_route'></a>
<div class='synopsis'>
<span class='name'>before_webauthn_setup_route</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-before_webauthn_setup_route-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-before_webauthn_setup_route-source'>    <span class="ruby-comment"># File lib/rodauth/features/json.rb</span>
<span class="line-num">133</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">before_webauthn_setup_route</span>
<span class="line-num">134</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">135</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_json?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">param_or_nil</span>(<span class="ruby-identifier">webauthn_setup_param</span>)
<span class="line-num">136</span>     <span class="ruby-identifier">cred</span> = <span class="ruby-identifier">new_webauthn_credential</span>
<span class="line-num">137</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">webauthn_setup_param</span>] = <span class="ruby-identifier">cred</span>.<span class="ruby-identifier">as_json</span>
<span class="line-num">138</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">webauthn_setup_challenge_param</span>] = <span class="ruby-identifier">cred</span>.<span class="ruby-identifier">challenge</span>
<span class="line-num">139</span>     <span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">webauthn_setup_challenge_hmac_param</span>] = <span class="ruby-identifier">compute_hmac</span>(<span class="ruby-identifier">cred</span>.<span class="ruby-identifier">challenge</span>)
<span class="line-num">140</span>   <span class="ruby-keyword">end</span>
<span class="line-num">141</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-button'>
<a name='method-i-button'></a>
<div class='synopsis'>
<span class='name'>button</span><span class='arguments'>(value, opts={})</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-button-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-button-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">420</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">button</span>(<span class="ruby-identifier">value</span>, <span class="ruby-identifier">opts</span>={})
<span class="line-num">421</span>   <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">render</span>(<span class="ruby-identifier">button_opts</span>(<span class="ruby-identifier">value</span>, <span class="ruby-identifier">opts</span>))
<span class="line-num">422</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-button_fixed_locals'>
<a name='method-i-button_fixed_locals'></a>
<div class='synopsis'>
<span class='name'>button_fixed_locals</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-button_fixed_locals-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-button_fixed_locals-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">603</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">button_fixed_locals</span>
<span class="line-num">604</span>   <span class="ruby-string">&#39;(value:, opts:)&#39;</span>
<span class="line-num">605</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-button_opts'>
<a name='method-i-button_opts'></a>
<div class='synopsis'>
<span class='name'>button_opts</span><span class='arguments'>(value, opts)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-button_opts-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-button_opts-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">411</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">button_opts</span>(<span class="ruby-identifier">value</span>, <span class="ruby-identifier">opts</span>)
<span class="line-num">412</span>   <span class="ruby-identifier">opts</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-identifier">template_opts</span>].<span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">opts</span>)
<span class="line-num">413</span>   <span class="ruby-identifier">_merge_fixed_locals_opts</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-identifier">button_fixed_locals</span>)
<span class="line-num">414</span>   <span class="ruby-identifier">opts</span>[<span class="ruby-value">:locals</span>] = {<span class="ruby-value">:value</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">value</span>, <span class="ruby-value">:opts</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">opts</span>}
<span class="line-num">415</span>   <span class="ruby-identifier">opts</span>[<span class="ruby-value">:cache</span>] = <span class="ruby-identifier">cache_templates</span>
<span class="line-num">416</span>   <span class="ruby-identifier">opts</span>[<span class="ruby-value">:cache_key</span>] = <span class="ruby-value">:rodauth_button</span>
<span class="line-num">417</span>   <span class="ruby-identifier">_template_opts</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-string">&#39;button&#39;</span>)
<span class="line-num">418</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-can_add_recovery_codes-3F'>
<a name='method-i-can_add_recovery_codes-3F'></a>
<div class='synopsis'>
<span class='name'>can_add_recovery_codes?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-can_add_recovery_codes-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-can_add_recovery_codes-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb</span>
<span class="line-num">173</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">can_add_recovery_codes?</span>
<span class="line-num">174</span>   <span class="ruby-identifier">recovery_codes</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">recovery_codes_limit</span>
<span class="line-num">175</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-catch_error'>
<a name='method-i-catch_error'></a>
<div class='synopsis'>
<span class='name'>catch_error</span><span class='arguments'>(&block)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-catch_error-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-catch_error-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">703</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">catch_error</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">704</span>   <span class="ruby-identifier">catch</span>(<span class="ruby-value">:rodauth_error</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">705</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-change_login'>
<a name='method-i-change_login'></a>
<div class='synopsis'>
<span class='name'>change_login</span><span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-change_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-change_login-source'>   <span class="ruby-comment"># File lib/rodauth/features/change_login.rb</span>
<span class="line-num">68</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">change_login</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">69</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">account_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">login_column</span>).<span class="ruby-identifier">downcase</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">login</span>.<span class="ruby-identifier">downcase</span>
<span class="line-num">70</span>     <span class="ruby-identifier">set_login_requirement_error_message</span>(<span class="ruby-value">:same_as_current_login</span>, <span class="ruby-identifier">same_as_current_login_message</span>)
<span class="line-num">71</span>     <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
<span class="line-num">72</span>   <span class="ruby-keyword">end</span>
<span class="line-num">73</span> 
<span class="line-num">74</span>   <span class="ruby-identifier">update_login</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">75</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-change_login_notice_flash'>
<a name='method-i-change_login_notice_flash'></a>
<div class='synopsis'>
<span class='name'>change_login_notice_flash</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-change_login_notice_flash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-change_login_notice_flash-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb</span>
<span class="line-num">136</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">change_login_notice_flash</span>
<span class="line-num">137</span>   <span class="ruby-identifier">change_login_needs_verification_notice_flash</span>
<span class="line-num">138</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-change_login_requires_password-3F'>
<a name='method-i-change_login_requires_password-3F'></a>
<div class='synopsis'>
<span class='name'>change_login_requires_password?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-change_login_requires_password-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-change_login_requires_password-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/change_login.rb</span>
<span class="line-num">64</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">change_login_requires_password?</span>
<span class="line-num">65</span>   <span class="ruby-identifier">modifications_require_password?</span>
<span class="line-num">66</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-change_password_requires_password-3F'>
<a name='method-i-change_password_requires_password-3F'></a>
<div class='synopsis'>
<span class='name'>change_password_requires_password?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-change_password_requires_password-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-change_password_requires_password-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/change_password.rb</span>
<span class="line-num">68</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">change_password_requires_password?</span>
<span class="line-num">69</span>   <span class="ruby-identifier">modifications_require_password?</span>
<span class="line-num">70</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-check_account_expiration'>
<a name='method-i-check_account_expiration'></a>
<div class='synopsis'>
<span class='name'>check_account_expiration</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-check_account_expiration-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-check_account_expiration-source'>   <span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb</span>
<span class="line-num">63</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">check_account_expiration</span>
<span class="line-num">64</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">account_expired?</span>
<span class="line-num">65</span>     <span class="ruby-identifier">set_expired</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">account_expired_at</span>
<span class="line-num">66</span>     <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">account_expiration_error_flash</span>
<span class="line-num">67</span>     <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">account_expiration_redirect</span>
<span class="line-num">68</span>   <span class="ruby-keyword">end</span>
<span class="line-num">69</span>   <span class="ruby-identifier">update_last_login</span>
<span class="line-num">70</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-check_active_session'>
<a name='method-i-check_active_session'></a>
<div class='synopsis'>
<span class='name'>check_active_session</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-check_active_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-check_active_session-source'>   <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">54</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">check_active_session</span>
<span class="line-num">55</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">logged_in?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">currently_active_session?</span>
<span class="line-num">56</span>     <span class="ruby-identifier">no_longer_active_session</span>
<span class="line-num">57</span>   <span class="ruby-keyword">end</span>
<span class="line-num">58</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-check_already_logged_in'>
<a name='method-i-check_already_logged_in'></a>
<div class='synopsis'>
<span class='name'>check_already_logged_in</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-check_already_logged_in-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-check_already_logged_in-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">309</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">check_already_logged_in</span>
<span class="line-num">310</span>   <span class="ruby-identifier">already_logged_in</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">logged_in?</span>
<span class="line-num">311</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-check_csrf'>
<a name='method-i-check_csrf'></a>
<div class='synopsis'>
<span class='name'>check_csrf</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-check_csrf-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-check_csrf-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">395</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">check_csrf</span>
<span class="line-num">396</span>   <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">check_csrf!</span>(<span class="ruby-identifier">check_csrf_opts</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">check_csrf_block</span>)
<span class="line-num">397</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-check_csrf-3F'>
<a name='method-i-check_csrf-3F'></a>
<div class='synopsis'>
<span class='name'>check_csrf?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-check_csrf-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-check_csrf-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">765</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">check_csrf?</span>
<span class="line-num">766</span>   <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauth_route_csrf</span>]
<span class="line-num">767</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-check_password_change_allowed'>
<a name='method-i-check_password_change_allowed'></a>
<div class='synopsis'>
<span class='name'>check_password_change_allowed</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-check_password_change_allowed-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-check_password_change_allowed-source'>   <span class="ruby-comment"># File lib/rodauth/features/password_expiration.rb</span>
<span class="line-num">30</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">check_password_change_allowed</span>
<span class="line-num">31</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">password_changed_at</span> = <span class="ruby-identifier">get_password_changed_at</span>
<span class="line-num">32</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">password_changed_at</span> <span class="ruby-operator">&gt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">allow_password_change_after</span>
<span class="line-num">33</span>       <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">password_not_changeable_yet_error_flash</span>
<span class="line-num">34</span>       <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">password_not_changeable_yet_redirect</span>
<span class="line-num">35</span>     <span class="ruby-keyword">end</span>
<span class="line-num">36</span>   <span class="ruby-keyword">end</span>
<span class="line-num">37</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-check_session_expiration'>
<a name='method-i-check_session_expiration'></a>
<div class='synopsis'>
<span class='name'>check_session_expiration</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-check_session_expiration-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-check_session_expiration-source'>   <span class="ruby-comment"># File lib/rodauth/features/session_expiration.rb</span>
<span class="line-num">15</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">check_session_expiration</span>
<span class="line-num">16</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">logged_in?</span>
<span class="line-num">17</span> 
<span class="line-num">18</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">session</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">session_last_activity_session_key</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">session</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">session_created_session_key</span>)
<span class="line-num">19</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">session_expiration_default</span>
<span class="line-num">20</span>       <span class="ruby-identifier">expire_session</span>
<span class="line-num">21</span>     <span class="ruby-keyword">end</span>
<span class="line-num">22</span> 
<span class="line-num">23</span>     <span class="ruby-keyword">return</span>
<span class="line-num">24</span>   <span class="ruby-keyword">end</span>
<span class="line-num">25</span> 
<span class="line-num">26</span>   <span class="ruby-identifier">time</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_i</span>
<span class="line-num">27</span> 
<span class="line-num">28</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">session_last_activity_session_key</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">session_inactivity_timeout</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">time</span>
<span class="line-num">29</span>     <span class="ruby-identifier">expire_session</span>
<span class="line-num">30</span>   <span class="ruby-keyword">end</span>
<span class="line-num">31</span>   <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">session_last_activity_session_key</span>, <span class="ruby-identifier">time</span>)
<span class="line-num">32</span> 
<span class="line-num">33</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">session</span>[<span class="ruby-identifier">session_created_session_key</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">max_session_lifetime</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">time</span>
<span class="line-num">34</span>     <span class="ruby-identifier">expire_session</span>
<span class="line-num">35</span>   <span class="ruby-keyword">end</span>
<span class="line-num">36</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-check_single_session'>
<a name='method-i-check_single_session'></a>
<div class='synopsis'>
<span class='name'>check_single_session</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-check_single_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-check_single_session-source'>   <span class="ruby-comment"># File lib/rodauth/features/single_session.rb</span>
<span class="line-num">52</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">check_single_session</span>
<span class="line-num">53</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">logged_in?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">currently_active_session?</span>
<span class="line-num">54</span>     <span class="ruby-identifier">no_longer_active_session</span>
<span class="line-num">55</span>   <span class="ruby-keyword">end</span>
<span class="line-num">56</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-clear_cached_otp'>
<a name='method-i-clear_cached_otp'></a>
<div class='synopsis'>
<span class='name'>clear_cached_otp</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-clear_cached_otp-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-clear_cached_otp-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">370</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">clear_cached_otp</span>
<span class="line-num">371</span>   <span class="ruby-identifier">remove_instance_variable</span>(<span class="ruby-value">:@otp</span>) <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@otp</span>)
<span class="line-num">372</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-clear_invalid_login_attempts'>
<a name='method-i-clear_invalid_login_attempts'></a>
<div class='synopsis'>
<span class='name'>clear_invalid_login_attempts</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-clear_invalid_login_attempts-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-clear_invalid_login_attempts-source'>    <span class="ruby-comment"># File lib/rodauth/features/lockout.rb</span>
<span class="line-num">165</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">clear_invalid_login_attempts</span>
<span class="line-num">166</span>   <span class="ruby-identifier">unlock_account</span>
<span class="line-num">167</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-clear_session'>
<a name='method-i-clear_session'></a>
<div class='synopsis'>
<span class='name'>clear_session</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-clear_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-clear_session-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">325</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">clear_session</span>
<span class="line-num">326</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_scope_clear_session?</span>
<span class="line-num">327</span>     <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">clear_session</span>
<span class="line-num">328</span>   <span class="ruby-keyword">else</span>
<span class="line-num">329</span>     <span class="ruby-identifier">session</span>.<span class="ruby-identifier">clear</span>
<span class="line-num">330</span>   <span class="ruby-keyword">end</span>
<span class="line-num">331</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-close_account'>
<a name='method-i-close_account'></a>
<div class='synopsis'>
<span class='name'>close_account</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-close_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-close_account-source'>   <span class="ruby-comment"># File lib/rodauth/features/close_account.rb</span>
<span class="line-num">66</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">close_account</span>
<span class="line-num">67</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">skip_status_checks?</span>
<span class="line-num">68</span>     <span class="ruby-identifier">update_account</span>(<span class="ruby-identifier">account_status_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_closed_status_value</span>)
<span class="line-num">69</span>   <span class="ruby-keyword">end</span>
<span class="line-num">70</span> 
<span class="line-num">71</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">account_password_hash_column</span>
<span class="line-num">72</span>     <span class="ruby-identifier">password_hash_ds</span>.<span class="ruby-identifier">delete</span>
<span class="line-num">73</span>   <span class="ruby-keyword">end</span>
<span class="line-num">74</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-close_account_requires_password-3F'>
<a name='method-i-close_account_requires_password-3F'></a>
<div class='synopsis'>
<span class='name'>close_account_requires_password?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-close_account_requires_password-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-close_account_requires_password-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/close_account.rb</span>
<span class="line-num">62</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">close_account_requires_password?</span>
<span class="line-num">63</span>   <span class="ruby-identifier">modifications_require_password?</span>
<span class="line-num">64</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-compute_hmac'>
<a name='method-i-compute_hmac'></a>
<div class='synopsis'>
<span class='name'>compute_hmac</span><span class='arguments'>(data)</span>

</div>
<div class='description'>

<p>Return urlsafe base64 HMAC for data, assumes hmac_secret is set.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-compute_hmac-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-compute_hmac-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">250</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">compute_hmac</span>(<span class="ruby-identifier">data</span>)
<span class="line-num">251</span>   <span class="ruby-identifier">_process_raw_hmac</span>(<span class="ruby-identifier">compute_raw_hmac</span>(<span class="ruby-identifier">data</span>))
<span class="line-num">252</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-compute_hmacs'>
<a name='method-i-compute_hmacs'></a>
<div class='synopsis'>
<span class='name'>compute_hmacs</span><span class='arguments'>(data)</span>

</div>
<div class='description'>

<p>Return array of hmacs.  Array has two strings if hmac_old_secret is set, or one string otherwise.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-compute_hmacs-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-compute_hmacs-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">261</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">compute_hmacs</span>(<span class="ruby-identifier">data</span>)
<span class="line-num">262</span>   <span class="ruby-identifier">hmacs</span> = [<span class="ruby-identifier">compute_hmac</span>(<span class="ruby-identifier">data</span>)]
<span class="line-num">263</span> 
<span class="line-num">264</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">hmac_old_secret</span>
<span class="line-num">265</span>     <span class="ruby-identifier">hmacs</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">compute_old_hmac</span>(<span class="ruby-identifier">data</span>)
<span class="line-num">266</span>   <span class="ruby-keyword">end</span>
<span class="line-num">267</span> 
<span class="line-num">268</span>   <span class="ruby-identifier">hmacs</span>
<span class="line-num">269</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-compute_old_hmac'>
<a name='method-i-compute_old_hmac'></a>
<div class='synopsis'>
<span class='name'>compute_old_hmac</span><span class='arguments'>(data)</span>

</div>
<div class='description'>

<p>Return urlsafe base64 HMAC for data using hmac_old_secret, assumes hmac_old_secret is set.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-compute_old_hmac-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-compute_old_hmac-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">255</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">compute_old_hmac</span>(<span class="ruby-identifier">data</span>)
<span class="line-num">256</span>   <span class="ruby-identifier">_process_raw_hmac</span>(<span class="ruby-identifier">compute_raw_hmac_with_secret</span>(<span class="ruby-identifier">data</span>, <span class="ruby-identifier">hmac_old_secret</span>))
<span class="line-num">257</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-compute_raw_hmac'>
<a name='method-i-compute_raw_hmac'></a>
<div class='synopsis'>
<span class='name'>compute_raw_hmac</span><span class='arguments'>(data)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-compute_raw_hmac-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-compute_raw_hmac-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">820</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">compute_raw_hmac</span>(<span class="ruby-identifier">data</span>)
<span class="line-num">821</span>   <span class="ruby-identifier">raise</span> <span class="ruby-constant">ConfigurationError</span>, <span class="ruby-string">&quot;hmac_secret not set&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">hmac_secret</span>
<span class="line-num">822</span>   <span class="ruby-identifier">compute_raw_hmac_with_secret</span>(<span class="ruby-identifier">data</span>, <span class="ruby-identifier">hmac_secret</span>)
<span class="line-num">823</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-compute_raw_hmac_with_secret'>
<a name='method-i-compute_raw_hmac_with_secret'></a>
<div class='synopsis'>
<span class='name'>compute_raw_hmac_with_secret</span><span class='arguments'>(data, secret)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-compute_raw_hmac_with_secret-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-compute_raw_hmac_with_secret-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">825</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">compute_raw_hmac_with_secret</span>(<span class="ruby-identifier">data</span>, <span class="ruby-identifier">secret</span>)
<span class="line-num">826</span>   <span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">HMAC</span>.<span class="ruby-identifier">digest</span>(<span class="ruby-constant">OpenSSL</span><span class="ruby-operator">::</span><span class="ruby-constant">Digest</span><span class="ruby-operator">::</span><span class="ruby-constant">SHA256</span>.<span class="ruby-identifier">new</span>, <span class="ruby-identifier">secret</span>, <span class="ruby-identifier">data</span>)
<span class="line-num">827</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-confirm_password'>
<a name='method-i-confirm_password'></a>
<div class='synopsis'>
<span class='name'>confirm_password</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-confirm_password-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-confirm_password-source'>   <span class="ruby-comment"># File lib/rodauth/features/confirm_password.rb</span>
<span class="line-num">63</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">confirm_password</span>
<span class="line-num">64</span>   <span class="ruby-identifier">authenticated_by</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-string">&#39;autologin&#39;</span>)
<span class="line-num">65</span>   <span class="ruby-identifier">authenticated_by</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-string">&#39;remember&#39;</span>)
<span class="line-num">66</span>   <span class="ruby-identifier">authenticated_by</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-string">&#39;email_auth&#39;</span>)
<span class="line-num">67</span>   <span class="ruby-identifier">authenticated_by</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-string">&#39;password&#39;</span>)
<span class="line-num">68</span>   <span class="ruby-identifier">authenticated_by</span>.<span class="ruby-identifier">unshift</span>(<span class="ruby-string">&quot;password&quot;</span>)
<span class="line-num">69</span>   <span class="ruby-identifier">remove_session_value</span>(<span class="ruby-identifier">autologin_type_session_key</span>)
<span class="line-num">70</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">71</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-confirm_password_redirect'>
<a name='method-i-confirm_password_redirect'></a>
<div class='synopsis'>
<span class='name'>confirm_password_redirect</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-confirm_password_redirect-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-confirm_password_redirect-source'>   <span class="ruby-comment"># File lib/rodauth/features/confirm_password.rb</span>
<span class="line-num">73</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">confirm_password_redirect</span>
<span class="line-num">74</span>   <span class="ruby-identifier">remove_session_value</span>(<span class="ruby-identifier">confirm_password_redirect_session_key</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">default_redirect</span>
<span class="line-num">75</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-convert_email_token_key'>
<a name='method-i-convert_email_token_key'></a>
<div class='synopsis'>
<span class='name'>convert_email_token_key</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-convert_email_token_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-convert_email_token_key-source'>   <span class="ruby-comment"># File lib/rodauth/features/email_base.rb</span>
<span class="line-num">61</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">convert_email_token_key</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">62</span>   <span class="ruby-identifier">convert_token_key</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">63</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-convert_response_header_key'>
<a name='method-i-convert_response_header_key'></a>
<div class='synopsis'>
<span class='name'>convert_response_header_key</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-convert_response_header_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-convert_response_header_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">571</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">convert_response_header_key</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">572</span>   <span class="ruby-identifier">key</span>
<span class="line-num">573</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-convert_session_key'>
<a name='method-i-convert_session_key'></a>
<div class='synopsis'>
<span class='name'>convert_session_key</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-convert_session_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-convert_session_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">682</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">convert_session_key</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">683</span>   <span class="ruby-identifier">key</span> = <span class="ruby-value">:&quot;#{session_key_prefix}#{key}&quot;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">session_key_prefix</span>
<span class="line-num">684</span>   <span class="ruby-identifier">normalize_session_or_flash_key</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">685</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-convert_timestamp'>
<a name='method-i-convert_timestamp'></a>
<div class='synopsis'>
<span class='name'>convert_timestamp</span><span class='arguments'>(timestamp)</span>

</div>
<div class='description'>

<p>This is needed for jdbc/sqlite, which returns timestamp columns as strings</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-convert_timestamp-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-convert_timestamp-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">865</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">convert_timestamp</span>(<span class="ruby-identifier">timestamp</span>)
<span class="line-num">866</span>   <span class="ruby-identifier">timestamp</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">to_application_timestamp</span>(<span class="ruby-identifier">timestamp</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">timestamp</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)
<span class="line-num">867</span>   <span class="ruby-identifier">timestamp</span>
<span class="line-num">868</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-convert_token_id'>
<a name='method-i-convert_token_id'></a>
<div class='synopsis'>
<span class='name'>convert_token_id</span><span class='arguments'>(id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-convert_token_id-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-convert_token_id-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">636</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">convert_token_id</span>(<span class="ruby-identifier">id</span>)
<span class="line-num">637</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">convert_token_id_to_integer?</span>
<span class="line-num">638</span>     <span class="ruby-identifier">convert_token_id_to_integer</span>(<span class="ruby-identifier">id</span>)
<span class="line-num">639</span>   <span class="ruby-keyword">else</span>
<span class="line-num">640</span>     <span class="ruby-identifier">id</span>
<span class="line-num">641</span>   <span class="ruby-keyword">end</span>
<span class="line-num">642</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-convert_token_id_to_integer'>
<a name='method-i-convert_token_id_to_integer'></a>
<div class='synopsis'>
<span class='name'>convert_token_id_to_integer</span><span class='arguments'>(id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-convert_token_id_to_integer-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-convert_token_id_to_integer-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">644</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">convert_token_id_to_integer</span>(<span class="ruby-identifier">id</span>)
<span class="line-num">645</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">id</span> = (<span class="ruby-constant">Integer</span>(<span class="ruby-identifier">id</span>, <span class="ruby-value">10</span>) <span class="ruby-keyword">rescue</span> <span class="ruby-keyword">nil</span>)
<span class="line-num">646</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">id</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">9223372036854775807</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">id</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">-9223372036854775808</span>
<span class="line-num">647</span>       <span class="ruby-comment"># Only allow 64-bit signed integer range to avoid problems on PostgreSQL</span>
<span class="line-num">648</span>       <span class="ruby-identifier">id</span> = <span class="ruby-keyword">nil</span>
<span class="line-num">649</span>     <span class="ruby-keyword">end</span>
<span class="line-num">650</span>   <span class="ruby-keyword">end</span>
<span class="line-num">651</span> 
<span class="line-num">652</span>   <span class="ruby-identifier">id</span>
<span class="line-num">653</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-convert_token_key'>
<a name='method-i-convert_token_key'></a>
<div class='synopsis'>
<span class='name'>convert_token_key</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-convert_token_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-convert_token_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">624</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">convert_token_key</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">625</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">key</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">hmac_secret</span>
<span class="line-num">626</span>     <span class="ruby-identifier">compute_hmac</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">627</span>   <span class="ruby-keyword">else</span>
<span class="line-num">628</span>     <span class="ruby-identifier">key</span>
<span class="line-num">629</span>   <span class="ruby-keyword">end</span>
<span class="line-num">630</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_account_autologin-3F'>
<a name='method-i-create_account_autologin-3F'></a>
<div class='synopsis'>
<span class='name'>create_account_autologin?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_account_autologin-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_account_autologin-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_account.rb</span>
<span class="line-num">216</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_account_autologin?</span>
<span class="line-num">217</span>   <span class="ruby-keyword">false</span>
<span class="line-num">218</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_account_notice_flash'>
<a name='method-i-create_account_notice_flash'></a>
<div class='synopsis'>
<span class='name'>create_account_notice_flash</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_account_notice_flash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_account_notice_flash-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_account.rb</span>
<span class="line-num">183</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_account_notice_flash</span>
<span class="line-num">184</span>   <span class="ruby-identifier">verify_account_email_sent_notice_flash</span>
<span class="line-num">185</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_account_set_password-3F'>
<a name='method-i-create_account_set_password-3F'></a>
<div class='synopsis'>
<span class='name'>create_account_set_password?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_account_set_password-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_account_set_password-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_account.rb</span>
<span class="line-num">220</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_account_set_password?</span>
<span class="line-num">221</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">verify_account_set_password?</span>
<span class="line-num">222</span>   <span class="ruby-keyword">super</span>
<span class="line-num">223</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_email'>
<a name='method-i-create_email'></a>
<div class='synopsis'>
<span class='name'>create_email</span><span class='arguments'>(subject, body)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_email-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_email-source'>   <span class="ruby-comment"># File lib/rodauth/features/email_base.rb</span>
<span class="line-num">40</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_email</span>(<span class="ruby-identifier">subject</span>, <span class="ruby-identifier">body</span>)
<span class="line-num">41</span>   <span class="ruby-identifier">create_email_to</span>(<span class="ruby-identifier">email_to</span>, <span class="ruby-identifier">subject</span>, <span class="ruby-identifier">body</span>)
<span class="line-num">42</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_email_auth_key'>
<a name='method-i-create_email_auth_key'></a>
<div class='synopsis'>
<span class='name'>create_email_auth_key</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_email_auth_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_email_auth_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/email_auth.rb</span>
<span class="line-num">102</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_email_auth_key</span>
<span class="line-num">103</span>   <span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>
<span class="line-num">104</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">email_auth_key_value</span> = <span class="ruby-identifier">get_email_auth_key</span>(<span class="ruby-identifier">account_id</span>)
<span class="line-num">105</span>       <span class="ruby-identifier">set_email_auth_email_last_sent</span>
<span class="line-num">106</span>       <span class="ruby-ivar">@email_auth_key_value</span> = <span class="ruby-identifier">email_auth_key_value</span>
<span class="line-num">107</span>     <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">e</span> = <span class="ruby-identifier">raised_uniqueness_violation</span>{<span class="ruby-identifier">email_auth_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">email_auth_key_insert_hash</span>)}
<span class="line-num">108</span>       <span class="ruby-comment"># If inserting into the email auth table causes a violation, we can pull the</span>
<span class="line-num">109</span>       <span class="ruby-comment"># existing email auth key from the table, or reraise.</span>
<span class="line-num">110</span>       <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@email_auth_key_value</span> = <span class="ruby-identifier">get_email_auth_key</span>(<span class="ruby-identifier">account_id</span>)
<span class="line-num">111</span>     <span class="ruby-keyword">end</span>
<span class="line-num">112</span>   <span class="ruby-keyword">end</span>
<span class="line-num">113</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_email_to'>
<a name='method-i-create_email_to'></a>
<div class='synopsis'>
<span class='name'>create_email_to</span><span class='arguments'>(to, subject, body)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_email_to-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_email_to-source'>   <span class="ruby-comment"># File lib/rodauth/features/email_base.rb</span>
<span class="line-num">44</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_email_to</span>(<span class="ruby-identifier">to</span>, <span class="ruby-identifier">subject</span>, <span class="ruby-identifier">body</span>)
<span class="line-num">45</span>   <span class="ruby-identifier">m</span> = <span class="ruby-constant">Mail</span>.<span class="ruby-identifier">new</span>
<span class="line-num">46</span>   <span class="ruby-identifier">m</span>.<span class="ruby-identifier">from</span> = <span class="ruby-identifier">email_from</span>
<span class="line-num">47</span>   <span class="ruby-identifier">m</span>.<span class="ruby-identifier">to</span> = <span class="ruby-identifier">to</span>
<span class="line-num">48</span>   <span class="ruby-identifier">m</span>.<span class="ruby-identifier">subject</span> = <span class="ruby-node">&quot;#{email_subject_prefix}#{subject}&quot;</span>
<span class="line-num">49</span>   <span class="ruby-identifier">m</span>.<span class="ruby-identifier">body</span> = <span class="ruby-identifier">body</span>
<span class="line-num">50</span>   <span class="ruby-identifier">m</span>
<span class="line-num">51</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_reset_password_key'>
<a name='method-i-create_reset_password_key'></a>
<div class='synopsis'>
<span class='name'>create_reset_password_key</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_reset_password_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_reset_password_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/reset_password.rb</span>
<span class="line-num">163</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_reset_password_key</span>
<span class="line-num">164</span>   <span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>
<span class="line-num">165</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">reset_password_key_value</span> = <span class="ruby-identifier">get_password_reset_key</span>(<span class="ruby-identifier">account_id</span>)
<span class="line-num">166</span>       <span class="ruby-identifier">set_reset_password_email_last_sent</span>
<span class="line-num">167</span>       <span class="ruby-ivar">@reset_password_key_value</span> = <span class="ruby-identifier">reset_password_key_value</span>
<span class="line-num">168</span>     <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">e</span> = <span class="ruby-identifier">raised_uniqueness_violation</span>{<span class="ruby-identifier">password_reset_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">reset_password_key_insert_hash</span>)}
<span class="line-num">169</span>       <span class="ruby-comment"># If inserting into the reset password table causes a violation, we can pull the</span>
<span class="line-num">170</span>       <span class="ruby-comment"># existing reset password key from the table, or reraise.</span>
<span class="line-num">171</span>       <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@reset_password_key_value</span> = <span class="ruby-identifier">get_password_reset_key</span>(<span class="ruby-identifier">account_id</span>)
<span class="line-num">172</span>     <span class="ruby-keyword">end</span>
<span class="line-num">173</span>   <span class="ruby-keyword">end</span>
<span class="line-num">174</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_verify_account_key'>
<a name='method-i-create_verify_account_key'></a>
<div class='synopsis'>
<span class='name'>create_verify_account_key</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_verify_account_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_verify_account_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_account.rb</span>
<span class="line-num">281</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_verify_account_key</span>
<span class="line-num">282</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">verify_account_ds</span>
<span class="line-num">283</span>   <span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>
<span class="line-num">284</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">empty?</span>
<span class="line-num">285</span>       <span class="ruby-keyword">if</span> <span class="ruby-identifier">e</span> = <span class="ruby-identifier">raised_uniqueness_violation</span>{<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">verify_account_key_insert_hash</span>)}
<span class="line-num">286</span>         <span class="ruby-comment"># If inserting into the verify account table causes a violation, we can pull the</span>
<span class="line-num">287</span>         <span class="ruby-comment"># key from the verify account table, or reraise.</span>
<span class="line-num">288</span>         <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@verify_account_key_value</span> = <span class="ruby-identifier">get_verify_account_key</span>(<span class="ruby-identifier">account_id</span>)
<span class="line-num">289</span>       <span class="ruby-keyword">end</span>
<span class="line-num">290</span>     <span class="ruby-keyword">end</span>
<span class="line-num">291</span>   <span class="ruby-keyword">end</span>
<span class="line-num">292</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_verify_login_change_email'>
<a name='method-i-create_verify_login_change_email'></a>
<div class='synopsis'>
<span class='name'>create_verify_login_change_email</span><span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_verify_login_change_email-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_verify_login_change_email-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb</span>
<span class="line-num">198</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_verify_login_change_email</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">199</span>   <span class="ruby-identifier">create_email_to</span>(<span class="ruby-identifier">login</span>, <span class="ruby-identifier">verify_login_change_email_subject</span>, <span class="ruby-identifier">verify_login_change_email_body</span>)
<span class="line-num">200</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-create_verify_login_change_key'>
<a name='method-i-create_verify_login_change_key'></a>
<div class='synopsis'>
<span class='name'>create_verify_login_change_key</span><span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-create_verify_login_change_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-create_verify_login_change_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb</span>
<span class="line-num">176</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">create_verify_login_change_key</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">177</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">verify_login_change_ds</span>
<span class="line-num">178</span>   <span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>
<span class="line-num">179</span>     <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">where</span>((<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">verify_login_change_deadline_column</span>) <span class="ruby-operator">|</span> <span class="ruby-operator">~</span><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">expr</span>(<span class="ruby-identifier">verify_login_change_login_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">login</span>)).<span class="ruby-identifier">delete</span>
<span class="line-num">180</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">e</span> = <span class="ruby-identifier">raised_uniqueness_violation</span>{<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">verify_login_change_key_insert_hash</span>(<span class="ruby-identifier">login</span>))}
<span class="line-num">181</span>       <span class="ruby-identifier">old_login</span>, <span class="ruby-identifier">key</span> = <span class="ruby-identifier">get_verify_login_change_login_and_key</span>(<span class="ruby-identifier">account_id</span>)
<span class="line-num">182</span>       <span class="ruby-comment"># If inserting into the verify login change table causes a violation, we can pull the</span>
<span class="line-num">183</span>       <span class="ruby-comment"># key from the verify login change table if the logins match, or reraise.</span>
<span class="line-num">184</span>       <span class="ruby-ivar">@verify_login_change_key_value</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">old_login</span>.<span class="ruby-identifier">downcase</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">login</span>.<span class="ruby-identifier">downcase</span>
<span class="line-num">185</span>         <span class="ruby-identifier">key</span>
<span class="line-num">186</span>       <span class="ruby-keyword">end</span>
<span class="line-num">187</span>       <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@verify_login_change_key_value</span>
<span class="line-num">188</span>     <span class="ruby-keyword">end</span>
<span class="line-num">189</span>   <span class="ruby-keyword">end</span>
<span class="line-num">190</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-csrf_tag'>
<a name='method-i-csrf_tag'></a>
<div class='synopsis'>
<span class='name'>csrf_tag</span><span class='arguments'>(path=request.path)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-csrf_tag-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-csrf_tag-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">399</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">csrf_tag</span>(<span class="ruby-identifier">path</span>=<span class="ruby-identifier">request</span>.<span class="ruby-identifier">path</span>)
<span class="line-num">400</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:csrf_tag</span>)
<span class="line-num">401</span> 
<span class="line-num">402</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_request_specific_csrf_tokens?</span>
<span class="line-num">403</span>     <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">csrf_tag</span>(<span class="ruby-identifier">path</span>)
<span class="line-num">404</span>   <span class="ruby-keyword">else</span>
<span class="line-num">405</span>     <span class="ruby-comment"># :nocov:</span>
<span class="line-num">406</span>     <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">csrf_tag</span>
<span class="line-num">407</span>     <span class="ruby-comment"># :nocov:</span>
<span class="line-num">408</span>   <span class="ruby-keyword">end</span>
<span class="line-num">409</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-currently_active_session-3F'>
<a name='method-i-currently_active_session-3F'></a>
<div class='synopsis'>
<span class='name'>currently_active_session?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-currently_active_session-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-currently_active_session-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">40</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">currently_active_session?</span>
<span class="line-num">41</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">session_id</span> = <span class="ruby-identifier">session</span>[<span class="ruby-identifier">session_id_session_key</span>]
<span class="line-num">42</span> 
<span class="line-num">43</span>   <span class="ruby-identifier">remove_inactive_sessions</span>
<span class="line-num">44</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">active_sessions_ds</span>.
<span class="line-num">45</span>     <span class="ruby-identifier">where</span>(<span class="ruby-identifier">active_sessions_session_id_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">compute_hmacs</span>(<span class="ruby-identifier">session_id</span>))
<span class="line-num">46</span> 
<span class="line-num">47</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">update_current_session?</span>
<span class="line-num">48</span>     <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">active_sessions_update_hash</span>) <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
<span class="line-num">49</span>   <span class="ruby-keyword">else</span>
<span class="line-num">50</span>     <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">count</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
<span class="line-num">51</span>   <span class="ruby-keyword">end</span>
<span class="line-num">52</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-database_function_password_match-3F'>
<a name='method-i-database_function_password_match-3F'></a>
<div class='synopsis'>
<span class='name'>database_function_password_match?</span><span class='arguments'>(name, hash_id, password, salt)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-database_function_password_match-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-database_function_password_match-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/argon2.rb</span>
<span class="line-num">119</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">database_function_password_match?</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">hash_id</span>, <span class="ruby-identifier">password</span>, <span class="ruby-identifier">salt</span>)
<span class="line-num">120</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">super</span>
<span class="line-num">121</span> 
<span class="line-num">122</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_argon2?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">argon2_hash_algorithm?</span>(<span class="ruby-identifier">salt</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">argon2_old_secret</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">argon2_secret</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">ret</span> = <span class="ruby-identifier">db</span>.<span class="ruby-identifier">get</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">function</span>(<span class="ruby-identifier">function_name</span>(<span class="ruby-identifier">name</span>), <span class="ruby-identifier">hash_id</span>, <span class="ruby-identifier">argon2_password_hash_using_salt_and_secret</span>(<span class="ruby-identifier">password</span>, <span class="ruby-identifier">salt</span>, <span class="ruby-identifier">argon2_old_secret</span>))))
<span class="line-num">123</span>     <span class="ruby-ivar">@update_password_hash</span> = <span class="ruby-keyword">true</span>
<span class="line-num">124</span>   <span class="ruby-keyword">end</span>
<span class="line-num">125</span> 
<span class="line-num">126</span>   <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-identifier">ret</span>
<span class="line-num">127</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-db'>
<a name='method-i-db'></a>
<div class='synopsis'>
<span class='name'>db</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-db-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-db-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">289</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">db</span>
<span class="line-num">290</span>   <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">DATABASES</span>.<span class="ruby-identifier">first</span> <span class="ruby-keyword">or</span> <span class="ruby-identifier">raise</span> <span class="ruby-string">&quot;Sequel database connection is missing&quot;</span>
<span class="line-num">291</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-delete_account'>
<a name='method-i-delete_account'></a>
<div class='synopsis'>
<span class='name'>delete_account</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-delete_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-delete_account-source'>   <span class="ruby-comment"># File lib/rodauth/features/close_account.rb</span>
<span class="line-num">76</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">delete_account</span>
<span class="line-num">77</span>   <span class="ruby-identifier">account_ds</span>.<span class="ruby-identifier">delete</span>
<span class="line-num">78</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-delete_account_on_close-3F'>
<a name='method-i-delete_account_on_close-3F'></a>
<div class='synopsis'>
<span class='name'>delete_account_on_close?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-delete_account_on_close-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-delete_account_on_close-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/close_account.rb</span>
<span class="line-num">80</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">delete_account_on_close?</span>
<span class="line-num">81</span>   <span class="ruby-identifier">skip_status_checks?</span>
<span class="line-num">82</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-disable_remember_login'>
<a name='method-i-disable_remember_login'></a>
<div class='synopsis'>
<span class='name'>disable_remember_login</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-disable_remember_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-disable_remember_login-source'>    <span class="ruby-comment"># File lib/rodauth/features/remember.rb</span>
<span class="line-num">155</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">disable_remember_login</span>
<span class="line-num">156</span>   <span class="ruby-identifier">remove_remember_key</span>
<span class="line-num">157</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-domain'>
<a name='method-i-domain'></a>
<div class='synopsis'>
<span class='name'>domain</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-domain-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-domain-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">535</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">domain</span>
<span class="line-num">536</span>   <span class="ruby-identifier">request</span>.<span class="ruby-identifier">host</span>
<span class="line-num">537</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-email_auth_ds'>
<a name='method-i-email_auth_ds'></a>
<div class='synopsis'>
<span class='name'>email_auth_ds</span><span class='arguments'>(id=account_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-email_auth_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-email_auth_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/email_auth.rb</span>
<span class="line-num">232</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">email_auth_ds</span>(<span class="ruby-identifier">id</span>=<span class="ruby-identifier">account_id</span>)
<span class="line-num">233</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">email_auth_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">email_auth_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">id</span>)
<span class="line-num">234</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-email_auth_email_link'>
<a name='method-i-email_auth_email_link'></a>
<div class='synopsis'>
<span class='name'>email_auth_email_link</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-email_auth_email_link-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-email_auth_email_link-source'>    <span class="ruby-comment"># File lib/rodauth/features/email_auth.rb</span>
<span class="line-num">135</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">email_auth_email_link</span>
<span class="line-num">136</span>   <span class="ruby-identifier">token_link</span>(<span class="ruby-identifier">email_auth_route</span>, <span class="ruby-identifier">email_auth_key_param</span>, <span class="ruby-identifier">email_auth_key_value</span>)
<span class="line-num">137</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-email_auth_email_recently_sent-3F'>
<a name='method-i-email_auth_email_recently_sent-3F'></a>
<div class='synopsis'>
<span class='name'>email_auth_email_recently_sent?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-email_auth_email_recently_sent-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-email_auth_email_recently_sent-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/email_auth.rb</span>
<span class="line-num">166</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">email_auth_email_recently_sent?</span>
<span class="line-num">167</span>   (<span class="ruby-identifier">email_last_sent</span> = <span class="ruby-identifier">get_email_auth_email_last_sent</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">email_last_sent</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">email_auth_skip_resend_email_within</span>)
<span class="line-num">168</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-email_auth_key_insert_hash'>
<a name='method-i-email_auth_key_insert_hash'></a>
<div class='synopsis'>
<span class='name'>email_auth_key_insert_hash</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-email_auth_key_insert_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-email_auth_key_insert_hash-source'>    <span class="ruby-comment"># File lib/rodauth/features/email_auth.rb</span>
<span class="line-num">226</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">email_auth_key_insert_hash</span>
<span class="line-num">227</span>   <span class="ruby-identifier">hash</span> = {<span class="ruby-identifier">email_auth_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">email_auth_key_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">email_auth_key_value</span>}
<span class="line-num">228</span>   <span class="ruby-identifier">set_deadline_value</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">email_auth_deadline_column</span>, <span class="ruby-identifier">email_auth_deadline_interval</span>)
<span class="line-num">229</span>   <span class="ruby-identifier">hash</span>
<span class="line-num">230</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-email_auth_request_form'>
<a name='method-i-email_auth_request_form'></a>
<div class='synopsis'>
<span class='name'>email_auth_request_form</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-email_auth_request_form-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-email_auth_request_form-source'>    <span class="ruby-comment"># File lib/rodauth/features/email_auth.rb</span>
<span class="line-num">145</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">email_auth_request_form</span>
<span class="line-num">146</span>   <span class="ruby-identifier">render</span>(<span class="ruby-string">&#39;email-auth-request-form&#39;</span>)
<span class="line-num">147</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-email_from'>
<a name='method-i-email_from'></a>
<div class='synopsis'>
<span class='name'>email_from</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-email_from-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-email_from-source'>   <span class="ruby-comment"># File lib/rodauth/features/email_base.rb</span>
<span class="line-num">26</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">email_from</span>
<span class="line-num">27</span>   <span class="ruby-node">&quot;webmaster@#{domain}&quot;</span>
<span class="line-num">28</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-email_to'>
<a name='method-i-email_to'></a>
<div class='synopsis'>
<span class='name'>email_to</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-email_to-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-email_to-source'>   <span class="ruby-comment"># File lib/rodauth/features/email_base.rb</span>
<span class="line-num">30</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">email_to</span>
<span class="line-num">31</span>   <span class="ruby-identifier">account</span>[<span class="ruby-identifier">login_column</span>]
<span class="line-num">32</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-expire_session'>
<a name='method-i-expire_session'></a>
<div class='synopsis'>
<span class='name'>expire_session</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-expire_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-expire_session-source'>   <span class="ruby-comment"># File lib/rodauth/features/session_expiration.rb</span>
<span class="line-num">38</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">expire_session</span>
<span class="line-num">39</span>   <span class="ruby-identifier">clear_session</span>
<span class="line-num">40</span>   <span class="ruby-identifier">set_redirect_error_status</span> <span class="ruby-identifier">session_expiration_error_status</span>
<span class="line-num">41</span>   <span class="ruby-identifier">set_error_reason</span> <span class="ruby-value">:session_expired</span>
<span class="line-num">42</span>   <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">session_expiration_error_flash</span>
<span class="line-num">43</span>   <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">session_expiration_redirect</span>
<span class="line-num">44</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-extend_remember_deadline'>
<a name='method-i-extend_remember_deadline'></a>
<div class='synopsis'>
<span class='name'>extend_remember_deadline</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-extend_remember_deadline-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-extend_remember_deadline-source'>    <span class="ruby-comment"># File lib/rodauth/features/remember.rb</span>
<span class="line-num">206</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">extend_remember_deadline</span>
<span class="line-num">207</span>   <span class="ruby-identifier">active_remember_key_ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">remember_deadline_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">date_add</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>, <span class="ruby-identifier">remember_period</span>))
<span class="line-num">208</span>   <span class="ruby-identifier">remember_login</span>
<span class="line-num">209</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-extend_remember_deadline_while_logged_in-3F'>
<a name='method-i-extend_remember_deadline_while_logged_in-3F'></a>
<div class='synopsis'>
<span class='name'>extend_remember_deadline_while_logged_in?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-extend_remember_deadline_while_logged_in-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-extend_remember_deadline_while_logged_in-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/remember.rb</span>
<span class="line-num">194</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">extend_remember_deadline_while_logged_in?</span>
<span class="line-num">195</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">extend_remember_deadline?</span>
<span class="line-num">196</span> 
<span class="line-num">197</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">extended_at</span> = <span class="ruby-identifier">session</span>[<span class="ruby-identifier">remember_deadline_extended_session_key</span>]
<span class="line-num">198</span>     <span class="ruby-identifier">extended_at</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">extend_remember_deadline_period</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_i</span>
<span class="line-num">199</span>   <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">logged_in_via_remember_key?</span>
<span class="line-num">200</span>     <span class="ruby-comment"># Handle existing sessions before the change to extend remember deadline</span>
<span class="line-num">201</span>     <span class="ruby-comment"># while logged in.</span>
<span class="line-num">202</span>     <span class="ruby-keyword">true</span>
<span class="line-num">203</span>   <span class="ruby-keyword">end</span>
<span class="line-num">204</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-extract_password_hash_cost'>
<a name='method-i-extract_password_hash_cost'></a>
<div class='synopsis'>
<span class='name'>extract_password_hash_cost</span><span class='arguments'>(hash)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-extract_password_hash_cost-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-extract_password_hash_cost-source'>   <span class="ruby-comment"># File lib/rodauth/features/argon2.rb</span>
<span class="line-num">68</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">extract_password_hash_cost</span>(<span class="ruby-identifier">hash</span>)
<span class="line-num">69</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">super</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">argon2_hash_algorithm?</span>(<span class="ruby-identifier">hash</span>)
<span class="line-num">70</span> 
<span class="line-num">71</span>   <span class="ruby-regexp">/\A\$argon2id\$v=\d+\$m=(\d+),t=(\d+),p=(\d+)/</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">hash</span>
<span class="line-num">72</span>   { <span class="ruby-value">t_cost:</span> <span class="ruby-node">$2</span>.<span class="ruby-identifier">to_i</span>, <span class="ruby-value">m_cost:</span> <span class="ruby-constant">Math</span>.<span class="ruby-identifier">log2</span>(<span class="ruby-node">$1</span>.<span class="ruby-identifier">to_i</span>).<span class="ruby-identifier">to_i</span>, <span class="ruby-value">p_cost:</span> <span class="ruby-node">$3</span>.<span class="ruby-identifier">to_i</span> }
<span class="line-num">73</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-features'>
<a name='method-i-features'></a>
<div class='synopsis'>
<span class='name'>features</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-features-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-features-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">149</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">features</span>
<span class="line-num">150</span>   <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">features</span>
<span class="line-num">151</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-field_attributes'>
<a name='method-i-field_attributes'></a>
<div class='synopsis'>
<span class='name'>field_attributes</span><span class='arguments'>(field)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-field_attributes-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-field_attributes-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">224</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">field_attributes</span>(<span class="ruby-identifier">field</span>)
<span class="line-num">225</span>   <span class="ruby-identifier">_field_attributes</span>(<span class="ruby-identifier">field</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">default_field_attributes</span>
<span class="line-num">226</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-field_error'>
<a name='method-i-field_error'></a>
<div class='synopsis'>
<span class='name'>field_error</span><span class='arguments'>(field)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-field_error-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-field_error-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">181</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">field_error</span>(<span class="ruby-identifier">field</span>)
<span class="line-num">182</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">nil</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@field_errors</span>
<span class="line-num">183</span>   <span class="ruby-ivar">@field_errors</span>[<span class="ruby-identifier">field</span>]
<span class="line-num">184</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-field_error_attributes'>
<a name='method-i-field_error_attributes'></a>
<div class='synopsis'>
<span class='name'>field_error_attributes</span><span class='arguments'>(field)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-field_error_attributes-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-field_error_attributes-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">228</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">field_error_attributes</span>(<span class="ruby-identifier">field</span>)
<span class="line-num">229</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">field_error</span>(<span class="ruby-identifier">field</span>)
<span class="line-num">230</span>     <span class="ruby-identifier">_field_error_attributes</span>(<span class="ruby-identifier">field</span>)
<span class="line-num">231</span>   <span class="ruby-keyword">end</span>
<span class="line-num">232</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-flash'>
<a name='method-i-flash'></a>
<div class='synopsis'>
<span class='name'>flash</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-flash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-flash-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">165</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">flash</span>
<span class="line-num">166</span>   <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">flash</span>
<span class="line-num">167</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-forget_login'>
<a name='method-i-forget_login'></a>
<div class='synopsis'>
<span class='name'>forget_login</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-forget_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-forget_login-source'>    <span class="ruby-comment"># File lib/rodauth/features/remember.rb</span>
<span class="line-num">138</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">forget_login</span>
<span class="line-num">139</span>   <span class="ruby-identifier">opts</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-identifier">remember_cookie_options</span>]
<span class="line-num">140</span>   <span class="ruby-identifier">opts</span>[<span class="ruby-value">:path</span>] = <span class="ruby-string">&quot;/&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">key?</span>(<span class="ruby-value">:path</span>)
<span class="line-num">141</span>   <span class="ruby-operator">::</span><span class="ruby-constant">Rack</span><span class="ruby-operator">::</span><span class="ruby-constant">Utils</span>.<span class="ruby-identifier">delete_cookie_header!</span>(<span class="ruby-identifier">response</span>.<span class="ruby-identifier">headers</span>, <span class="ruby-identifier">remember_cookie_key</span>, <span class="ruby-identifier">opts</span>)
<span class="line-num">142</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-formatted_field_error'>
<a name='method-i-formatted_field_error'></a>
<div class='synopsis'>
<span class='name'>formatted_field_error</span><span class='arguments'>(field)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-formatted_field_error-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-formatted_field_error-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">234</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">formatted_field_error</span>(<span class="ruby-identifier">field</span>)
<span class="line-num">235</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">error</span> = <span class="ruby-identifier">field_error</span>(<span class="ruby-identifier">field</span>)
<span class="line-num">236</span>     <span class="ruby-identifier">_formatted_field_error</span>(<span class="ruby-identifier">field</span>, <span class="ruby-identifier">error</span>)
<span class="line-num">237</span>   <span class="ruby-keyword">end</span>
<span class="line-num">238</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-function_name'>
<a name='method-i-function_name'></a>
<div class='synopsis'>
<span class='name'>function_name</span><span class='arguments'>(name)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-function_name-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-function_name-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">769</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">function_name</span>(<span class="ruby-identifier">name</span>)
<span class="line-num">770</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">database_type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:mssql</span>
<span class="line-num">771</span>     <span class="ruby-comment"># :nocov:</span>
<span class="line-num">772</span>     <span class="ruby-node">&quot;dbo.#{name}&quot;</span>
<span class="line-num">773</span>     <span class="ruby-comment"># :nocov:</span>
<span class="line-num">774</span>   <span class="ruby-keyword">else</span>
<span class="line-num">775</span>     <span class="ruby-identifier">name</span>
<span class="line-num">776</span>   <span class="ruby-keyword">end</span>
<span class="line-num">777</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-generate_active_sessions_key'>
<a name='method-i-generate_active_sessions_key'></a>
<div class='synopsis'>
<span class='name'>generate_active_sessions_key</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-generate_active_sessions_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-generate_active_sessions_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">158</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">generate_active_sessions_key</span>
<span class="line-num">159</span>   <span class="ruby-ivar">@active_sessions_key</span> = <span class="ruby-identifier">random_key</span>
<span class="line-num">160</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-generate_email_auth_key_value'>
<a name='method-i-generate_email_auth_key_value'></a>
<div class='synopsis'>
<span class='name'>generate_email_auth_key_value</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-generate_email_auth_key_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-generate_email_auth_key_value-source'>    <span class="ruby-comment"># File lib/rodauth/features/email_auth.rb</span>
<span class="line-num">218</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">generate_email_auth_key_value</span>
<span class="line-num">219</span>   <span class="ruby-ivar">@email_auth_key_value</span> = <span class="ruby-identifier">random_key</span>
<span class="line-num">220</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-generate_refresh_token'>
<a name='method-i-generate_refresh_token'></a>
<div class='synopsis'>
<span class='name'>generate_refresh_token</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-generate_refresh_token-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-generate_refresh_token-source'>    <span class="ruby-comment"># File lib/rodauth/features/jwt_refresh.rb</span>
<span class="line-num">185</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">generate_refresh_token</span>
<span class="line-num">186</span>   <span class="ruby-identifier">hash</span> = <span class="ruby-identifier">jwt_refresh_token_insert_hash</span>
<span class="line-num">187</span>   [<span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">jwt_refresh_token_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">hash</span>), <span class="ruby-identifier">convert_token_key</span>(<span class="ruby-identifier">hash</span>[<span class="ruby-identifier">jwt_refresh_token_key_column</span>])].<span class="ruby-identifier">join</span>(<span class="ruby-identifier">token_separator</span>)
<span class="line-num">188</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-generate_remember_key_value'>
<a name='method-i-generate_remember_key_value'></a>
<div class='synopsis'>
<span class='name'>generate_remember_key_value</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-generate_remember_key_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-generate_remember_key_value-source'>    <span class="ruby-comment"># File lib/rodauth/features/remember.rb</span>
<span class="line-num">247</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">generate_remember_key_value</span>
<span class="line-num">248</span>   <span class="ruby-ivar">@remember_key_value</span> = <span class="ruby-identifier">random_key</span>
<span class="line-num">249</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-generate_reset_password_key_value'>
<a name='method-i-generate_reset_password_key_value'></a>
<div class='synopsis'>
<span class='name'>generate_reset_password_key_value</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-generate_reset_password_key_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-generate_reset_password_key_value-source'>    <span class="ruby-comment"># File lib/rodauth/features/reset_password.rb</span>
<span class="line-num">234</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">generate_reset_password_key_value</span>
<span class="line-num">235</span>   <span class="ruby-ivar">@reset_password_key_value</span> = <span class="ruby-identifier">random_key</span>
<span class="line-num">236</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-generate_unlock_account_key'>
<a name='method-i-generate_unlock_account_key'></a>
<div class='synopsis'>
<span class='name'>generate_unlock_account_key</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-generate_unlock_account_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-generate_unlock_account_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/lockout.rb</span>
<span class="line-num">270</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">generate_unlock_account_key</span>
<span class="line-num">271</span>   <span class="ruby-identifier">random_key</span>
<span class="line-num">272</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-generate_verify_account_key_value'>
<a name='method-i-generate_verify_account_key_value'></a>
<div class='synopsis'>
<span class='name'>generate_verify_account_key_value</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-generate_verify_account_key_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-generate_verify_account_key_value-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_account.rb</span>
<span class="line-num">277</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">generate_verify_account_key_value</span>
<span class="line-num">278</span>   <span class="ruby-ivar">@verify_account_key_value</span> = <span class="ruby-identifier">random_key</span>
<span class="line-num">279</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-generate_verify_login_change_key_value'>
<a name='method-i-generate_verify_login_change_key_value'></a>
<div class='synopsis'>
<span class='name'>generate_verify_login_change_key_value</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-generate_verify_login_change_key_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-generate_verify_login_change_key_value-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb</span>
<span class="line-num">172</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">generate_verify_login_change_key_value</span>
<span class="line-num">173</span>   <span class="ruby-ivar">@verify_login_change_key_value</span> = <span class="ruby-identifier">random_key</span>
<span class="line-num">174</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_active_refresh_token'>
<a name='method-i-get_active_refresh_token'></a>
<div class='synopsis'>
<span class='name'>get_active_refresh_token</span><span class='arguments'>(account_id, token_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_active_refresh_token-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_active_refresh_token-source'>    <span class="ruby-comment"># File lib/rodauth/features/jwt_refresh.rb</span>
<span class="line-num">158</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_active_refresh_token</span>(<span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">token_id</span>)
<span class="line-num">159</span>   <span class="ruby-identifier">jwt_refresh_token_account_ds</span>(<span class="ruby-identifier">account_id</span>).
<span class="line-num">160</span>     <span class="ruby-identifier">where</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">jwt_refresh_token_deadline_column</span>).
<span class="line-num">161</span>     <span class="ruby-identifier">delete</span>
<span class="line-num">162</span> 
<span class="line-num">163</span>   <span class="ruby-identifier">jwt_refresh_token_account_token_ds</span>(<span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">token_id</span>).
<span class="line-num">164</span>     <span class="ruby-identifier">get</span>(<span class="ruby-identifier">jwt_refresh_token_key_column</span>)
<span class="line-num">165</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_activity_timestamp'>
<a name='method-i-get_activity_timestamp'></a>
<div class='synopsis'>
<span class='name'>get_activity_timestamp</span><span class='arguments'>(account_id, column)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_activity_timestamp-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_activity_timestamp-source'>    <span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb</span>
<span class="line-num">109</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_activity_timestamp</span>(<span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">column</span>)
<span class="line-num">110</span>   <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">account_activity_ds</span>(<span class="ruby-identifier">account_id</span>).<span class="ruby-identifier">get</span>(<span class="ruby-identifier">column</span>))
<span class="line-num">111</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_email_auth_email_last_sent'>
<a name='method-i-get_email_auth_email_last_sent'></a>
<div class='synopsis'>
<span class='name'>get_email_auth_email_last_sent</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_email_auth_email_last_sent-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_email_auth_email_last_sent-source'>    <span class="ruby-comment"># File lib/rodauth/features/email_auth.rb</span>
<span class="line-num">119</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_email_auth_email_last_sent</span>
<span class="line-num">120</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">column</span> = <span class="ruby-identifier">email_auth_email_last_sent_column</span>
<span class="line-num">121</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">ts</span> = <span class="ruby-identifier">email_auth_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">column</span>)
<span class="line-num">122</span>       <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">ts</span>)
<span class="line-num">123</span>     <span class="ruby-keyword">end</span>
<span class="line-num">124</span>   <span class="ruby-keyword">end</span>
<span class="line-num">125</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_email_auth_key'>
<a name='method-i-get_email_auth_key'></a>
<div class='synopsis'>
<span class='name'>get_email_auth_key</span><span class='arguments'>(id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_email_auth_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_email_auth_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/email_auth.rb</span>
<span class="line-num">139</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_email_auth_key</span>(<span class="ruby-identifier">id</span>)
<span class="line-num">140</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">email_auth_ds</span>(<span class="ruby-identifier">id</span>)
<span class="line-num">141</span>   <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">email_auth_deadline_column</span>).<span class="ruby-identifier">delete</span>
<span class="line-num">142</span>   <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">email_auth_key_column</span>)
<span class="line-num">143</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_password_changed_at'>
<a name='method-i-get_password_changed_at'></a>
<div class='synopsis'>
<span class='name'>get_password_changed_at</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_password_changed_at-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_password_changed_at-source'>   <span class="ruby-comment"># File lib/rodauth/features/password_expiration.rb</span>
<span class="line-num">26</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_password_changed_at</span>
<span class="line-num">27</span>   <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">password_expiration_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">password_expiration_changed_at_column</span>))
<span class="line-num">28</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_password_hash'>
<a name='method-i-get_password_hash'></a>
<div class='synopsis'>
<span class='name'>get_password_hash</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>Get the password hash for the user.  When using database authentication functions, note that only the salt is returned.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_password_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_password_hash-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">785</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_password_hash</span>
<span class="line-num">786</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">account_password_hash_column</span>
<span class="line-num">787</span>     <span class="ruby-identifier">account</span>[<span class="ruby-identifier">account_password_hash_column</span>] <span class="ruby-keyword">if</span> <span class="ruby-identifier">account!</span>
<span class="line-num">788</span>   <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">use_database_authentication_functions?</span>
<span class="line-num">789</span>     <span class="ruby-identifier">db</span>.<span class="ruby-identifier">get</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">function</span>(<span class="ruby-identifier">function_name</span>(<span class="ruby-value">:rodauth_get_salt</span>), <span class="ruby-identifier">account</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">account_id</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">session_value</span>))
<span class="line-num">790</span>   <span class="ruby-keyword">else</span>
<span class="line-num">791</span>     <span class="ruby-comment"># :nocov:</span>
<span class="line-num">792</span>     <span class="ruby-identifier">password_hash_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">password_hash_column</span>)
<span class="line-num">793</span>     <span class="ruby-comment"># :nocov:</span>
<span class="line-num">794</span>   <span class="ruby-keyword">end</span>
<span class="line-num">795</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_password_reset_key'>
<a name='method-i-get_password_reset_key'></a>
<div class='synopsis'>
<span class='name'>get_password_reset_key</span><span class='arguments'>(id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_password_reset_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_password_reset_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/reset_password.rb</span>
<span class="line-num">192</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_password_reset_key</span>(<span class="ruby-identifier">id</span>)
<span class="line-num">193</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">password_reset_ds</span>(<span class="ruby-identifier">id</span>)
<span class="line-num">194</span>   <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">reset_password_deadline_column</span>).<span class="ruby-identifier">delete</span>
<span class="line-num">195</span>   <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">reset_password_key_column</span>)
<span class="line-num">196</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_remember_key'>
<a name='method-i-get_remember_key'></a>
<div class='synopsis'>
<span class='name'>get_remember_key</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_remember_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_remember_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/remember.rb</span>
<span class="line-num">144</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_remember_key</span>
<span class="line-num">145</span>   <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@remember_key_value</span> = <span class="ruby-identifier">active_remember_key_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">remember_key_column</span>)
<span class="line-num">146</span>    <span class="ruby-identifier">generate_remember_key_value</span>
<span class="line-num">147</span>    <span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>
<span class="line-num">148</span>      <span class="ruby-identifier">remove_remember_key</span>
<span class="line-num">149</span>      <span class="ruby-identifier">add_remember_key</span>
<span class="line-num">150</span>    <span class="ruby-keyword">end</span>
<span class="line-num">151</span>   <span class="ruby-keyword">end</span>
<span class="line-num">152</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">153</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_reset_password_email_last_sent'>
<a name='method-i-get_reset_password_email_last_sent'></a>
<div class='synopsis'>
<span class='name'>get_reset_password_email_last_sent</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_reset_password_email_last_sent-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_reset_password_email_last_sent-source'>    <span class="ruby-comment"># File lib/rodauth/features/reset_password.rb</span>
<span class="line-num">202</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_reset_password_email_last_sent</span>
<span class="line-num">203</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">column</span> = <span class="ruby-identifier">reset_password_email_last_sent_column</span>
<span class="line-num">204</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">ts</span> = <span class="ruby-identifier">password_reset_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">column</span>)
<span class="line-num">205</span>       <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">ts</span>)
<span class="line-num">206</span>     <span class="ruby-keyword">end</span>
<span class="line-num">207</span>   <span class="ruby-keyword">end</span>
<span class="line-num">208</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_unlock_account_email_last_sent'>
<a name='method-i-get_unlock_account_email_last_sent'></a>
<div class='synopsis'>
<span class='name'>get_unlock_account_email_last_sent</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_unlock_account_email_last_sent-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_unlock_account_email_last_sent-source'>    <span class="ruby-comment"># File lib/rodauth/features/lockout.rb</span>
<span class="line-num">228</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_unlock_account_email_last_sent</span>
<span class="line-num">229</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">column</span> = <span class="ruby-identifier">account_lockouts_email_last_sent_column</span>
<span class="line-num">230</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">ts</span> = <span class="ruby-identifier">account_lockouts_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">column</span>)
<span class="line-num">231</span>       <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">ts</span>)
<span class="line-num">232</span>     <span class="ruby-keyword">end</span>
<span class="line-num">233</span>   <span class="ruby-keyword">end</span>
<span class="line-num">234</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_unlock_account_key'>
<a name='method-i-get_unlock_account_key'></a>
<div class='synopsis'>
<span class='name'>get_unlock_account_key</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_unlock_account_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_unlock_account_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/lockout.rb</span>
<span class="line-num">216</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_unlock_account_key</span>
<span class="line-num">217</span>   <span class="ruby-identifier">account_lockouts_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">account_lockouts_key_column</span>)
<span class="line-num">218</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_verify_account_email_last_sent'>
<a name='method-i-get_verify_account_email_last_sent'></a>
<div class='synopsis'>
<span class='name'>get_verify_account_email_last_sent</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_verify_account_email_last_sent-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_verify_account_email_last_sent-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_account.rb</span>
<span class="line-num">229</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_verify_account_email_last_sent</span>
<span class="line-num">230</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">column</span> = <span class="ruby-identifier">verify_account_email_last_sent_column</span>
<span class="line-num">231</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">ts</span> = <span class="ruby-identifier">verify_account_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">column</span>)
<span class="line-num">232</span>       <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">ts</span>)
<span class="line-num">233</span>     <span class="ruby-keyword">end</span>
<span class="line-num">234</span>   <span class="ruby-keyword">end</span>
<span class="line-num">235</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_verify_account_key'>
<a name='method-i-get_verify_account_key'></a>
<div class='synopsis'>
<span class='name'>get_verify_account_key</span><span class='arguments'>(id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_verify_account_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_verify_account_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_account.rb</span>
<span class="line-num">208</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_verify_account_key</span>(<span class="ruby-identifier">id</span>)
<span class="line-num">209</span>   <span class="ruby-identifier">verify_account_ds</span>(<span class="ruby-identifier">id</span>).<span class="ruby-identifier">get</span>(<span class="ruby-identifier">verify_account_key_column</span>)
<span class="line-num">210</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-get_verify_login_change_login_and_key'>
<a name='method-i-get_verify_login_change_login_and_key'></a>
<div class='synopsis'>
<span class='name'>get_verify_login_change_login_and_key</span><span class='arguments'>(id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-get_verify_login_change_login_and_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-get_verify_login_change_login_and_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb</span>
<span class="line-num">132</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">get_verify_login_change_login_and_key</span>(<span class="ruby-identifier">id</span>)
<span class="line-num">133</span>   <span class="ruby-identifier">verify_login_change_ds</span>(<span class="ruby-identifier">id</span>).<span class="ruby-identifier">get</span>([<span class="ruby-identifier">verify_login_change_login_column</span>, <span class="ruby-identifier">verify_login_change_key_column</span>])
<span class="line-num">134</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-handle_duplicate_active_session_id'>
<a name='method-i-handle_duplicate_active_session_id'></a>
<div class='synopsis'>
<span class='name'>handle_duplicate_active_session_id</span><span class='arguments'>(_e)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-handle_duplicate_active_session_id-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-handle_duplicate_active_session_id-source'>   <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">77</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">handle_duplicate_active_session_id</span>(<span class="ruby-identifier">_e</span>)
<span class="line-num">78</span>   <span class="ruby-comment"># Do nothing by default as session is already tracked.  This will result in</span>
<span class="line-num">79</span>   <span class="ruby-comment"># the current session and the existing session with the same id</span>
<span class="line-num">80</span>   <span class="ruby-comment"># being tracked together, so that a logout of one will logout</span>
<span class="line-num">81</span>   <span class="ruby-comment"># the other, and updating the last use on one will update the other,</span>
<span class="line-num">82</span>   <span class="ruby-comment"># but this should be acceptable.  However, this can be overridden if different</span>
<span class="line-num">83</span>   <span class="ruby-comment"># behavior is desired.</span>
<span class="line-num">84</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-handle_webauthn_sign_count_verification_error'>
<a name='method-i-handle_webauthn_sign_count_verification_error'></a>
<div class='synopsis'>
<span class='name'>handle_webauthn_sign_count_verification_error</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-handle_webauthn_sign_count_verification_error-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-handle_webauthn_sign_count_verification_error-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">352</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">handle_webauthn_sign_count_verification_error</span>
<span class="line-num">353</span>   <span class="ruby-identifier">throw_error_reason</span>(<span class="ruby-value">:invalid_webauthn_sign_count</span>, <span class="ruby-identifier">invalid_field_error_status</span>, <span class="ruby-identifier">webauthn_auth_param</span>, <span class="ruby-identifier">webauthn_invalid_sign_count_message</span>) 
<span class="line-num">354</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-has_password-3F'>
<a name='method-i-has_password-3F'></a>
<div class='synopsis'>
<span class='name'>has_password?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-has_password-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-has_password-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">547</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">has_password?</span>
<span class="line-num">548</span>   <span class="ruby-keyword">return</span> <span class="ruby-ivar">@has_password</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@has_password</span>)
<span class="line-num">549</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">account</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">session_value</span>
<span class="line-num">550</span>   <span class="ruby-ivar">@has_password</span> = <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-identifier">get_password_hash</span>
<span class="line-num">551</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-hmac_secret_rotation-3F'>
<a name='method-i-hmac_secret_rotation-3F'></a>
<div class='synopsis'>
<span class='name'>hmac_secret_rotation?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-hmac_secret_rotation-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-hmac_secret_rotation-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">816</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">hmac_secret_rotation?</span>
<span class="line-num">817</span>   <span class="ruby-identifier">hmac_secret</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">hmac_old_secret</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">hmac_secret</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">hmac_old_secret</span>
<span class="line-num">818</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-hook_action'>
<a name='method-i-hook_action'></a>
<div class='synopsis'>
<span class='name'>hook_action</span><span class='arguments'>(hook_type, action)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-hook_action-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-hook_action-source'>   <span class="ruby-comment"># File lib/rodauth/features/audit_logging.rb</span>
<span class="line-num">31</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">hook_action</span>(<span class="ruby-identifier">hook_type</span>, <span class="ruby-identifier">action</span>)
<span class="line-num">32</span>   <span class="ruby-keyword">super</span>
<span class="line-num">33</span>   <span class="ruby-comment"># In after_logout, session is already cleared, so use before_logout in that case</span>
<span class="line-num">34</span>   <span class="ruby-keyword">if</span> (<span class="ruby-identifier">hook_type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:after</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">action</span> <span class="ruby-operator">==</span> <span class="ruby-value">:logout</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">id</span> = <span class="ruby-identifier">account</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">account_id</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">session_value</span>)
<span class="line-num">35</span>     <span class="ruby-identifier">add_audit_log</span>(<span class="ruby-identifier">id</span>, <span class="ruby-identifier">action</span>)
<span class="line-num">36</span>   <span class="ruby-keyword">end</span>
<span class="line-num">37</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-http_basic_auth'>
<a name='method-i-http_basic_auth'></a>
<div class='synopsis'>
<span class='name'>http_basic_auth</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-http_basic_auth-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-http_basic_auth-source'>   <span class="ruby-comment"># File lib/rodauth/features/http_basic_auth.rb</span>
<span class="line-num">34</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">http_basic_auth</span>
<span class="line-num">35</span>   <span class="ruby-keyword">return</span> <span class="ruby-ivar">@checked_http_basic_auth</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@checked_http_basic_auth</span>)
<span class="line-num">36</span> 
<span class="line-num">37</span>   <span class="ruby-ivar">@checked_http_basic_auth</span> = <span class="ruby-keyword">nil</span>
<span class="line-num">38</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">token</span> = ((<span class="ruby-identifier">v</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-string">&#39;HTTP_AUTHORIZATION&#39;</span>]) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span>[<span class="ruby-regexp">/\A *Basic (.*)\Z/</span>, <span class="ruby-value">1</span>])
<span class="line-num">39</span> 
<span class="line-num">40</span>   <span class="ruby-identifier">username</span>, <span class="ruby-identifier">password</span> = <span class="ruby-identifier">token</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-string">&quot;m*&quot;</span>).<span class="ruby-identifier">first</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp">/:/</span>, <span class="ruby-value">2</span>)
<span class="line-num">41</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">username</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">password</span>
<span class="line-num">42</span> 
<span class="line-num">43</span>   <span class="ruby-identifier">catch_error</span> <span class="ruby-keyword">do</span>
<span class="line-num">44</span>     <span class="ruby-keyword">unless</span> <span class="ruby-identifier">account_from_login</span>(<span class="ruby-identifier">username</span>)
<span class="line-num">45</span>       <span class="ruby-identifier">throw_basic_auth_error</span>(<span class="ruby-identifier">login_param</span>, <span class="ruby-identifier">no_matching_login_message</span>)
<span class="line-num">46</span>     <span class="ruby-keyword">end</span>
<span class="line-num">47</span> 
<span class="line-num">48</span>     <span class="ruby-identifier">before_login_attempt</span>
<span class="line-num">49</span> 
<span class="line-num">50</span>     <span class="ruby-keyword">unless</span> <span class="ruby-identifier">open_account?</span>
<span class="line-num">51</span>       <span class="ruby-identifier">throw_basic_auth_error</span>(<span class="ruby-identifier">login_param</span>, <span class="ruby-identifier">no_matching_login_message</span>)
<span class="line-num">52</span>     <span class="ruby-keyword">end</span>
<span class="line-num">53</span> 
<span class="line-num">54</span>     <span class="ruby-keyword">unless</span> <span class="ruby-identifier">password_match?</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">55</span>       <span class="ruby-identifier">after_login_failure</span>
<span class="line-num">56</span>       <span class="ruby-identifier">throw_basic_auth_error</span>(<span class="ruby-identifier">password_param</span>, <span class="ruby-identifier">invalid_password_message</span>)
<span class="line-num">57</span>     <span class="ruby-keyword">end</span>
<span class="line-num">58</span> 
<span class="line-num">59</span>     <span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>
<span class="line-num">60</span>       <span class="ruby-identifier">before_login</span>
<span class="line-num">61</span>       <span class="ruby-identifier">login_session</span>(<span class="ruby-string">&#39;password&#39;</span>)
<span class="line-num">62</span>       <span class="ruby-identifier">after_login</span>
<span class="line-num">63</span>     <span class="ruby-keyword">end</span>
<span class="line-num">64</span> 
<span class="line-num">65</span>     <span class="ruby-ivar">@checked_http_basic_auth</span> = <span class="ruby-keyword">true</span>
<span class="line-num">66</span>     <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
<span class="line-num">67</span>   <span class="ruby-keyword">end</span>
<span class="line-num">68</span> 
<span class="line-num">69</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">70</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-inactive_session_cond'>
<a name='method-i-inactive_session_cond'></a>
<div class='synopsis'>
<span class='name'>inactive_session_cond</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-inactive_session_cond-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-inactive_session_cond-source'>    <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">188</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">inactive_session_cond</span>
<span class="line-num">189</span>   <span class="ruby-identifier">cond</span> = <span class="ruby-identifier">session_inactivity_deadline_condition</span>
<span class="line-num">190</span>   <span class="ruby-identifier">cond2</span> = <span class="ruby-identifier">session_lifetime_deadline_condition</span>
<span class="line-num">191</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">cond</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">cond2</span>
<span class="line-num">192</span>   <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">|</span>(<span class="ruby-operator">*</span>[<span class="ruby-identifier">cond</span>, <span class="ruby-identifier">cond2</span>].<span class="ruby-identifier">compact</span>)
<span class="line-num">193</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-include_success_messages-3F'>
<a name='method-i-include_success_messages-3F'></a>
<div class='synopsis'>
<span class='name'>include_success_messages?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-include_success_messages-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-include_success_messages-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/json.rb</span>
<span class="line-num">216</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">include_success_messages?</span>
<span class="line-num">217</span>   <span class="ruby-operator">!</span><span class="ruby-identifier">json_response_success_key</span>.<span class="ruby-identifier">nil?</span>
<span class="line-num">218</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-input_field_string'>
<a name='method-i-input_field_string'></a>
<div class='synopsis'>
<span class='name'>input_field_string</span><span class='arguments'>(param, id, opts={})</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-input_field_string-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-input_field_string-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">192</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">input_field_string</span>(<span class="ruby-identifier">param</span>, <span class="ruby-identifier">id</span>, <span class="ruby-identifier">opts</span>={})
<span class="line-num">193</span>   <span class="ruby-identifier">type</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:type</span>, <span class="ruby-string">&quot;text&quot;</span>)
<span class="line-num">194</span> 
<span class="line-num">195</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">type</span> <span class="ruby-operator">==</span> <span class="ruby-string">&quot;password&quot;</span>
<span class="line-num">196</span>     <span class="ruby-identifier">value</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:value</span>){<span class="ruby-identifier">scope</span>.<span class="ruby-identifier">h</span> <span class="ruby-identifier">param</span>(<span class="ruby-identifier">param</span>)}
<span class="line-num">197</span>   <span class="ruby-keyword">end</span>
<span class="line-num">198</span> 
<span class="line-num">199</span>   <span class="ruby-identifier">field_class</span> = <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">fetch</span>(<span class="ruby-value">:class</span>, <span class="ruby-string">&quot;form-control&quot;</span>)
<span class="line-num">200</span> 
<span class="line-num">201</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">autocomplete_for_field?</span>(<span class="ruby-identifier">param</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:autocomplete</span>]
<span class="line-num">202</span>     <span class="ruby-identifier">autocomplete</span> = <span class="ruby-node">&quot;autocomplete=\&quot;#{opts[:autocomplete]}\&quot;&quot;</span>
<span class="line-num">203</span>   <span class="ruby-keyword">end</span>
<span class="line-num">204</span> 
<span class="line-num">205</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">inputmode_for_field?</span>(<span class="ruby-identifier">param</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:inputmode</span>]
<span class="line-num">206</span>     <span class="ruby-identifier">inputmode</span> = <span class="ruby-node">&quot;inputmode=\&quot;#{opts[:inputmode]}\&quot;&quot;</span>
<span class="line-num">207</span>   <span class="ruby-keyword">end</span>
<span class="line-num">208</span> 
<span class="line-num">209</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">mark_input_fields_as_required?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:required</span>] <span class="ruby-operator">!=</span> <span class="ruby-keyword">false</span>
<span class="line-num">210</span>     <span class="ruby-identifier">required</span> = <span class="ruby-string">&quot;required=\&quot;required\&quot;&quot;</span>
<span class="line-num">211</span>   <span class="ruby-keyword">end</span>
<span class="line-num">212</span> 
<span class="line-num">213</span>   <span class="ruby-node">&quot;&lt;input #{opts[:attr]} #{autocomplete} #{inputmode} #{required} #{field_attributes(param)} #{field_error_attributes(param)} type=\&quot;#{type}\&quot; class=\&quot;#{field_class}#{add_field_error_class(param)}\&quot; name=\&quot;#{param}\&quot; id=\&quot;#{id}\&quot; value=\&quot;#{value}\&quot;/&gt; #{formatted_field_error(param) unless opts[:skip_error_message]}&quot;</span>
<span class="line-num">214</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-inputmode_for_field-3F'>
<a name='method-i-inputmode_for_field-3F'></a>
<div class='synopsis'>
<span class='name'>inputmode_for_field?</span><span class='arguments'>(_param)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-inputmode_for_field-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-inputmode_for_field-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">220</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">inputmode_for_field?</span>(<span class="ruby-identifier">_param</span>)
<span class="line-num">221</span>   <span class="ruby-identifier">mark_input_fields_with_inputmode?</span>
<span class="line-num">222</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-internal_request-3F'>
<a name='method-i-internal_request-3F'></a>
<div class='synopsis'>
<span class='name'>internal_request?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-internal_request-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-internal_request-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">930</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">internal_request?</span>
<span class="line-num">931</span>   <span class="ruby-keyword">false</span>
<span class="line-num">932</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-internal_request_configuration'>
<a name='method-i-internal_request_configuration'></a>
<div class='synopsis'>
<span class='name'>internal_request_configuration</span><span class='arguments'>(&block)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-internal_request_configuration-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-internal_request_configuration-source'>    <span class="ruby-comment"># File lib/rodauth/features/internal_request.rb</span>
<span class="line-num">373</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">internal_request_configuration</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">374</span>   <span class="ruby-ivar">@auth</span>.<span class="ruby-identifier">instance_exec</span> <span class="ruby-keyword">do</span>
<span class="line-num">375</span>     (<span class="ruby-ivar">@internal_request_configuration_blocks</span> <span class="ruby-operator">||=</span> []) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">block</span>
<span class="line-num">376</span>   <span class="ruby-keyword">end</span>
<span class="line-num">377</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-invalid_login_attempted'>
<a name='method-i-invalid_login_attempted'></a>
<div class='synopsis'>
<span class='name'>invalid_login_attempted</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-invalid_login_attempted-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-invalid_login_attempted-source'>    <span class="ruby-comment"># File lib/rodauth/features/lockout.rb</span>
<span class="line-num">175</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">invalid_login_attempted</span>
<span class="line-num">176</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">account_login_failures_ds</span>.
<span class="line-num">177</span>       <span class="ruby-identifier">where</span>(<span class="ruby-identifier">account_login_failures_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>)
<span class="line-num">178</span> 
<span class="line-num">179</span>   <span class="ruby-identifier">number</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">database_type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:postgres</span>
<span class="line-num">180</span>     <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">returning</span>(<span class="ruby-identifier">account_login_failures_number_column</span>).
<span class="line-num">181</span>       <span class="ruby-identifier">with_sql</span>(<span class="ruby-value">:update_sql</span>, <span class="ruby-identifier">account_login_failures_number_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">expr</span>(<span class="ruby-identifier">account_login_failures_number_column</span>)<span class="ruby-value">+1</span>).
<span class="line-num">182</span>       <span class="ruby-identifier">single_value</span>
<span class="line-num">183</span>   <span class="ruby-keyword">else</span>
<span class="line-num">184</span>     <span class="ruby-comment"># :nocov:</span>
<span class="line-num">185</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">account_login_failures_number_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">expr</span>(<span class="ruby-identifier">account_login_failures_number_column</span>)<span class="ruby-value">+1</span>) <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span>
<span class="line-num">186</span>       <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">account_login_failures_number_column</span>)
<span class="line-num">187</span>     <span class="ruby-keyword">end</span>
<span class="line-num">188</span>     <span class="ruby-comment"># :nocov:</span>
<span class="line-num">189</span>   <span class="ruby-keyword">end</span>
<span class="line-num">190</span> 
<span class="line-num">191</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">number</span>
<span class="line-num">192</span>     <span class="ruby-comment"># Ignoring the violation is safe here.  It may allow slightly more than max_invalid_logins invalid logins before</span>
<span class="line-num">193</span>     <span class="ruby-comment"># lockout, but allowing a few extra is OK if the race is lost.</span>
<span class="line-num">194</span>     <span class="ruby-identifier">ignore_uniqueness_violation</span>{<span class="ruby-identifier">account_login_failures_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">account_login_failures_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>)}
<span class="line-num">195</span>     <span class="ruby-identifier">number</span> = <span class="ruby-value">1</span>
<span class="line-num">196</span>   <span class="ruby-keyword">end</span>
<span class="line-num">197</span> 
<span class="line-num">198</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">number</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">max_invalid_logins</span>
<span class="line-num">199</span>     <span class="ruby-ivar">@unlock_account_key_value</span> = <span class="ruby-identifier">generate_unlock_account_key</span>
<span class="line-num">200</span>     <span class="ruby-identifier">hash</span> = <span class="ruby-identifier">_setup_account_lockouts_hash</span>(<span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">unlock_account_key_value</span>)
<span class="line-num">201</span> 
<span class="line-num">202</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">e</span> = <span class="ruby-identifier">raised_uniqueness_violation</span>{<span class="ruby-identifier">account_lockouts_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">hash</span>)}
<span class="line-num">203</span>       <span class="ruby-comment"># If inserting into the lockout table raises a violation, we should just be able to pull the already inserted</span>
<span class="line-num">204</span>       <span class="ruby-comment"># key out of it.  If that doesn&#39;t return a valid key, we should reraise the error.</span>
<span class="line-num">205</span>       <span class="ruby-identifier">raise</span> <span class="ruby-identifier">e</span> <span class="ruby-keyword">unless</span> <span class="ruby-ivar">@unlock_account_key_value</span> = <span class="ruby-identifier">account_lockouts_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">account_lockouts_key_column</span>)
<span class="line-num">206</span> 
<span class="line-num">207</span>       <span class="ruby-identifier">after_account_lockout</span>
<span class="line-num">208</span>       <span class="ruby-identifier">show_lockout_page</span>
<span class="line-num">209</span>     <span class="ruby-keyword">else</span>
<span class="line-num">210</span>       <span class="ruby-identifier">after_account_lockout</span>
<span class="line-num">211</span>       <span class="ruby-identifier">e</span>
<span class="line-num">212</span>     <span class="ruby-keyword">end</span>
<span class="line-num">213</span>   <span class="ruby-keyword">end</span>
<span class="line-num">214</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-invalid_previous_password_message'>
<a name='method-i-invalid_previous_password_message'></a>
<div class='synopsis'>
<span class='name'>invalid_previous_password_message</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-invalid_previous_password_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-invalid_previous_password_message-source'>   <span class="ruby-comment"># File lib/rodauth/features/change_password.rb</span>
<span class="line-num">72</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">invalid_previous_password_message</span>
<span class="line-num">73</span>   <span class="ruby-identifier">invalid_password_message</span>
<span class="line-num">74</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-json_request-3F'>
<a name='method-i-json_request-3F'></a>
<div class='synopsis'>
<span class='name'>json_request?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-json_request-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-json_request-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/json.rb</span>
<span class="line-num">55</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">json_request?</span>
<span class="line-num">56</span>   <span class="ruby-keyword">return</span> <span class="ruby-ivar">@json_request</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@json_request</span>)
<span class="line-num">57</span>   <span class="ruby-ivar">@json_request</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">content_type</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">json_request_content_type_regexp</span>
<span class="line-num">58</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-json_response'>
<a name='method-i-json_response'></a>
<div class='synopsis'>
<span class='name'>json_response</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-json_response-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-json_response-source'>    <span class="ruby-comment"># File lib/rodauth/features/json.rb</span>
<span class="line-num">224</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">json_response</span>
<span class="line-num">225</span>   <span class="ruby-ivar">@json_response</span> <span class="ruby-operator">||=</span> {}
<span class="line-num">226</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-json_response_error-3F'>
<a name='method-i-json_response_error-3F'></a>
<div class='synopsis'>
<span class='name'>json_response_error?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-json_response_error-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-json_response_error-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/json.rb</span>
<span class="line-num">69</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">json_response_error?</span>
<span class="line-num">70</span>   <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-identifier">json_response</span>[<span class="ruby-identifier">json_response_error_key</span>]
<span class="line-num">71</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-jwt_cors_allow-3F'>
<a name='method-i-jwt_cors_allow-3F'></a>
<div class='synopsis'>
<span class='name'>jwt_cors_allow?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-jwt_cors_allow-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-jwt_cors_allow-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/jwt_cors.rb</span>
<span class="line-num">15</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">jwt_cors_allow?</span>
<span class="line-num">16</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">origin</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-string">&#39;HTTP_ORIGIN&#39;</span>]
<span class="line-num">17</span> 
<span class="line-num">18</span>   <span class="ruby-keyword">case</span> <span class="ruby-identifier">allowed</span> = <span class="ruby-identifier">jwt_cors_allow_origin</span>
<span class="line-num">19</span>   <span class="ruby-keyword">when</span> <span class="ruby-constant">String</span>
<span class="line-num">20</span>     <span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">origin</span>, <span class="ruby-identifier">allowed</span>)
<span class="line-num">21</span>   <span class="ruby-keyword">when</span> <span class="ruby-constant">Array</span>
<span class="line-num">22</span>     <span class="ruby-identifier">allowed</span>.<span class="ruby-identifier">any?</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span> <span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">origin</span>, <span class="ruby-identifier">s</span>)}
<span class="line-num">23</span>   <span class="ruby-keyword">when</span> <span class="ruby-constant">Regexp</span>
<span class="line-num">24</span>     <span class="ruby-identifier">allowed</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">origin</span>
<span class="line-num">25</span>   <span class="ruby-keyword">when</span> <span class="ruby-keyword">true</span>
<span class="line-num">26</span>     <span class="ruby-keyword">true</span>
<span class="line-num">27</span>   <span class="ruby-keyword">else</span>
<span class="line-num">28</span>     <span class="ruby-keyword">false</span>
<span class="line-num">29</span>   <span class="ruby-keyword">end</span>
<span class="line-num">30</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-jwt_payload'>
<a name='method-i-jwt_payload'></a>
<div class='synopsis'>
<span class='name'>jwt_payload</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-jwt_payload-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-jwt_payload-source'>    <span class="ruby-comment"># File lib/rodauth/features/jwt.rb</span>
<span class="line-num">122</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">jwt_payload</span>
<span class="line-num">123</span>   <span class="ruby-keyword">return</span> <span class="ruby-ivar">@jwt_payload</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@jwt_payload</span>)
<span class="line-num">124</span>   <span class="ruby-ivar">@jwt_payload</span> = <span class="ruby-constant">JWT</span>.<span class="ruby-identifier">decode</span>(<span class="ruby-identifier">jwt_token</span>, <span class="ruby-identifier">_jwt_decode_secrets</span>, <span class="ruby-keyword">true</span>, <span class="ruby-identifier">_jwt_decode_opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-value">:algorithm</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">jwt_algorithm</span>))[<span class="ruby-value">0</span>]
<span class="line-num">125</span> <span class="ruby-keyword">rescue</span> <span class="ruby-constant">JWT</span><span class="ruby-operator">::</span><span class="ruby-constant">DecodeError</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">e</span>
<span class="line-num">126</span>   <span class="ruby-identifier">rescue_jwt_payload</span>(<span class="ruby-identifier">e</span>)
<span class="line-num">127</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-jwt_refresh_token_account_ds'>
<a name='method-i-jwt_refresh_token_account_ds'></a>
<div class='synopsis'>
<span class='name'>jwt_refresh_token_account_ds</span><span class='arguments'>(account_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-jwt_refresh_token_account_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-jwt_refresh_token_account_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/jwt_refresh.rb</span>
<span class="line-num">167</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">jwt_refresh_token_account_ds</span>(<span class="ruby-identifier">account_id</span>)
<span class="line-num">168</span>   <span class="ruby-identifier">jwt_refresh_token_ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">jwt_refresh_token_account_id_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">account_id</span>)
<span class="line-num">169</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-jwt_refresh_token_account_token_ds'>
<a name='method-i-jwt_refresh_token_account_token_ds'></a>
<div class='synopsis'>
<span class='name'>jwt_refresh_token_account_token_ds</span><span class='arguments'>(account_id, token_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-jwt_refresh_token_account_token_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-jwt_refresh_token_account_token_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/jwt_refresh.rb</span>
<span class="line-num">171</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">jwt_refresh_token_account_token_ds</span>(<span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">token_id</span>)
<span class="line-num">172</span>   <span class="ruby-identifier">jwt_refresh_token_account_ds</span>(<span class="ruby-identifier">account_id</span>).
<span class="line-num">173</span>     <span class="ruby-identifier">where</span>(<span class="ruby-identifier">jwt_refresh_token_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">token_id</span>)
<span class="line-num">174</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-jwt_refresh_token_ds'>
<a name='method-i-jwt_refresh_token_ds'></a>
<div class='synopsis'>
<span class='name'>jwt_refresh_token_ds</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-jwt_refresh_token_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-jwt_refresh_token_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/jwt_refresh.rb</span>
<span class="line-num">176</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">jwt_refresh_token_ds</span>
<span class="line-num">177</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">jwt_refresh_token_table</span>]
<span class="line-num">178</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-jwt_refresh_token_insert_hash'>
<a name='method-i-jwt_refresh_token_insert_hash'></a>
<div class='synopsis'>
<span class='name'>jwt_refresh_token_insert_hash</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-jwt_refresh_token_insert_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-jwt_refresh_token_insert_hash-source'>    <span class="ruby-comment"># File lib/rodauth/features/jwt_refresh.rb</span>
<span class="line-num">190</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">jwt_refresh_token_insert_hash</span>
<span class="line-num">191</span>   <span class="ruby-identifier">hash</span> = {<span class="ruby-identifier">jwt_refresh_token_account_id_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">jwt_refresh_token_key_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">random_key</span>}
<span class="line-num">192</span>   <span class="ruby-identifier">set_deadline_value</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">jwt_refresh_token_deadline_column</span>, <span class="ruby-identifier">jwt_refresh_token_deadline_interval</span>)
<span class="line-num">193</span>   <span class="ruby-identifier">hash</span>
<span class="line-num">194</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-jwt_refresh_token_match-3F'>
<a name='method-i-jwt_refresh_token_match-3F'></a>
<div class='synopsis'>
<span class='name'>jwt_refresh_token_match?</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-jwt_refresh_token_match-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-jwt_refresh_token_match-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/jwt_refresh.rb</span>
<span class="line-num">147</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">jwt_refresh_token_match?</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">148</span>   <span class="ruby-comment"># We don&#39;t need to match tokens if we are requiring a valid current access token</span>
<span class="line-num">149</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">allow_refresh_with_expired_jwt_access_token?</span>
<span class="line-num">150</span> 
<span class="line-num">151</span>   <span class="ruby-comment"># If allowing with expired jwt access token, check the expired session contains</span>
<span class="line-num">152</span>   <span class="ruby-comment"># hmac matching submitted and active refresh token.</span>
<span class="line-num">153</span>   <span class="ruby-identifier">s</span> = <span class="ruby-identifier">session</span>[<span class="ruby-identifier">jwt_refresh_token_hmac_session_key</span>].<span class="ruby-identifier">to_s</span>
<span class="line-num">154</span>   <span class="ruby-identifier">h</span> = <span class="ruby-identifier">session</span>[<span class="ruby-identifier">jwt_refresh_token_data_session_key</span>].<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">key</span>
<span class="line-num">155</span>   <span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">compute_hmac</span>(<span class="ruby-identifier">h</span>), <span class="ruby-identifier">s</span>) <span class="ruby-operator">||</span> (<span class="ruby-identifier">hmac_secret_rotation?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">compute_old_hmac</span>(<span class="ruby-identifier">h</span>), <span class="ruby-identifier">s</span>))
<span class="line-num">156</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-jwt_secret'>
<a name='method-i-jwt_secret'></a>
<div class='synopsis'>
<span class='name'>jwt_secret</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-jwt_secret-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-jwt_secret-source'>   <span class="ruby-comment"># File lib/rodauth/features/jwt.rb</span>
<span class="line-num">66</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">jwt_secret</span>
<span class="line-num">67</span>   <span class="ruby-identifier">raise</span> <span class="ruby-constant">ConfigurationError</span>, <span class="ruby-string">&quot;jwt_secret not set&quot;</span>
<span class="line-num">68</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-jwt_session_hash'>
<a name='method-i-jwt_session_hash'></a>
<div class='synopsis'>
<span class='name'>jwt_session_hash</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-jwt_session_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-jwt_session_hash-source'>   <span class="ruby-comment"># File lib/rodauth/features/jwt.rb</span>
<span class="line-num">70</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">jwt_session_hash</span>
<span class="line-num">71</span>   <span class="ruby-identifier">jwt_session_key</span> <span class="ruby-operator">?</span> {<span class="ruby-identifier">jwt_session_key</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session</span>} <span class="ruby-operator">:</span> <span class="ruby-identifier">session</span>
<span class="line-num">72</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-jwt_token'>
<a name='method-i-jwt_token'></a>
<div class='synopsis'>
<span class='name'>jwt_token</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-jwt_token-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-jwt_token-source'>   <span class="ruby-comment"># File lib/rodauth/features/jwt.rb</span>
<span class="line-num">78</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">jwt_token</span>
<span class="line-num">79</span>   <span class="ruby-keyword">return</span> <span class="ruby-ivar">@jwt_token</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-ivar">@jwt_token</span>)
<span class="line-num">80</span> 
<span class="line-num">81</span>   <span class="ruby-keyword">if</span> (<span class="ruby-identifier">v</span> = <span class="ruby-identifier">request</span>.<span class="ruby-identifier">env</span>[<span class="ruby-string">&#39;HTTP_AUTHORIZATION&#39;</span>]) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">!~</span> <span class="ruby-identifier">jwt_authorization_ignore</span>
<span class="line-num">82</span>     <span class="ruby-ivar">@jwt_token</span> = <span class="ruby-identifier">v</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-identifier">jwt_authorization_remove</span>, <span class="ruby-string">&#39;&#39;</span>)
<span class="line-num">83</span>   <span class="ruby-keyword">end</span>
<span class="line-num">84</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-last_account_activity_at'>
<a name='method-i-last_account_activity_at'></a>
<div class='synopsis'>
<span class='name'>last_account_activity_at</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-last_account_activity_at-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-last_account_activity_at-source'>   <span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb</span>
<span class="line-num">27</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">last_account_activity_at</span>
<span class="line-num">28</span>   <span class="ruby-identifier">get_activity_timestamp</span>(<span class="ruby-identifier">session_value</span>, <span class="ruby-identifier">account_activity_last_activity_column</span>)
<span class="line-num">29</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-last_account_login_at'>
<a name='method-i-last_account_login_at'></a>
<div class='synopsis'>
<span class='name'>last_account_login_at</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-last_account_login_at-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-last_account_login_at-source'>   <span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb</span>
<span class="line-num">31</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">last_account_login_at</span>
<span class="line-num">32</span>   <span class="ruby-identifier">get_activity_timestamp</span>(<span class="ruby-identifier">session_value</span>, <span class="ruby-identifier">account_activity_last_login_column</span>)
<span class="line-num">33</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-load_memory'>
<a name='method-i-load_memory'></a>
<div class='synopsis'>
<span class='name'>load_memory</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-load_memory-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-load_memory-source'>    <span class="ruby-comment"># File lib/rodauth/features/remember.rb</span>
<span class="line-num">114</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">load_memory</span>
<span class="line-num">115</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">logged_in?</span>
<span class="line-num">116</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">extend_remember_deadline_while_logged_in?</span>
<span class="line-num">117</span>       <span class="ruby-keyword">if</span> <span class="ruby-identifier">account_from_session</span>
<span class="line-num">118</span>         <span class="ruby-identifier">extend_remember_deadline</span>
<span class="line-num">119</span>       <span class="ruby-keyword">else</span>
<span class="line-num">120</span>         <span class="ruby-identifier">forget_login</span>
<span class="line-num">121</span>         <span class="ruby-identifier">clear_session</span>
<span class="line-num">122</span>       <span class="ruby-keyword">end</span>
<span class="line-num">123</span>     <span class="ruby-keyword">end</span>
<span class="line-num">124</span>   <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">account_from_remember_cookie</span>
<span class="line-num">125</span>     <span class="ruby-identifier">before_load_memory</span>
<span class="line-num">126</span>     <span class="ruby-identifier">login_session</span>(<span class="ruby-string">&#39;remember&#39;</span>)
<span class="line-num">127</span>     <span class="ruby-identifier">extend_remember_deadline</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">extend_remember_deadline?</span>
<span class="line-num">128</span>     <span class="ruby-identifier">after_load_memory</span>
<span class="line-num">129</span>   <span class="ruby-keyword">end</span>
<span class="line-num">130</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-loaded_templates'>
<a name='method-i-loaded_templates'></a>
<div class='synopsis'>
<span class='name'>loaded_templates</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-loaded_templates-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-loaded_templates-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">870</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">loaded_templates</span>
<span class="line-num">871</span>   []
<span class="line-num">872</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-locked_out-3F'>
<a name='method-i-locked_out-3F'></a>
<div class='synopsis'>
<span class='name'>locked_out?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-locked_out-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-locked_out-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/lockout.rb</span>
<span class="line-num">146</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">locked_out?</span>
<span class="line-num">147</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">t</span> = <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">account_lockouts_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">account_lockouts_deadline_column</span>))
<span class="line-num">148</span>     <span class="ruby-keyword">if</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">t</span>
<span class="line-num">149</span>       <span class="ruby-keyword">true</span>
<span class="line-num">150</span>     <span class="ruby-keyword">else</span>
<span class="line-num">151</span>       <span class="ruby-identifier">unlock_account</span>
<span class="line-num">152</span>       <span class="ruby-keyword">false</span>
<span class="line-num">153</span>     <span class="ruby-keyword">end</span>
<span class="line-num">154</span>   <span class="ruby-keyword">else</span>
<span class="line-num">155</span>     <span class="ruby-keyword">false</span>
<span class="line-num">156</span>   <span class="ruby-keyword">end</span>
<span class="line-num">157</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-logged_in_via_remember_key-3F'>
<a name='method-i-logged_in_via_remember_key-3F'></a>
<div class='synopsis'>
<span class='name'>logged_in_via_remember_key?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-logged_in_via_remember_key-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-logged_in_via_remember_key-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/remember.rb</span>
<span class="line-num">174</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">logged_in_via_remember_key?</span>
<span class="line-num">175</span>   <span class="ruby-identifier">authenticated_by</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">&#39;remember&#39;</span>)
<span class="line-num">176</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login'>
<a name='method-i-login'></a>
<div class='synopsis'>
<span class='name'>login</span><span class='arguments'>(auth_type)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login-source'>   <span class="ruby-comment"># File lib/rodauth/features/login.rb</span>
<span class="line-num">87</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login</span>(<span class="ruby-identifier">auth_type</span>)
<span class="line-num">88</span>   <span class="ruby-ivar">@saved_login_redirect</span> = <span class="ruby-identifier">remove_session_value</span>(<span class="ruby-identifier">login_redirect_session_key</span>)
<span class="line-num">89</span>   <span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>
<span class="line-num">90</span>     <span class="ruby-identifier">before_login</span>
<span class="line-num">91</span>     <span class="ruby-identifier">login_session</span>(<span class="ruby-identifier">auth_type</span>)
<span class="line-num">92</span>     <span class="ruby-keyword">yield</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">block_given?</span>
<span class="line-num">93</span>     <span class="ruby-identifier">after_login</span>
<span class="line-num">94</span>   <span class="ruby-keyword">end</span>
<span class="line-num">95</span>   <span class="ruby-identifier">require_response</span>(<span class="ruby-value">:_login_response</span>)
<span class="line-num">96</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_confirm_label'>
<a name='method-i-login_confirm_label'></a>
<div class='synopsis'>
<span class='name'>login_confirm_label</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_confirm_label-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_confirm_label-source'>   <span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb</span>
<span class="line-num">47</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_confirm_label</span>
<span class="line-num">48</span>   <span class="ruby-node">&quot;Confirm #{login_label}&quot;</span>
<span class="line-num">49</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_confirmation_matches-3F'>
<a name='method-i-login_confirmation_matches-3F'></a>
<div class='synopsis'>
<span class='name'>login_confirmation_matches?</span><span class='arguments'>(login, login_confirmation)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_confirmation_matches-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_confirmation_matches-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb</span>
<span class="line-num">131</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_confirmation_matches?</span>(<span class="ruby-identifier">login</span>, <span class="ruby-identifier">login_confirmation</span>)
<span class="line-num">132</span>   <span class="ruby-identifier">login</span>.<span class="ruby-identifier">casecmp?</span>(<span class="ruby-identifier">login_confirmation</span>)
<span class="line-num">133</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_does_not_meet_requirements_message'>
<a name='method-i-login_does_not_meet_requirements_message'></a>
<div class='synopsis'>
<span class='name'>login_does_not_meet_requirements_message</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_does_not_meet_requirements_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_does_not_meet_requirements_message-source'>    <span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb</span>
<span class="line-num">109</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_does_not_meet_requirements_message</span>
<span class="line-num">110</span>   <span class="ruby-node">&quot;invalid login#{&quot;, #{login_requirement_message}&quot; if login_requirement_message}&quot;</span>
<span class="line-num">111</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_failed_reset_password_request_form'>
<a name='method-i-login_failed_reset_password_request_form'></a>
<div class='synopsis'>
<span class='name'>login_failed_reset_password_request_form</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_failed_reset_password_request_form-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_failed_reset_password_request_form-source'>    <span class="ruby-comment"># File lib/rodauth/features/reset_password.rb</span>
<span class="line-num">238</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_failed_reset_password_request_form</span>
<span class="line-num">239</span>   <span class="ruby-identifier">render</span>(<span class="ruby-string">&quot;reset-password-request&quot;</span>)
<span class="line-num">240</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_field_autocomplete_value'>
<a name='method-i-login_field_autocomplete_value'></a>
<div class='synopsis'>
<span class='name'>login_field_autocomplete_value</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_field_autocomplete_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_field_autocomplete_value-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">293</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_field_autocomplete_value</span>
<span class="line-num">294</span>   <span class="ruby-identifier">login_uses_email?</span> <span class="ruby-operator">?</span> <span class="ruby-string">&quot;email&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-string">&quot;on&quot;</span>
<span class="line-num">295</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_form_footer_links'>
<a name='method-i-login_form_footer_links'></a>
<div class='synopsis'>
<span class='name'>login_form_footer_links</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_form_footer_links-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_form_footer_links-source'>    <span class="ruby-comment"># File lib/rodauth/features/login.rb</span>
<span class="line-num">134</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_form_footer_links</span>
<span class="line-num">135</span>   <span class="ruby-ivar">@login_form_footer_links</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">_filter_links</span>(<span class="ruby-identifier">_login_form_footer_links</span>)
<span class="line-num">136</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_hidden_field'>
<a name='method-i-login_hidden_field'></a>
<div class='synopsis'>
<span class='name'>login_hidden_field</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_hidden_field-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_hidden_field-source'>    <span class="ruby-comment"># File lib/rodauth/features/login.rb</span>
<span class="line-num">130</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_hidden_field</span>
<span class="line-num">131</span>   <span class="ruby-node">&quot;&lt;input type=&#39;hidden&#39; name=\&quot;#{login_param}\&quot; value=\&quot;#{scope.h param(login_param)}\&quot; /&gt;&quot;</span>
<span class="line-num">132</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_input_type'>
<a name='method-i-login_input_type'></a>
<div class='synopsis'>
<span class='name'>login_input_type</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_input_type-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_input_type-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">317</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_input_type</span>
<span class="line-num">318</span>   <span class="ruby-identifier">login_uses_email?</span> <span class="ruby-operator">?</span> <span class="ruby-string">&#39;email&#39;</span> <span class="ruby-operator">:</span> <span class="ruby-string">&#39;text&#39;</span>
<span class="line-num">319</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_meets_email_requirements-3F'>
<a name='method-i-login_meets_email_requirements-3F'></a>
<div class='synopsis'>
<span class='name'>login_meets_email_requirements?</span><span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_meets_email_requirements-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_meets_email_requirements-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb</span>
<span class="line-num">157</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_meets_email_requirements?</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">158</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">require_email_address_logins?</span>
<span class="line-num">159</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">login_valid_email?</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">160</span>   <span class="ruby-identifier">set_login_requirement_error_message</span>(<span class="ruby-value">:login_not_valid_email</span>, <span class="ruby-identifier">login_not_valid_email_message</span>)
<span class="line-num">161</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span>
<span class="line-num">162</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_meets_length_requirements-3F'>
<a name='method-i-login_meets_length_requirements-3F'></a>
<div class='synopsis'>
<span class='name'>login_meets_length_requirements?</span><span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_meets_length_requirements-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_meets_length_requirements-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb</span>
<span class="line-num">142</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_meets_length_requirements?</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">143</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">login_minimum_length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">login</span>.<span class="ruby-identifier">length</span>
<span class="line-num">144</span>     <span class="ruby-identifier">set_login_requirement_error_message</span>(<span class="ruby-value">:login_too_short</span>, <span class="ruby-identifier">login_too_short_message</span>)
<span class="line-num">145</span>     <span class="ruby-keyword">false</span>
<span class="line-num">146</span>   <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">login_maximum_length</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">login</span>.<span class="ruby-identifier">length</span>
<span class="line-num">147</span>     <span class="ruby-identifier">set_login_requirement_error_message</span>(<span class="ruby-value">:login_too_long</span>, <span class="ruby-identifier">login_too_long_message</span>)
<span class="line-num">148</span>     <span class="ruby-keyword">false</span>
<span class="line-num">149</span>   <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">login_maximum_bytes</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">login</span>.<span class="ruby-identifier">bytesize</span>
<span class="line-num">150</span>     <span class="ruby-identifier">set_login_requirement_error_message</span>(<span class="ruby-value">:login_too_many_bytes</span>, <span class="ruby-identifier">login_too_many_bytes_message</span>)
<span class="line-num">151</span>     <span class="ruby-keyword">false</span>
<span class="line-num">152</span>   <span class="ruby-keyword">else</span>
<span class="line-num">153</span>     <span class="ruby-keyword">true</span>
<span class="line-num">154</span>   <span class="ruby-keyword">end</span>
<span class="line-num">155</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_meets_requirements-3F'>
<a name='method-i-login_meets_requirements-3F'></a>
<div class='synopsis'>
<span class='name'>login_meets_requirements?</span><span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_meets_requirements-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_meets_requirements-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb</span>
<span class="line-num">55</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_meets_requirements?</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">56</span>   <span class="ruby-identifier">login_meets_length_requirements?</span>(<span class="ruby-identifier">login</span>) <span class="ruby-operator">&amp;&amp;</span> \
<span class="line-num">57</span>     <span class="ruby-identifier">login_meets_email_requirements?</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">58</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_param_value'>
<a name='method-i-login_param_value'></a>
<div class='synopsis'>
<span class='name'>login_param_value</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>The normalized value of the login parameter</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_param_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_param_value-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">512</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_param_value</span>
<span class="line-num">513</span>   <span class="ruby-identifier">normalize_login</span>(<span class="ruby-identifier">param</span>(<span class="ruby-identifier">login_param</span>))
<span class="line-num">514</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_required'>
<a name='method-i-login_required'></a>
<div class='synopsis'>
<span class='name'>login_required</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_required-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_required-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">333</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_required</span>
<span class="line-num">334</span>   <span class="ruby-identifier">set_redirect_error_status</span>(<span class="ruby-identifier">login_required_error_status</span>)
<span class="line-num">335</span>   <span class="ruby-identifier">set_error_reason</span> <span class="ruby-value">:login_required</span>
<span class="line-num">336</span>   <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">require_login_error_flash</span>
<span class="line-num">337</span>   <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">require_login_redirect</span>
<span class="line-num">338</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_return_to_requested_location_path'>
<a name='method-i-login_return_to_requested_location_path'></a>
<div class='synopsis'>
<span class='name'>login_return_to_requested_location_path</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_return_to_requested_location_path-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_return_to_requested_location_path-source'>    <span class="ruby-comment"># File lib/rodauth/features/login.rb</span>
<span class="line-num">105</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_return_to_requested_location_path</span>
<span class="line-num">106</span>   <span class="ruby-identifier">request</span>.<span class="ruby-identifier">fullpath</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">get?</span>
<span class="line-num">107</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_session'>
<a name='method-i-login_session'></a>
<div class='synopsis'>
<span class='name'>login_session</span><span class='arguments'>(auth_type)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_session-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">474</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_session</span>(<span class="ruby-identifier">auth_type</span>)
<span class="line-num">475</span>   <span class="ruby-identifier">update_session</span>
<span class="line-num">476</span>   <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">authenticated_by_session_key</span>, [<span class="ruby-identifier">auth_type</span>])
<span class="line-num">477</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_too_long_message'>
<a name='method-i-login_too_long_message'></a>
<div class='synopsis'>
<span class='name'>login_too_long_message</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_too_long_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_too_long_message-source'>    <span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb</span>
<span class="line-num">113</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_too_long_message</span>
<span class="line-num">114</span>   <span class="ruby-node">&quot;maximum #{login_maximum_length} characters&quot;</span>
<span class="line-num">115</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_too_many_bytes_message'>
<a name='method-i-login_too_many_bytes_message'></a>
<div class='synopsis'>
<span class='name'>login_too_many_bytes_message</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_too_many_bytes_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_too_many_bytes_message-source'>    <span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb</span>
<span class="line-num">117</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_too_many_bytes_message</span>
<span class="line-num">118</span>   <span class="ruby-node">&quot;maximum #{login_maximum_bytes} bytes&quot;</span>
<span class="line-num">119</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_too_short_message'>
<a name='method-i-login_too_short_message'></a>
<div class='synopsis'>
<span class='name'>login_too_short_message</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_too_short_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_too_short_message-source'>    <span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb</span>
<span class="line-num">121</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_too_short_message</span>
<span class="line-num">122</span>   <span class="ruby-node">&quot;minimum #{login_minimum_length} characters&quot;</span>
<span class="line-num">123</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_uses_email-3F'>
<a name='method-i-login_uses_email-3F'></a>
<div class='synopsis'>
<span class='name'>login_uses_email?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_uses_email-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_uses_email-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">321</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_uses_email?</span>
<span class="line-num">322</span>   <span class="ruby-identifier">login_column</span> <span class="ruby-operator">==</span> <span class="ruby-value">:email</span>
<span class="line-num">323</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-login_valid_email-3F'>
<a name='method-i-login_valid_email-3F'></a>
<div class='synopsis'>
<span class='name'>login_valid_email?</span><span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-login_valid_email-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-login_valid_email-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb</span>
<span class="line-num">164</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">login_valid_email?</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">165</span>   <span class="ruby-identifier">login</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">login_email_regexp</span>
<span class="line-num">166</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-logout'>
<a name='method-i-logout'></a>
<div class='synopsis'>
<span class='name'>logout</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-logout-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-logout-source'>   <span class="ruby-comment"># File lib/rodauth/features/logout.rb</span>
<span class="line-num">34</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">logout</span>
<span class="line-num">35</span>   <span class="ruby-identifier">clear_session</span>
<span class="line-num">36</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-logout_additional_form_tags'>
<a name='method-i-logout_additional_form_tags'></a>
<div class='synopsis'>
<span class='name'>logout_additional_form_tags</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-logout_additional_form_tags-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-logout_additional_form_tags-source'>    <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">118</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">logout_additional_form_tags</span>
<span class="line-num">119</span>   <span class="ruby-keyword">super</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">render</span>(<span class="ruby-string">&#39;global-logout-field&#39;</span>)
<span class="line-num">120</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-modifications_require_password-3F'>
<a name='method-i-modifications_require_password-3F'></a>
<div class='synopsis'>
<span class='name'>modifications_require_password?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-modifications_require_password-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-modifications_require_password-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">539</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">modifications_require_password?</span>
<span class="line-num">540</span>   <span class="ruby-identifier">has_password?</span>
<span class="line-num">541</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-new_account'>
<a name='method-i-new_account'></a>
<div class='synopsis'>
<span class='name'>new_account</span><span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-new_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-new_account-source'>   <span class="ruby-comment"># File lib/rodauth/features/create_account.rb</span>
<span class="line-num">96</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">new_account</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">97</span>   <span class="ruby-ivar">@account</span> = <span class="ruby-identifier">_new_account</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">98</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-new_recovery_code'>
<a name='method-i-new_recovery_code'></a>
<div class='synopsis'>
<span class='name'>new_recovery_code</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-new_recovery_code-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-new_recovery_code-source'>    <span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb</span>
<span class="line-num">240</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">new_recovery_code</span>
<span class="line-num">241</span>   <span class="ruby-identifier">random_key</span>
<span class="line-num">242</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-new_webauthn_credential'>
<a name='method-i-new_webauthn_credential'></a>
<div class='synopsis'>
<span class='name'>new_webauthn_credential</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-new_webauthn_credential-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-new_webauthn_credential-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">302</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">new_webauthn_credential</span>
<span class="line-num">303</span>   <span class="ruby-constant">WebAuthn</span><span class="ruby-operator">::</span><span class="ruby-constant">Credential</span>.<span class="ruby-identifier">options_for_create</span>(
<span class="line-num">304</span>     <span class="ruby-value">:timeout</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">webauthn_setup_timeout</span>,
<span class="line-num">305</span>     <span class="ruby-value">:user</span> <span class="ruby-operator">=&gt;</span> {<span class="ruby-value">:id</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_webauthn_user_id</span>, <span class="ruby-value">:name</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">webauthn_user_name</span>},
<span class="line-num">306</span>     <span class="ruby-value">:authenticator_selection</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">webauthn_authenticator_selection</span>,
<span class="line-num">307</span>     <span class="ruby-value">:attestation</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">webauthn_attestation</span>,
<span class="line-num">308</span>     <span class="ruby-value">:extensions</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">webauthn_extensions</span>,
<span class="line-num">309</span>     <span class="ruby-value">:exclude</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">account_webauthn_ids</span>,
<span class="line-num">310</span>     <span class="ruby-operator">**</span><span class="ruby-identifier">webauthn_create_relying_party_opts</span>
<span class="line-num">311</span>   )
<span class="line-num">312</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-no_longer_active_session'>
<a name='method-i-no_longer_active_session'></a>
<div class='synopsis'>
<span class='name'>no_longer_active_session</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-no_longer_active_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-no_longer_active_session-source'>   <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">60</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">no_longer_active_session</span>
<span class="line-num">61</span>   <span class="ruby-identifier">clear_session</span>
<span class="line-num">62</span>   <span class="ruby-identifier">set_redirect_error_status</span> <span class="ruby-identifier">inactive_session_error_status</span>
<span class="line-num">63</span>   <span class="ruby-identifier">set_error_reason</span> <span class="ruby-value">:inactive_session</span>
<span class="line-num">64</span>   <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">active_sessions_error_flash</span>
<span class="line-num">65</span>   <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">active_sessions_redirect</span>
<span class="line-num">66</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-normalize_login'>
<a name='method-i-normalize_login'></a>
<div class='synopsis'>
<span class='name'>normalize_login</span><span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-normalize_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-normalize_login-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">516</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">normalize_login</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">517</span>   <span class="ruby-identifier">login</span>
<span class="line-num">518</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-normalize_session_or_flash_key'>
<a name='method-i-normalize_session_or_flash_key'></a>
<div class='synopsis'>
<span class='name'>normalize_session_or_flash_key</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-normalize_session_or_flash_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-normalize_session_or_flash_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">687</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">normalize_session_or_flash_key</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">688</span>   <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:sessions_convert_symbols</span>] <span class="ruby-operator">?</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">key</span>
<span class="line-num">689</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-null_byte_parameter_value'>
<a name='method-i-null_byte_parameter_value'></a>
<div class='synopsis'>
<span class='name'>null_byte_parameter_value</span><span class='arguments'>(key, value)</span>

</div>
<div class='description'>

<p>Return nil by default for values with null bytes</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-null_byte_parameter_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-null_byte_parameter_value-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">521</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">null_byte_parameter_value</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)
<span class="line-num">522</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">523</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-only_json-3F'>
<a name='method-i-only_json-3F'></a>
<div class='synopsis'>
<span class='name'>only_json?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-only_json-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-only_json-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">433</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">only_json?</span>
<span class="line-num">434</span>   <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauth_json</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:only</span>
<span class="line-num">435</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-open_account-3F'>
<a name='method-i-open_account-3F'></a>
<div class='synopsis'>
<span class='name'>open_account?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-open_account-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-open_account-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">285</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">open_account?</span>
<span class="line-num">286</span>   <span class="ruby-identifier">skip_status_checks?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">account</span>[<span class="ruby-identifier">account_status_column</span>] <span class="ruby-operator">==</span> <span class="ruby-identifier">account_open_status_value</span> 
<span class="line-num">287</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_add_key'>
<a name='method-i-otp_add_key'></a>
<div class='synopsis'>
<span class='name'>otp_add_key</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_add_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_add_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">283</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_add_key</span>
<span class="line-num">284</span>   <span class="ruby-identifier">_otp_add_key</span>(<span class="ruby-identifier">otp_key</span>)
<span class="line-num">285</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">286</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_available-3F'>
<a name='method-i-otp_available-3F'></a>
<div class='synopsis'>
<span class='name'>otp_available?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_available-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_available-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">243</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_available?</span>
<span class="line-num">244</span>   <span class="ruby-identifier">otp_exists?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">otp_locked_out?</span>
<span class="line-num">245</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_exists-3F'>
<a name='method-i-otp_exists-3F'></a>
<div class='synopsis'>
<span class='name'>otp_exists?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_exists-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_exists-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">247</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_exists?</span>
<span class="line-num">248</span>   <span class="ruby-operator">!</span><span class="ruby-identifier">otp_key</span>.<span class="ruby-identifier">nil?</span>
<span class="line-num">249</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_hmac_old_secret'>
<a name='method-i-otp_hmac_old_secret'></a>
<div class='synopsis'>
<span class='name'>otp_hmac_old_secret</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_hmac_old_secret-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_hmac_old_secret-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">383</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_hmac_old_secret</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">384</span>   <span class="ruby-identifier">base32_encode</span>(<span class="ruby-identifier">compute_raw_hmac_with_secret</span>(<span class="ruby-constant">ROTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Base32</span>.<span class="ruby-identifier">decode</span>(<span class="ruby-identifier">key</span>), <span class="ruby-identifier">hmac_old_secret</span>), <span class="ruby-identifier">key</span>.<span class="ruby-identifier">bytesize</span>)
<span class="line-num">385</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_hmac_secret'>
<a name='method-i-otp_hmac_secret'></a>
<div class='synopsis'>
<span class='name'>otp_hmac_secret</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_hmac_secret-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_hmac_secret-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">379</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_hmac_secret</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">380</span>   <span class="ruby-identifier">base32_encode</span>(<span class="ruby-identifier">compute_raw_hmac</span>(<span class="ruby-constant">ROTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Base32</span>.<span class="ruby-identifier">decode</span>(<span class="ruby-identifier">key</span>)), <span class="ruby-identifier">key</span>.<span class="ruby-identifier">bytesize</span>)
<span class="line-num">381</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_issuer'>
<a name='method-i-otp_issuer'></a>
<div class='synopsis'>
<span class='name'>otp_issuer</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_issuer-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_issuer-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">314</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_issuer</span>
<span class="line-num">315</span>   <span class="ruby-identifier">domain</span>
<span class="line-num">316</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_key_ds'>
<a name='method-i-otp_key_ds'></a>
<div class='synopsis'>
<span class='name'>otp_key_ds</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_key_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_key_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">450</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_key_ds</span>
<span class="line-num">451</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">otp_keys_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">otp_keys_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session_value</span>)
<span class="line-num">452</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_keys_use_hmac-3F'>
<a name='method-i-otp_keys_use_hmac-3F'></a>
<div class='synopsis'>
<span class='name'>otp_keys_use_hmac?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_keys_use_hmac-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_keys_use_hmac-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">335</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_keys_use_hmac?</span>
<span class="line-num">336</span>   <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-identifier">hmac_secret</span>
<span class="line-num">337</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_last_use'>
<a name='method-i-otp_last_use'></a>
<div class='synopsis'>
<span class='name'>otp_last_use</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_last_use-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_last_use-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">294</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_last_use</span>
<span class="line-num">295</span>   <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">otp_key_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">otp_keys_last_use_column</span>))
<span class="line-num">296</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_locked_out-3F'>
<a name='method-i-otp_locked_out-3F'></a>
<div class='synopsis'>
<span class='name'>otp_locked_out?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_locked_out-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_locked_out-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">306</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_locked_out?</span>
<span class="line-num">307</span>   <span class="ruby-identifier">otp_key_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">otp_keys_failures_column</span>) <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">otp_auth_failures_limit</span>
<span class="line-num">308</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_lockout_redirect'>
<a name='method-i-otp_lockout_redirect'></a>
<div class='synopsis'>
<span class='name'>otp_lockout_redirect</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_lockout_redirect-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_lockout_redirect-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp_unlock.rb</span>
<span class="line-num">210</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_lockout_redirect</span>
<span class="line-num">211</span>   <span class="ruby-identifier">otp_unlock_path</span>
<span class="line-num">212</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_new_secret'>
<a name='method-i-otp_new_secret'></a>
<div class='synopsis'>
<span class='name'>otp_new_secret</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_new_secret-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_new_secret-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">401</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_new_secret</span>
<span class="line-num">402</span>   <span class="ruby-constant">ROTP</span><span class="ruby-operator">::</span><span class="ruby-constant">Base32</span>.<span class="ruby-identifier">random_base32</span>.<span class="ruby-identifier">downcase</span>
<span class="line-num">403</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_provisioning_name'>
<a name='method-i-otp_provisioning_name'></a>
<div class='synopsis'>
<span class='name'>otp_provisioning_name</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_provisioning_name-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_provisioning_name-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">318</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_provisioning_name</span>
<span class="line-num">319</span>   <span class="ruby-identifier">account</span>[<span class="ruby-identifier">login_column</span>]
<span class="line-num">320</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_provisioning_uri'>
<a name='method-i-otp_provisioning_uri'></a>
<div class='synopsis'>
<span class='name'>otp_provisioning_uri</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_provisioning_uri-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_provisioning_uri-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">310</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_provisioning_uri</span>
<span class="line-num">311</span>   <span class="ruby-identifier">otp</span>.<span class="ruby-identifier">provisioning_uri</span>(<span class="ruby-identifier">otp_provisioning_name</span>)
<span class="line-num">312</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_qr_code'>
<a name='method-i-otp_qr_code'></a>
<div class='synopsis'>
<span class='name'>otp_qr_code</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_qr_code-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_qr_code-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">322</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_qr_code</span>
<span class="line-num">323</span>   <span class="ruby-identifier">svg</span> = <span class="ruby-constant">RQRCode</span><span class="ruby-operator">::</span><span class="ruby-constant">QRCode</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">otp_provisioning_uri</span>).<span class="ruby-identifier">as_svg</span>(<span class="ruby-value">:module_size</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">8</span>, <span class="ruby-value">:viewbox</span><span class="ruby-operator">=&gt;</span><span class="ruby-keyword">true</span>, <span class="ruby-value">:use_path</span><span class="ruby-operator">=&gt;</span><span class="ruby-keyword">true</span>, <span class="ruby-value">:fill</span><span class="ruby-operator">=&gt;</span><span class="ruby-string">&quot;fff&quot;</span>)
<span class="line-num">324</span>   <span class="ruby-identifier">svg</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/\A&lt;\?xml version=&quot;1\.0&quot; standalone=&quot;yes&quot;\?&gt;/</span>, <span class="ruby-string">&#39;&#39;</span>)
<span class="line-num">325</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_record_authentication_failure'>
<a name='method-i-otp_record_authentication_failure'></a>
<div class='synopsis'>
<span class='name'>otp_record_authentication_failure</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_record_authentication_failure-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_record_authentication_failure-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">298</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_record_authentication_failure</span>
<span class="line-num">299</span>   <span class="ruby-identifier">otp_key_ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">otp_keys_failures_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">identifier</span>(<span class="ruby-identifier">otp_keys_failures_column</span>) <span class="ruby-operator">+</span> <span class="ruby-value">1</span>)
<span class="line-num">300</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_remove'>
<a name='method-i-otp_remove'></a>
<div class='synopsis'>
<span class='name'>otp_remove</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_remove-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_remove-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">278</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_remove</span>
<span class="line-num">279</span>   <span class="ruby-identifier">otp_key_ds</span>.<span class="ruby-identifier">delete</span>
<span class="line-num">280</span>   <span class="ruby-ivar">@otp_key</span> = <span class="ruby-keyword">nil</span>
<span class="line-num">281</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_remove_auth_failures'>
<a name='method-i-otp_remove_auth_failures'></a>
<div class='synopsis'>
<span class='name'>otp_remove_auth_failures</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_remove_auth_failures-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_remove_auth_failures-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">302</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_remove_auth_failures</span>
<span class="line-num">303</span>   <span class="ruby-identifier">otp_key_ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">otp_keys_failures_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">0</span>)
<span class="line-num">304</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_tmp_key'>
<a name='method-i-otp_tmp_key'></a>
<div class='synopsis'>
<span class='name'>otp_tmp_key</span><span class='arguments'>(secret)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_tmp_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_tmp_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">374</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_tmp_key</span>(<span class="ruby-identifier">secret</span>)
<span class="line-num">375</span>   <span class="ruby-identifier">_otp_tmp_key</span>(<span class="ruby-identifier">secret</span>)
<span class="line-num">376</span>   <span class="ruby-identifier">clear_cached_otp</span>
<span class="line-num">377</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_unlock_auth_failure'>
<a name='method-i-otp_unlock_auth_failure'></a>
<div class='synopsis'>
<span class='name'>otp_unlock_auth_failure</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_unlock_auth_failure-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_unlock_auth_failure-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp_unlock.rb</span>
<span class="line-num">145</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_unlock_auth_failure</span>
<span class="line-num">146</span>   <span class="ruby-identifier">h</span> = {
<span class="line-num">147</span>     <span class="ruby-identifier">otp_unlock_num_successes_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">0</span>,
<span class="line-num">148</span>     <span class="ruby-identifier">otp_unlock_next_auth_attempt_after_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">date_add</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>, <span class="ruby-value">:seconds</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">otp_unlock_auth_failure_cooldown_seconds</span>)
<span class="line-num">149</span>   }
<span class="line-num">150</span> 
<span class="line-num">151</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">otp_unlock_ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">h</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
<span class="line-num">152</span>     <span class="ruby-identifier">h</span>[<span class="ruby-identifier">otp_unlock_id_column</span>] = <span class="ruby-identifier">session_value</span>
<span class="line-num">153</span> 
<span class="line-num">154</span>     <span class="ruby-comment"># If row already exists when inserting, no need to do anything</span>
<span class="line-num">155</span>     <span class="ruby-identifier">raises_uniqueness_violation?</span>{<span class="ruby-identifier">otp_unlock_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">h</span>)}
<span class="line-num">156</span>   <span class="ruby-keyword">end</span>
<span class="line-num">157</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_unlock_auth_success'>
<a name='method-i-otp_unlock_auth_success'></a>
<div class='synopsis'>
<span class='name'>otp_unlock_auth_success</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_unlock_auth_success-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_unlock_auth_success-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp_unlock.rb</span>
<span class="line-num">159</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_unlock_auth_success</span>
<span class="line-num">160</span>   <span class="ruby-identifier">deadline</span> = <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">date_add</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>, <span class="ruby-value">:seconds</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">otp_unlock_success_cooldown_seconds</span>)
<span class="line-num">161</span> 
<span class="line-num">162</span>   <span class="ruby-comment"># Add WHERE to avoid possible race condition when multiple unlock auth requests</span>
<span class="line-num">163</span>   <span class="ruby-comment"># are sent at the same time (only the first should increment num successes).</span>
<span class="line-num">164</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">otp_unlock_ds</span>.
<span class="line-num">165</span>       <span class="ruby-identifier">where</span>(<span class="ruby-constant">Sequel</span>[<span class="ruby-identifier">otp_unlock_next_auth_attempt_after_column</span>] <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>).
<span class="line-num">166</span>       <span class="ruby-identifier">update</span>(
<span class="line-num">167</span>         <span class="ruby-identifier">otp_unlock_num_successes_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span>[<span class="ruby-identifier">otp_unlock_num_successes_column</span>]<span class="ruby-value">+1</span>,
<span class="line-num">168</span>         <span class="ruby-identifier">otp_unlock_next_auth_attempt_after_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">deadline</span>
<span class="line-num">169</span>       ) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
<span class="line-num">170</span> 
<span class="line-num">171</span>     <span class="ruby-comment"># Ignore uniqueness errors when inserting after a failed update,</span>
<span class="line-num">172</span>     <span class="ruby-comment"># which could be caused due to the race condition mentioned above.</span>
<span class="line-num">173</span>     <span class="ruby-identifier">raises_uniqueness_violation?</span> <span class="ruby-keyword">do</span>
<span class="line-num">174</span>       <span class="ruby-identifier">otp_unlock_ds</span>.<span class="ruby-identifier">insert</span>(
<span class="line-num">175</span>         <span class="ruby-identifier">otp_unlock_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session_value</span>,
<span class="line-num">176</span>         <span class="ruby-identifier">otp_unlock_next_auth_attempt_after_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">deadline</span>
<span class="line-num">177</span>       )
<span class="line-num">178</span>     <span class="ruby-keyword">end</span>
<span class="line-num">179</span>   <span class="ruby-keyword">end</span>
<span class="line-num">180</span> 
<span class="line-num">181</span>   <span class="ruby-ivar">@otp_unlock_data</span> = <span class="ruby-keyword">nil</span>
<span class="line-num">182</span>   <span class="ruby-comment"># :nocov:</span>
<span class="line-num">183</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">otp_unlock_data</span>
<span class="line-num">184</span>   <span class="ruby-comment"># :nocov:</span>
<span class="line-num">185</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">otp_unlock_num_successes</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">otp_unlock_auths_required</span>
<span class="line-num">186</span>       <span class="ruby-comment"># At least the requisite number of consecutive successful unlock</span>
<span class="line-num">187</span>       <span class="ruby-comment"># authentications. Unlock OTP authentication.</span>
<span class="line-num">188</span>       <span class="ruby-identifier">otp_key_ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">otp_keys_failures_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">0</span>)
<span class="line-num">189</span> 
<span class="line-num">190</span>       <span class="ruby-comment"># Remove OTP unlock metadata when unlocking OTP authentication</span>
<span class="line-num">191</span>       <span class="ruby-identifier">otp_unlock_reset</span>
<span class="line-num">192</span>     <span class="ruby-comment"># else</span>
<span class="line-num">193</span>     <span class="ruby-comment">#  # Still need additional consecutive successful unlock attempts.</span>
<span class="line-num">194</span>     <span class="ruby-keyword">end</span>
<span class="line-num">195</span>   <span class="ruby-comment"># else</span>
<span class="line-num">196</span>   <span class="ruby-comment">#  # if row isn&#39;t available, probably the process was reset during this,</span>
<span class="line-num">197</span>   <span class="ruby-comment">#  # and it&#39;s safe to do nothing in that case.</span>
<span class="line-num">198</span>   <span class="ruby-keyword">end</span>
<span class="line-num">199</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_unlock_available-3F'>
<a name='method-i-otp_unlock_available-3F'></a>
<div class='synopsis'>
<span class='name'>otp_unlock_available?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_unlock_available-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_unlock_available-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp_unlock.rb</span>
<span class="line-num">115</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_unlock_available?</span>
<span class="line-num">116</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">otp_unlock_data</span>
<span class="line-num">117</span>     <span class="ruby-identifier">next_auth_attempt_after</span> = <span class="ruby-identifier">otp_unlock_next_auth_attempt_after</span>
<span class="line-num">118</span>     <span class="ruby-identifier">current_timestamp</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
<span class="line-num">119</span> 
<span class="line-num">120</span>     <span class="ruby-keyword">if</span> (<span class="ruby-identifier">next_auth_attempt_after</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">current_timestamp</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">otp_unlock_deadline_seconds</span>)
<span class="line-num">121</span>       <span class="ruby-comment"># Unlock process not fully completed within deadline, reset process</span>
<span class="line-num">122</span>       <span class="ruby-identifier">otp_unlock_reset</span>
<span class="line-num">123</span>       <span class="ruby-keyword">true</span>
<span class="line-num">124</span>     <span class="ruby-keyword">else</span>
<span class="line-num">125</span>       <span class="ruby-keyword">if</span> <span class="ruby-identifier">next_auth_attempt_after</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">current_timestamp</span>
<span class="line-num">126</span>         <span class="ruby-comment"># If next auth attempt after timestamp is in the future, that means the next</span>
<span class="line-num">127</span>         <span class="ruby-comment"># unlock attempt cannot happen until then.</span>
<span class="line-num">128</span>         <span class="ruby-keyword">false</span> 
<span class="line-num">129</span>       <span class="ruby-keyword">else</span>
<span class="line-num">130</span>         <span class="ruby-keyword">if</span> <span class="ruby-identifier">otp_unlock_num_successes</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
<span class="line-num">131</span>           <span class="ruby-comment"># 0 value indicates previous attempt was a failure. Since failure cooldown</span>
<span class="line-num">132</span>           <span class="ruby-comment"># period has passed, reset process so user gets full deadline period</span>
<span class="line-num">133</span>           <span class="ruby-identifier">otp_unlock_reset</span>
<span class="line-num">134</span>         <span class="ruby-keyword">end</span>
<span class="line-num">135</span>         <span class="ruby-keyword">true</span>
<span class="line-num">136</span>       <span class="ruby-keyword">end</span>
<span class="line-num">137</span>     <span class="ruby-keyword">end</span>
<span class="line-num">138</span>   <span class="ruby-keyword">else</span>
<span class="line-num">139</span>     <span class="ruby-comment"># No row means no unlock attempts yet (or previous attempt was more than the</span>
<span class="line-num">140</span>     <span class="ruby-comment"># deadline account, so unlocking is available</span>
<span class="line-num">141</span>     <span class="ruby-keyword">true</span>
<span class="line-num">142</span>   <span class="ruby-keyword">end</span>
<span class="line-num">143</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_unlock_data'>
<a name='method-i-otp_unlock_data'></a>
<div class='synopsis'>
<span class='name'>otp_unlock_data</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_unlock_data-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_unlock_data-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp_unlock.rb</span>
<span class="line-num">240</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_unlock_data</span>
<span class="line-num">241</span>   <span class="ruby-ivar">@otp_unlock_data</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">otp_unlock_ds</span>.<span class="ruby-identifier">first</span>
<span class="line-num">242</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_unlock_deadline'>
<a name='method-i-otp_unlock_deadline'></a>
<div class='synopsis'>
<span class='name'>otp_unlock_deadline</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_unlock_deadline-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_unlock_deadline-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp_unlock.rb</span>
<span class="line-num">222</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_unlock_deadline</span>
<span class="line-num">223</span>   <span class="ruby-identifier">otp_unlock_next_auth_attempt_after</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">otp_unlock_deadline_seconds</span>
<span class="line-num">224</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_unlock_deadline_passed-3F'>
<a name='method-i-otp_unlock_deadline_passed-3F'></a>
<div class='synopsis'>
<span class='name'>otp_unlock_deadline_passed?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_unlock_deadline_passed-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_unlock_deadline_passed-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp_unlock.rb</span>
<span class="line-num">201</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_unlock_deadline_passed?</span>
<span class="line-num">202</span>   <span class="ruby-identifier">otp_unlock_data</span> <span class="ruby-operator">?</span> (<span class="ruby-identifier">otp_unlock_next_auth_attempt_after</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">otp_unlock_deadline_seconds</span>) <span class="ruby-operator">:</span> <span class="ruby-keyword">false</span>
<span class="line-num">203</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_unlock_ds'>
<a name='method-i-otp_unlock_ds'></a>
<div class='synopsis'>
<span class='name'>otp_unlock_ds</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_unlock_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_unlock_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp_unlock.rb</span>
<span class="line-num">253</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_unlock_ds</span>
<span class="line-num">254</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">otp_unlock_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">otp_unlock_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session_value</span>)
<span class="line-num">255</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_unlock_next_auth_attempt_after'>
<a name='method-i-otp_unlock_next_auth_attempt_after'></a>
<div class='synopsis'>
<span class='name'>otp_unlock_next_auth_attempt_after</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_unlock_next_auth_attempt_after-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_unlock_next_auth_attempt_after-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp_unlock.rb</span>
<span class="line-num">214</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_unlock_next_auth_attempt_after</span>
<span class="line-num">215</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">otp_unlock_data</span>
<span class="line-num">216</span>     <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">otp_unlock_data</span>[<span class="ruby-identifier">otp_unlock_next_auth_attempt_after_column</span>])
<span class="line-num">217</span>   <span class="ruby-keyword">else</span>
<span class="line-num">218</span>     <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
<span class="line-num">219</span>   <span class="ruby-keyword">end</span>
<span class="line-num">220</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_unlock_not_available_set_refresh_header'>
<a name='method-i-otp_unlock_not_available_set_refresh_header'></a>
<div class='synopsis'>
<span class='name'>otp_unlock_not_available_set_refresh_header</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_unlock_not_available_set_refresh_header-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_unlock_not_available_set_refresh_header-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp_unlock.rb</span>
<span class="line-num">230</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_unlock_not_available_set_refresh_header</span>
<span class="line-num">231</span>   <span class="ruby-identifier">response</span>.<span class="ruby-identifier">headers</span>[<span class="ruby-string">&quot;refresh&quot;</span>] = ((<span class="ruby-identifier">otp_unlock_next_auth_attempt_after</span> <span class="ruby-operator">-</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>).<span class="ruby-identifier">to_i</span> <span class="ruby-operator">+</span> <span class="ruby-value">1</span>).<span class="ruby-identifier">to_s</span>
<span class="line-num">232</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_unlock_num_successes'>
<a name='method-i-otp_unlock_num_successes'></a>
<div class='synopsis'>
<span class='name'>otp_unlock_num_successes</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_unlock_num_successes-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_unlock_num_successes-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp_unlock.rb</span>
<span class="line-num">226</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_unlock_num_successes</span>
<span class="line-num">227</span>   <span class="ruby-identifier">otp_unlock_data</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">otp_unlock_data</span>[<span class="ruby-identifier">otp_unlock_num_successes_column</span>] <span class="ruby-operator">:</span> <span class="ruby-value">0</span>
<span class="line-num">228</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_unlock_refresh_tag'>
<a name='method-i-otp_unlock_refresh_tag'></a>
<div class='synopsis'>
<span class='name'>otp_unlock_refresh_tag</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_unlock_refresh_tag-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_unlock_refresh_tag-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp_unlock.rb</span>
<span class="line-num">205</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_unlock_refresh_tag</span>
<span class="line-num">206</span>   <span class="ruby-comment"># RODAUTH3: Remove</span>
<span class="line-num">207</span>   <span class="ruby-node">&quot;&lt;meta http-equiv=\&quot;refresh\&quot; content=\&quot;#{(otp_unlock_next_auth_attempt_after - Time.now).to_i + 1}\&quot;&gt;&quot;</span>
<span class="line-num">208</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_unlock_reset'>
<a name='method-i-otp_unlock_reset'></a>
<div class='synopsis'>
<span class='name'>otp_unlock_reset</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_unlock_reset-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_unlock_reset-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp_unlock.rb</span>
<span class="line-num">248</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_unlock_reset</span>
<span class="line-num">249</span>   <span class="ruby-identifier">otp_unlock_ds</span>.<span class="ruby-identifier">delete</span>
<span class="line-num">250</span>   <span class="ruby-ivar">@otp_unlock_data</span> = <span class="ruby-keyword">nil</span>
<span class="line-num">251</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_unlock_success_cooldown_seconds'>
<a name='method-i-otp_unlock_success_cooldown_seconds'></a>
<div class='synopsis'>
<span class='name'>otp_unlock_success_cooldown_seconds</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_unlock_success_cooldown_seconds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_unlock_success_cooldown_seconds-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp_unlock.rb</span>
<span class="line-num">244</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_unlock_success_cooldown_seconds</span>
<span class="line-num">245</span>   (<span class="ruby-identifier">_otp_interval</span><span class="ruby-operator">+</span>(<span class="ruby-identifier">otp_drift</span><span class="ruby-operator">||</span><span class="ruby-value">0</span>))<span class="ruby-operator">*</span><span class="ruby-value">2</span>
<span class="line-num">246</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_update_last_use'>
<a name='method-i-otp_update_last_use'></a>
<div class='synopsis'>
<span class='name'>otp_update_last_use</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_update_last_use-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_update_last_use-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">288</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_update_last_use</span>
<span class="line-num">289</span>   <span class="ruby-identifier">otp_key_ds</span>.
<span class="line-num">290</span>     <span class="ruby-identifier">where</span>(<span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">date_add</span>(<span class="ruby-identifier">otp_keys_last_use_column</span>, <span class="ruby-value">:seconds</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">_otp_interval</span>) <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>).
<span class="line-num">291</span>     <span class="ruby-identifier">update</span>(<span class="ruby-identifier">otp_keys_last_use_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>) <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
<span class="line-num">292</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_user_key'>
<a name='method-i-otp_user_key'></a>
<div class='synopsis'>
<span class='name'>otp_user_key</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_user_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_user_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">327</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_user_key</span>
<span class="line-num">328</span>   <span class="ruby-ivar">@otp_user_key</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">otp_keys_use_hmac?</span>
<span class="line-num">329</span>     <span class="ruby-identifier">otp_hmac_secret</span>(<span class="ruby-identifier">otp_key</span>)
<span class="line-num">330</span>   <span class="ruby-keyword">else</span>
<span class="line-num">331</span>     <span class="ruby-identifier">otp_key</span>
<span class="line-num">332</span>   <span class="ruby-keyword">end</span>
<span class="line-num">333</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_valid_code-3F'>
<a name='method-i-otp_valid_code-3F'></a>
<div class='synopsis'>
<span class='name'>otp_valid_code?</span><span class='arguments'>(ot_pass)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_valid_code-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_valid_code-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">251</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_valid_code?</span>(<span class="ruby-identifier">ot_pass</span>)
<span class="line-num">252</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">_otp_valid_code?</span>(<span class="ruby-identifier">ot_pass</span>, <span class="ruby-identifier">otp</span>)
<span class="line-num">253</span>     <span class="ruby-keyword">true</span>
<span class="line-num">254</span>   <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">hmac_secret_rotation?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">_otp_valid_code?</span>(<span class="ruby-identifier">ot_pass</span>, <span class="ruby-identifier">_otp_for_key</span>(<span class="ruby-identifier">otp_hmac_old_secret</span>(<span class="ruby-identifier">otp_key</span>)))
<span class="line-num">255</span>     <span class="ruby-identifier">_otp_valid_code_for_old_secret</span>
<span class="line-num">256</span>     <span class="ruby-keyword">true</span>
<span class="line-num">257</span>   <span class="ruby-keyword">else</span>
<span class="line-num">258</span>     <span class="ruby-keyword">false</span>
<span class="line-num">259</span>   <span class="ruby-keyword">end</span>
<span class="line-num">260</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-otp_valid_key-3F'>
<a name='method-i-otp_valid_key-3F'></a>
<div class='synopsis'>
<span class='name'>otp_valid_key?</span><span class='arguments'>(secret)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-otp_valid_key-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-otp_valid_key-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">387</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">otp_valid_key?</span>(<span class="ruby-identifier">secret</span>)
<span class="line-num">388</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">secret</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/\A([a-z2-7]{16}|[a-z2-7]{32})\z/</span>
<span class="line-num">389</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">otp_keys_use_hmac?</span>
<span class="line-num">390</span>     <span class="ruby-comment"># Purposely do not allow creating new OTPs with old secrets,</span>
<span class="line-num">391</span>     <span class="ruby-comment"># since OTP rotation is difficult.  The user will get shown</span>
<span class="line-num">392</span>     <span class="ruby-comment"># the same page with an updated secret, which they can submit</span>
<span class="line-num">393</span>     <span class="ruby-comment"># to setup OTP.</span>
<span class="line-num">394</span>     <span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">otp_hmac_secret</span>(<span class="ruby-identifier">param</span>(<span class="ruby-identifier">otp_setup_raw_param</span>)), <span class="ruby-identifier">secret</span>)
<span class="line-num">395</span>   <span class="ruby-keyword">else</span>
<span class="line-num">396</span>     <span class="ruby-keyword">true</span>
<span class="line-num">397</span>   <span class="ruby-keyword">end</span>
<span class="line-num">398</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-over_max_bytesize_param_value'>
<a name='method-i-over_max_bytesize_param_value'></a>
<div class='synopsis'>
<span class='name'>over_max_bytesize_param_value</span><span class='arguments'>(key, value)</span>

</div>
<div class='description'>

<p>Return nil by default for values over maximum bytesize.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-over_max_bytesize_param_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-over_max_bytesize_param_value-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">507</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">over_max_bytesize_param_value</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)
<span class="line-num">508</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">509</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-param'>
<a name='method-i-param'></a>
<div class='synopsis'>
<span class='name'>param</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

<p>Return a string for the parameter name.  This will be an empty string if the parameter doesn’t exist.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-param-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-param-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">490</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">param</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">491</span>   <span class="ruby-identifier">param_or_nil</span>(<span class="ruby-identifier">key</span>).<span class="ruby-identifier">to_s</span>
<span class="line-num">492</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-param_or_nil'>
<a name='method-i-param_or_nil'></a>
<div class='synopsis'>
<span class='name'>param_or_nil</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

<p>Return a string for the parameter name, or nil if there is no parameter with that name.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-param_or_nil-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-param_or_nil-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">496</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">param_or_nil</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">497</span>   <span class="ruby-identifier">value</span> = <span class="ruby-identifier">raw_param</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">498</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span>
<span class="line-num">499</span>     <span class="ruby-identifier">value</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>
<span class="line-num">500</span>     <span class="ruby-identifier">value</span> = <span class="ruby-identifier">over_max_bytesize_param_value</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">max_param_bytesize</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">bytesize</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">max_param_bytesize</span>
<span class="line-num">501</span>     <span class="ruby-identifier">value</span> = <span class="ruby-identifier">null_byte_parameter_value</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">&quot;\0&quot;</span>)
<span class="line-num">502</span>   <span class="ruby-keyword">end</span>
<span class="line-num">503</span>   <span class="ruby-identifier">value</span>
<span class="line-num">504</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_confirm_label'>
<a name='method-i-password_confirm_label'></a>
<div class='synopsis'>
<span class='name'>password_confirm_label</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_confirm_label-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_confirm_label-source'>   <span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb</span>
<span class="line-num">51</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_confirm_label</span>
<span class="line-num">52</span>   <span class="ruby-node">&quot;Confirm #{password_label}&quot;</span>
<span class="line-num">53</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_does_not_contain_null_byte-3F'>
<a name='method-i-password_does_not_contain_null_byte-3F'></a>
<div class='synopsis'>
<span class='name'>password_does_not_contain_null_byte?</span><span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_does_not_contain_null_byte-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_does_not_contain_null_byte-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb</span>
<span class="line-num">183</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_does_not_contain_null_byte?</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">184</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">password</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">&quot;\0&quot;</span>)
<span class="line-num">185</span>   <span class="ruby-identifier">set_password_requirement_error_message</span>(<span class="ruby-value">:password_contains_null_byte</span>, <span class="ruby-identifier">contains_null_byte_message</span>)
<span class="line-num">186</span>   <span class="ruby-keyword">false</span>
<span class="line-num">187</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_does_not_meet_requirements_message'>
<a name='method-i-password_does_not_meet_requirements_message'></a>
<div class='synopsis'>
<span class='name'>password_does_not_meet_requirements_message</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_does_not_meet_requirements_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_does_not_meet_requirements_message-source'>   <span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb</span>
<span class="line-num">88</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_does_not_meet_requirements_message</span>
<span class="line-num">89</span>   <span class="ruby-node">&quot;invalid password, does not meet requirements#{&quot; (#{password_requirement_message})&quot; if password_requirement_message}&quot;</span>
<span class="line-num">90</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_doesnt_match_previous_password-3F'>
<a name='method-i-password_doesnt_match_previous_password-3F'></a>
<div class='synopsis'>
<span class='name'>password_doesnt_match_previous_password?</span><span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_doesnt_match_previous_password-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_doesnt_match_previous_password-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/disallow_password_reuse.rb</span>
<span class="line-num">50</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_doesnt_match_previous_password?</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">51</span>   <span class="ruby-identifier">match</span> = <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_database_authentication_functions?</span>
<span class="line-num">52</span>     <span class="ruby-identifier">salts</span> = <span class="ruby-identifier">previous_password_ds</span>.
<span class="line-num">53</span>       <span class="ruby-identifier">select_map</span>([<span class="ruby-identifier">previous_password_id_column</span>, <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">function</span>(<span class="ruby-identifier">function_name</span>(<span class="ruby-value">:rodauth_get_previous_salt</span>), <span class="ruby-identifier">previous_password_id_column</span>).<span class="ruby-identifier">as</span>(<span class="ruby-value">:salt</span>)])
<span class="line-num">54</span>     <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">salts</span>.<span class="ruby-identifier">empty?</span>
<span class="line-num">55</span> 
<span class="line-num">56</span>     <span class="ruby-identifier">salts</span>.<span class="ruby-identifier">any?</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">hash_id</span>, <span class="ruby-identifier">salt</span><span class="ruby-operator">|</span>
<span class="line-num">57</span>       <span class="ruby-identifier">database_function_password_match?</span>(<span class="ruby-value">:rodauth_previous_password_hash_match</span>, <span class="ruby-identifier">hash_id</span>, <span class="ruby-identifier">password</span>, <span class="ruby-identifier">salt</span>)
<span class="line-num">58</span>     <span class="ruby-keyword">end</span>
<span class="line-num">59</span>   <span class="ruby-keyword">else</span>
<span class="line-num">60</span>     <span class="ruby-comment"># :nocov:</span>
<span class="line-num">61</span>     <span class="ruby-identifier">previous_password_ds</span>.<span class="ruby-identifier">select_map</span>(<span class="ruby-identifier">previous_password_hash_column</span>).<span class="ruby-identifier">any?</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">hash</span><span class="ruby-operator">|</span>
<span class="line-num">62</span>       <span class="ruby-identifier">password_hash_match?</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">password</span>)
<span class="line-num">63</span>     <span class="ruby-keyword">end</span>
<span class="line-num">64</span>     <span class="ruby-comment"># :nocov:</span>
<span class="line-num">65</span>   <span class="ruby-keyword">end</span>
<span class="line-num">66</span> 
<span class="line-num">67</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">match</span>
<span class="line-num">68</span>   <span class="ruby-identifier">set_password_requirement_error_message</span>(<span class="ruby-value">:password_same_as_previous_password</span>, <span class="ruby-identifier">password_same_as_previous_password_message</span>)
<span class="line-num">69</span>   <span class="ruby-keyword">false</span>
<span class="line-num">70</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_expiration_ds'>
<a name='method-i-password_expiration_ds'></a>
<div class='synopsis'>
<span class='name'>password_expiration_ds</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_expiration_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_expiration_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/password_expiration.rb</span>
<span class="line-num">107</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_expiration_ds</span>
<span class="line-num">108</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">password_expiration_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">password_expiration_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>)
<span class="line-num">109</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_expired-3F'>
<a name='method-i-password_expired-3F'></a>
<div class='synopsis'>
<span class='name'>password_expired?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_expired-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_expired-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/password_expiration.rb</span>
<span class="line-num">68</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_expired?</span>
<span class="line-num">69</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">password_changed_at</span> = <span class="ruby-identifier">session</span>[<span class="ruby-identifier">password_changed_at_session_key</span>]
<span class="line-num">70</span>     <span class="ruby-keyword">return</span> <span class="ruby-identifier">password_changed_at</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">require_password_change_after</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_i</span>
<span class="line-num">71</span>   <span class="ruby-keyword">end</span>
<span class="line-num">72</span> 
<span class="line-num">73</span>   <span class="ruby-identifier">account_from_session</span>
<span class="line-num">74</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">password_changed_at</span> = <span class="ruby-identifier">get_password_changed_at</span>
<span class="line-num">75</span>     <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">password_changed_at_session_key</span>, <span class="ruby-identifier">password_changed_at</span>.<span class="ruby-identifier">to_i</span>)
<span class="line-num">76</span>     <span class="ruby-identifier">password_changed_at</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">require_password_change_after</span> <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
<span class="line-num">77</span>   <span class="ruby-keyword">else</span>
<span class="line-num">78</span>     <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">password_changed_at_session_key</span>, <span class="ruby-identifier">password_expiration_default</span> <span class="ruby-operator">?</span> <span class="ruby-value">0</span> <span class="ruby-operator">:</span> <span class="ruby-value">2147483647</span>)
<span class="line-num">79</span>     <span class="ruby-identifier">password_expiration_default</span>
<span class="line-num">80</span>   <span class="ruby-keyword">end</span>
<span class="line-num">81</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_field_autocomplete_value'>
<a name='method-i-password_field_autocomplete_value'></a>
<div class='synopsis'>
<span class='name'>password_field_autocomplete_value</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_field_autocomplete_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_field_autocomplete_value-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">297</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_field_autocomplete_value</span>
<span class="line-num">298</span>   <span class="ruby-ivar">@password_field_autocomplete_value</span> <span class="ruby-operator">||</span> <span class="ruby-string">&#39;current-password&#39;</span>
<span class="line-num">299</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_has_enough_character_groups-3F'>
<a name='method-i-password_has_enough_character_groups-3F'></a>
<div class='synopsis'>
<span class='name'>password_has_enough_character_groups?</span><span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_has_enough_character_groups-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_has_enough_character_groups-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/password_complexity.rb</span>
<span class="line-num">54</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_has_enough_character_groups?</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">55</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">password</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">password_max_length_for_groups_check</span>
<span class="line-num">56</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">password_character_groups</span>.<span class="ruby-identifier">select</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">re</span><span class="ruby-operator">|</span> <span class="ruby-identifier">password</span> <span class="ruby-operator">=~</span> <span class="ruby-identifier">re</span>}.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">password_min_groups</span>
<span class="line-num">57</span>   <span class="ruby-identifier">set_password_requirement_error_message</span>(<span class="ruby-value">:not_enough_character_groups_in_password</span>, <span class="ruby-identifier">password_not_enough_character_groups_message</span>)
<span class="line-num">58</span>   <span class="ruby-keyword">false</span>
<span class="line-num">59</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_has_no_invalid_pattern-3F'>
<a name='method-i-password_has_no_invalid_pattern-3F'></a>
<div class='synopsis'>
<span class='name'>password_has_no_invalid_pattern?</span><span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_has_no_invalid_pattern-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_has_no_invalid_pattern-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/password_complexity.rb</span>
<span class="line-num">61</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_has_no_invalid_pattern?</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">62</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">password_invalid_pattern</span>
<span class="line-num">63</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">password</span> <span class="ruby-operator">!~</span> <span class="ruby-identifier">password_invalid_pattern</span>
<span class="line-num">64</span>   <span class="ruby-identifier">set_password_requirement_error_message</span>(<span class="ruby-value">:invalid_password_pattern</span>, <span class="ruby-identifier">password_invalid_pattern_message</span>)
<span class="line-num">65</span>   <span class="ruby-keyword">false</span>
<span class="line-num">66</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_hash'>
<a name='method-i-password_hash'></a>
<div class='synopsis'>
<span class='name'>password_hash</span><span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_hash-source'>   <span class="ruby-comment"># File lib/rodauth/features/argon2.rb</span>
<span class="line-num">19</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_hash</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">20</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">super</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">use_argon2?</span>
<span class="line-num">21</span> 
<span class="line-num">22</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">secret</span> = <span class="ruby-identifier">argon2_secret</span>
<span class="line-num">23</span>     <span class="ruby-identifier">argon2_params</span> = <span class="ruby-constant">Hash</span>[<span class="ruby-identifier">password_hash_cost</span>]
<span class="line-num">24</span>     <span class="ruby-identifier">argon2_params</span>[<span class="ruby-value">:secret</span>] = <span class="ruby-identifier">secret</span>
<span class="line-num">25</span>   <span class="ruby-keyword">else</span>
<span class="line-num">26</span>     <span class="ruby-identifier">argon2_params</span> = <span class="ruby-identifier">password_hash_cost</span>
<span class="line-num">27</span>   <span class="ruby-keyword">end</span>
<span class="line-num">28</span>   <span class="ruby-operator">::</span><span class="ruby-constant">Argon2</span><span class="ruby-operator">::</span><span class="ruby-constant">Password</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">argon2_params</span>).<span class="ruby-identifier">create</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">29</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_hash_cost'>
<a name='method-i-password_hash_cost'></a>
<div class='synopsis'>
<span class='name'>password_hash_cost</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_hash_cost-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_hash_cost-source'>   <span class="ruby-comment"># File lib/rodauth/features/argon2.rb</span>
<span class="line-num">45</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_hash_cost</span>
<span class="line-num">46</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">super</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">use_argon2?</span>
<span class="line-num">47</span>   <span class="ruby-identifier">argon2_hash_cost</span>
<span class="line-num">48</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_hash_ds'>
<a name='method-i-password_hash_ds'></a>
<div class='synopsis'>
<span class='name'>password_hash_ds</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_hash_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_hash_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">860</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_hash_ds</span>
<span class="line-num">861</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">password_hash_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">password_hash_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">account_id</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">session_value</span>)
<span class="line-num">862</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_hash_match-3F'>
<a name='method-i-password_hash_match-3F'></a>
<div class='synopsis'>
<span class='name'>password_hash_match?</span><span class='arguments'>(hash, password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_hash_match-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_hash_match-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/argon2.rb</span>
<span class="line-num">50</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_hash_match?</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">password</span>)
<span class="line-num">51</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">super</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">argon2_hash_algorithm?</span>(<span class="ruby-identifier">hash</span>)
<span class="line-num">52</span>   <span class="ruby-identifier">argon2_password_hash_match?</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">password</span>)
<span class="line-num">53</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_hash_using_salt'>
<a name='method-i-password_hash_using_salt'></a>
<div class='synopsis'>
<span class='name'>password_hash_using_salt</span><span class='arguments'>(password, salt)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_hash_using_salt-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_hash_using_salt-source'>   <span class="ruby-comment"># File lib/rodauth/features/argon2.rb</span>
<span class="line-num">55</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_hash_using_salt</span>(<span class="ruby-identifier">password</span>, <span class="ruby-identifier">salt</span>)
<span class="line-num">56</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">super</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">argon2_hash_algorithm?</span>(<span class="ruby-identifier">salt</span>)
<span class="line-num">57</span>   <span class="ruby-identifier">argon2_password_hash_using_salt_and_secret</span>(<span class="ruby-identifier">password</span>, <span class="ruby-identifier">salt</span>, <span class="ruby-identifier">argon2_secret</span>)
<span class="line-num">58</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_match-3F'>
<a name='method-i-password_match-3F'></a>
<div class='synopsis'>
<span class='name'>password_match?</span><span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_match-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_match-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">455</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_match?</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">456</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">hash</span> = <span class="ruby-identifier">get_password_hash</span>
<span class="line-num">457</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">account_password_hash_column</span> <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">use_database_authentication_functions?</span>
<span class="line-num">458</span>       <span class="ruby-identifier">password_hash_match?</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">password</span>)
<span class="line-num">459</span>     <span class="ruby-keyword">else</span>
<span class="line-num">460</span>       <span class="ruby-identifier">database_function_password_match?</span>(<span class="ruby-value">:rodauth_valid_password_hash</span>, <span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">password</span>, <span class="ruby-identifier">hash</span>)
<span class="line-num">461</span>     <span class="ruby-keyword">end</span> 
<span class="line-num">462</span>   <span class="ruby-keyword">end</span>
<span class="line-num">463</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_meets_length_requirements-3F'>
<a name='method-i-password_meets_length_requirements-3F'></a>
<div class='synopsis'>
<span class='name'>password_meets_length_requirements?</span><span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_meets_length_requirements-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_meets_length_requirements-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb</span>
<span class="line-num">168</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_meets_length_requirements?</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">169</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">password_minimum_length</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">password</span>.<span class="ruby-identifier">length</span>
<span class="line-num">170</span>     <span class="ruby-identifier">set_password_requirement_error_message</span>(<span class="ruby-value">:password_too_short</span>, <span class="ruby-identifier">password_too_short_message</span>)
<span class="line-num">171</span>     <span class="ruby-keyword">false</span>
<span class="line-num">172</span>   <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">password_maximum_length</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">password_maximum_length</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">password</span>.<span class="ruby-identifier">length</span>
<span class="line-num">173</span>     <span class="ruby-identifier">set_password_requirement_error_message</span>(<span class="ruby-value">:password_too_long</span>, <span class="ruby-identifier">password_too_long_message</span>)
<span class="line-num">174</span>     <span class="ruby-keyword">false</span>
<span class="line-num">175</span>   <span class="ruby-keyword">elsif</span> <span class="ruby-identifier">password_maximum_bytes</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">password_maximum_bytes</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">password</span>.<span class="ruby-identifier">bytesize</span>
<span class="line-num">176</span>     <span class="ruby-identifier">set_password_requirement_error_message</span>(<span class="ruby-value">:password_too_many_bytes</span>, <span class="ruby-identifier">password_too_many_bytes_message</span>)
<span class="line-num">177</span>     <span class="ruby-keyword">false</span>
<span class="line-num">178</span>   <span class="ruby-keyword">else</span>
<span class="line-num">179</span>     <span class="ruby-keyword">true</span>
<span class="line-num">180</span>   <span class="ruby-keyword">end</span>
<span class="line-num">181</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_meets_requirements-3F'>
<a name='method-i-password_meets_requirements-3F'></a>
<div class='synopsis'>
<span class='name'>password_meets_requirements?</span><span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_meets_requirements-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_meets_requirements-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/disallow_common_passwords.rb</span>
<span class="line-num">13</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_meets_requirements?</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">14</span>   <span class="ruby-keyword">super</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">password_not_one_of_the_most_common?</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">15</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_not_in_dictionary-3F'>
<a name='method-i-password_not_in_dictionary-3F'></a>
<div class='synopsis'>
<span class='name'>password_not_in_dictionary?</span><span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_not_in_dictionary-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_not_in_dictionary-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/password_complexity.rb</span>
<span class="line-num">75</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_not_in_dictionary?</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">76</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">dict</span> = <span class="ruby-identifier">password_dictionary</span>
<span class="line-num">77</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">password</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp">/\A(?:\d*)([A-Za-z!@$+|][A-Za-z!@$+|0134578]+[A-Za-z!@$+|])(?:\d*)\z/</span>
<span class="line-num">78</span>   <span class="ruby-identifier">word</span> = <span class="ruby-node">$1</span>.<span class="ruby-identifier">downcase</span>.<span class="ruby-identifier">tr</span>(<span class="ruby-string">&#39;!@$+|0134578&#39;</span>, <span class="ruby-string">&#39;iastloleastb&#39;</span>)
<span class="line-num">79</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">dict</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">word</span>)
<span class="line-num">80</span>   <span class="ruby-identifier">set_password_requirement_error_message</span>(<span class="ruby-value">:password_in_dictionary</span>, <span class="ruby-identifier">password_in_dictionary_message</span>)
<span class="line-num">81</span>   <span class="ruby-keyword">false</span>
<span class="line-num">82</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_not_one_of_the_most_common-3F'>
<a name='method-i-password_not_one_of_the_most_common-3F'></a>
<div class='synopsis'>
<span class='name'>password_not_one_of_the_most_common?</span><span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_not_one_of_the_most_common-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_not_one_of_the_most_common-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/disallow_common_passwords.rb</span>
<span class="line-num">33</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_not_one_of_the_most_common?</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">34</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">password_one_of_most_common?</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">35</span>   <span class="ruby-identifier">set_password_requirement_error_message</span>(<span class="ruby-value">:password_is_one_of_the_most_common</span>, <span class="ruby-identifier">password_is_one_of_the_most_common_message</span>)
<span class="line-num">36</span>   <span class="ruby-keyword">false</span>
<span class="line-num">37</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_not_too_many_repeating_characters-3F'>
<a name='method-i-password_not_too_many_repeating_characters-3F'></a>
<div class='synopsis'>
<span class='name'>password_not_too_many_repeating_characters?</span><span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_not_too_many_repeating_characters-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_not_too_many_repeating_characters-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/password_complexity.rb</span>
<span class="line-num">68</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_not_too_many_repeating_characters?</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">69</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">password_max_repeating_characters</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">2</span>
<span class="line-num">70</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">password</span> <span class="ruby-operator">!~</span> <span class="ruby-regexp">/(.)(\1){#{password_max_repeating_characters-1}}/</span> 
<span class="line-num">71</span>   <span class="ruby-identifier">set_password_requirement_error_message</span>(<span class="ruby-value">:too_many_repeating_characters_in_password</span>, <span class="ruby-identifier">password_too_many_repeating_characters_message</span>)
<span class="line-num">72</span>   <span class="ruby-keyword">false</span>
<span class="line-num">73</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_one_of_most_common-3F'>
<a name='method-i-password_one_of_most_common-3F'></a>
<div class='synopsis'>
<span class='name'>password_one_of_most_common?</span><span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_one_of_most_common-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_one_of_most_common-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/disallow_common_passwords.rb</span>
<span class="line-num">27</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_one_of_most_common?</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">28</span>   <span class="ruby-identifier">most_common_passwords</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">29</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_recently_entered-3F'>
<a name='method-i-password_recently_entered-3F'></a>
<div class='synopsis'>
<span class='name'>password_recently_entered?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_recently_entered-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_recently_entered-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/password_grace_period.rb</span>
<span class="line-num">22</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_recently_entered?</span>
<span class="line-num">23</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">last_password_entry</span> = <span class="ruby-identifier">session</span>[<span class="ruby-identifier">last_password_entry_session_key</span>]
<span class="line-num">24</span>   <span class="ruby-identifier">last_password_entry</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">password_grace_period</span> <span class="ruby-operator">&gt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_i</span>
<span class="line-num">25</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_reset_ds'>
<a name='method-i-password_reset_ds'></a>
<div class='synopsis'>
<span class='name'>password_reset_ds</span><span class='arguments'>(id=account_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_reset_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_reset_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/reset_password.rb</span>
<span class="line-num">252</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_reset_ds</span>(<span class="ruby-identifier">id</span>=<span class="ruby-identifier">account_id</span>)
<span class="line-num">253</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">reset_password_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">reset_password_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">id</span>)
<span class="line-num">254</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_too_long_message'>
<a name='method-i-password_too_long_message'></a>
<div class='synopsis'>
<span class='name'>password_too_long_message</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_too_long_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_too_long_message-source'>   <span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb</span>
<span class="line-num">92</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_too_long_message</span>
<span class="line-num">93</span>   <span class="ruby-node">&quot;maximum #{password_maximum_length} characters&quot;</span>
<span class="line-num">94</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_too_many_bytes_message'>
<a name='method-i-password_too_many_bytes_message'></a>
<div class='synopsis'>
<span class='name'>password_too_many_bytes_message</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_too_many_bytes_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_too_many_bytes_message-source'>   <span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb</span>
<span class="line-num">96</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_too_many_bytes_message</span>
<span class="line-num">97</span>   <span class="ruby-node">&quot;maximum #{password_maximum_bytes} bytes&quot;</span>
<span class="line-num">98</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-password_too_short_message'>
<a name='method-i-password_too_short_message'></a>
<div class='synopsis'>
<span class='name'>password_too_short_message</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-password_too_short_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-password_too_short_message-source'>    <span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb</span>
<span class="line-num">100</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">password_too_short_message</span>
<span class="line-num">101</span>   <span class="ruby-node">&quot;minimum #{password_minimum_length} characters&quot;</span>
<span class="line-num">102</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-possible_authentication_methods'>
<a name='method-i-possible_authentication_methods'></a>
<div class='synopsis'>
<span class='name'>possible_authentication_methods</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-possible_authentication_methods-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-possible_authentication_methods-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">543</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">possible_authentication_methods</span>
<span class="line-num">544</span>   <span class="ruby-identifier">has_password?</span> <span class="ruby-operator">?</span> [<span class="ruby-string">&#39;password&#39;</span>] <span class="ruby-operator">:</span> []
<span class="line-num">545</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-post_configure'>
<a name='method-i-post_configure'></a>
<div class='synopsis'>
<span class='name'>post_configure</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-post_configure-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-post_configure-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">437</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">post_configure</span>
<span class="line-num">438</span>   <span class="ruby-identifier">require</span> <span class="ruby-string">&#39;bcrypt&#39;</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">require_bcrypt?</span>
<span class="line-num">439</span>   <span class="ruby-identifier">db</span>.<span class="ruby-identifier">extension</span> <span class="ruby-value">:date_arithmetic</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">use_date_arithmetic?</span>
<span class="line-num">440</span> 
<span class="line-num">441</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">method</span>(<span class="ruby-value">:convert_token_id_to_integer?</span>).<span class="ruby-identifier">owner</span> <span class="ruby-operator">==</span> <span class="ruby-constant">Rodauth</span><span class="ruby-operator">::</span><span class="ruby-constant">Base</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">db</span> <span class="ruby-keyword">rescue</span> <span class="ruby-keyword">false</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">table_exists?</span>(<span class="ruby-identifier">accounts_table</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">schema</span>(<span class="ruby-identifier">accounts_table</span>).<span class="ruby-identifier">find</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">col</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span> <span class="ruby-keyword">break</span> <span class="ruby-identifier">v</span>[<span class="ruby-value">:type</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:integer</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">col</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">account_id_column</span>}
<span class="line-num">442</span>     <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">send</span>(<span class="ruby-value">:define_method</span>, <span class="ruby-value">:convert_token_id_to_integer?</span>){<span class="ruby-keyword">true</span>}
<span class="line-num">443</span>   <span class="ruby-keyword">end</span>
<span class="line-num">444</span> 
<span class="line-num">445</span>   <span class="ruby-identifier">route_hash</span>= {}
<span class="line-num">446</span>   <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">routes</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">meth</span><span class="ruby-operator">|</span>
<span class="line-num">447</span>     <span class="ruby-identifier">route_meth</span> = <span class="ruby-node">&quot;#{meth.to_s.sub(/\Ahandle_/, &#39;&#39;)}_route&quot;</span>
<span class="line-num">448</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">route</span> = <span class="ruby-identifier">send</span>(<span class="ruby-identifier">route_meth</span>)
<span class="line-num">449</span>       <span class="ruby-identifier">route_hash</span>[<span class="ruby-node">&quot;/#{route}&quot;</span>] = <span class="ruby-identifier">meth</span>
<span class="line-num">450</span>     <span class="ruby-keyword">end</span>
<span class="line-num">451</span>   <span class="ruby-keyword">end</span>
<span class="line-num">452</span>   <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">route_hash</span> = <span class="ruby-identifier">route_hash</span>.<span class="ruby-identifier">freeze</span>
<span class="line-num">453</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-previous_password_ds'>
<a name='method-i-previous_password_ds'></a>
<div class='synopsis'>
<span class='name'>previous_password_ds</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-previous_password_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-previous_password_ds-source'>   <span class="ruby-comment"># File lib/rodauth/features/disallow_password_reuse.rb</span>
<span class="line-num">94</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">previous_password_ds</span>
<span class="line-num">95</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">previous_password_hash_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">previous_password_account_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>)
<span class="line-num">96</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-raises_uniqueness_violation-3F'>
<a name='method-i-raises_uniqueness_violation-3F'></a>
<div class='synopsis'>
<span class='name'>raises_uniqueness_violation?</span><span class='arguments'>(&block)</span>

</div>
<div class='description'>

<p>In cases where retrying on uniqueness violations cannot work, this will detect whether a uniqueness violation is raised by the block and return the exception if so. This method should be used if you don’t care about the exception itself.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-raises_uniqueness_violation-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-raises_uniqueness_violation-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">889</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">raises_uniqueness_violation?</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">890</span>   <span class="ruby-identifier">transaction</span>(<span class="ruby-value">:savepoint</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">:only</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">891</span>   <span class="ruby-keyword">false</span>
<span class="line-num">892</span> <span class="ruby-keyword">rescue</span> <span class="ruby-identifier">unique_constraint_violation_class</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">e</span>
<span class="line-num">893</span>   <span class="ruby-identifier">e</span>
<span class="line-num">894</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-random_key'>
<a name='method-i-random_key'></a>
<div class='synopsis'>
<span class='name'>random_key</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-random_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-random_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">678</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">random_key</span>
<span class="line-num">679</span>   <span class="ruby-constant">SecureRandom</span>.<span class="ruby-identifier">urlsafe_base64</span>(<span class="ruby-value">32</span>)
<span class="line-num">680</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-raw_param'>
<a name='method-i-raw_param'></a>
<div class='synopsis'>
<span class='name'>raw_param</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-raw_param-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-raw_param-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">525</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">raw_param</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">526</span>   <span class="ruby-identifier">request</span>.<span class="ruby-identifier">params</span>[<span class="ruby-identifier">key</span>]
<span class="line-num">527</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-recovery_code_match-3F'>
<a name='method-i-recovery_code_match-3F'></a>
<div class='synopsis'>
<span class='name'>recovery_code_match?</span><span class='arguments'>(code)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-recovery_code_match-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-recovery_code_match-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb</span>
<span class="line-num">160</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">recovery_code_match?</span>(<span class="ruby-identifier">code</span>)
<span class="line-num">161</span>   <span class="ruby-identifier">recovery_codes</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">s</span><span class="ruby-operator">|</span>
<span class="line-num">162</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">code</span>, <span class="ruby-identifier">s</span>)
<span class="line-num">163</span>       <span class="ruby-identifier">recovery_codes_ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">recovery_codes_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">code</span>).<span class="ruby-identifier">delete</span>
<span class="line-num">164</span>       <span class="ruby-keyword">if</span> <span class="ruby-identifier">recovery_codes_primary?</span>
<span class="line-num">165</span>         <span class="ruby-identifier">add_recovery_code</span>
<span class="line-num">166</span>       <span class="ruby-keyword">end</span>
<span class="line-num">167</span>       <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span>
<span class="line-num">168</span>     <span class="ruby-keyword">end</span>
<span class="line-num">169</span>   <span class="ruby-keyword">end</span>
<span class="line-num">170</span>   <span class="ruby-keyword">false</span>
<span class="line-num">171</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-recovery_codes_available-3F'>
<a name='method-i-recovery_codes_available-3F'></a>
<div class='synopsis'>
<span class='name'>recovery_codes_available?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-recovery_codes_available-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-recovery_codes_available-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb</span>
<span class="line-num">196</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">recovery_codes_available?</span>
<span class="line-num">197</span>   <span class="ruby-operator">!</span><span class="ruby-identifier">recovery_codes_ds</span>.<span class="ruby-identifier">empty?</span>
<span class="line-num">198</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-recovery_codes_ds'>
<a name='method-i-recovery_codes_ds'></a>
<div class='synopsis'>
<span class='name'>recovery_codes_ds</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-recovery_codes_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-recovery_codes_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb</span>
<span class="line-num">264</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">recovery_codes_ds</span>
<span class="line-num">265</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">recovery_codes_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">recovery_codes_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session_value</span>)
<span class="line-num">266</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-recovery_codes_primary-3F'>
<a name='method-i-recovery_codes_primary-3F'></a>
<div class='synopsis'>
<span class='name'>recovery_codes_primary?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-recovery_codes_primary-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-recovery_codes_primary-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb</span>
<span class="line-num">244</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">recovery_codes_primary?</span>
<span class="line-num">245</span>   (<span class="ruby-identifier">features</span> <span class="ruby-operator">&amp;</span> [<span class="ruby-value">:otp</span>, <span class="ruby-value">:sms_codes</span>, <span class="ruby-value">:webauthn</span>]).<span class="ruby-identifier">empty?</span>
<span class="line-num">246</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-recovery_codes_remove'>
<a name='method-i-recovery_codes_remove'></a>
<div class='synopsis'>
<span class='name'>recovery_codes_remove</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-recovery_codes_remove-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-recovery_codes_remove-source'>    <span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb</span>
<span class="line-num">156</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">recovery_codes_remove</span>
<span class="line-num">157</span>   <span class="ruby-identifier">recovery_codes_ds</span>.<span class="ruby-identifier">delete</span>
<span class="line-num">158</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-redirect'>
<a name='method-i-redirect'></a>
<div class='synopsis'>
<span class='name'>redirect</span><span class='arguments'>(path)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-redirect-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-redirect-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">655</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">redirect</span>(<span class="ruby-identifier">path</span>)
<span class="line-num">656</span>   <span class="ruby-identifier">request</span>.<span class="ruby-identifier">redirect</span>(<span class="ruby-identifier">path</span>)
<span class="line-num">657</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remember_key_ds'>
<a name='method-i-remember_key_ds'></a>
<div class='synopsis'>
<span class='name'>remember_key_ds</span><span class='arguments'>(id=account_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remember_key_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remember_key_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/remember.rb</span>
<span class="line-num">255</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remember_key_ds</span>(<span class="ruby-identifier">id</span>=<span class="ruby-identifier">account_id</span>)
<span class="line-num">256</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">remember_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">remember_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">id</span>)
<span class="line-num">257</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remember_login'>
<a name='method-i-remember_login'></a>
<div class='synopsis'>
<span class='name'>remember_login</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remember_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remember_login-source'>    <span class="ruby-comment"># File lib/rodauth/features/remember.rb</span>
<span class="line-num">132</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remember_login</span>
<span class="line-num">133</span>   <span class="ruby-identifier">get_remember_key</span>
<span class="line-num">134</span>   <span class="ruby-identifier">set_remember_cookie</span>
<span class="line-num">135</span>   <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">remember_deadline_extended_session_key</span>, <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_i</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">extend_remember_deadline?</span>
<span class="line-num">136</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remembered_session_id'>
<a name='method-i-remembered_session_id'></a>
<div class='synopsis'>
<span class='name'>remembered_session_id</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remembered_session_id-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remembered_session_id-source'>    <span class="ruby-comment"># File lib/rodauth/features/remember.rb</span>
<span class="line-num"> 91</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remembered_session_id</span>
<span class="line-num"> 92</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">cookie</span> = <span class="ruby-identifier">_get_remember_cookie</span>
<span class="line-num"> 93</span>   <span class="ruby-identifier">id</span>, <span class="ruby-identifier">key</span> = <span class="ruby-identifier">cookie</span>.<span class="ruby-identifier">split</span>(<span class="ruby-string">&#39;_&#39;</span>, <span class="ruby-value">2</span>)
<span class="line-num"> 94</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">id</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">key</span>
<span class="line-num"> 95</span> 
<span class="line-num"> 96</span>   <span class="ruby-identifier">actual</span>, <span class="ruby-identifier">deadline</span> = <span class="ruby-identifier">active_remember_key_ds</span>(<span class="ruby-identifier">id</span>).<span class="ruby-identifier">get</span>([<span class="ruby-identifier">remember_key_column</span>, <span class="ruby-identifier">remember_deadline_column</span>])
<span class="line-num"> 97</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">actual</span>
<span class="line-num"> 98</span> 
<span class="line-num"> 99</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">hmac_secret</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">valid</span> = <span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">compute_hmac</span>(<span class="ruby-identifier">actual</span>)))
<span class="line-num">100</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">hmac_secret_rotation?</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">valid</span> = <span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">compute_old_hmac</span>(<span class="ruby-identifier">actual</span>)))
<span class="line-num">101</span>       <span class="ruby-identifier">_set_remember_cookie</span>(<span class="ruby-identifier">id</span>, <span class="ruby-identifier">actual</span>, <span class="ruby-identifier">deadline</span>)
<span class="line-num">102</span>     <span class="ruby-keyword">elsif</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">raw_remember_token_deadline</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">raw_remember_token_deadline</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">deadline</span>))
<span class="line-num">103</span>       <span class="ruby-keyword">return</span>
<span class="line-num">104</span>     <span class="ruby-keyword">end</span>
<span class="line-num">105</span>   <span class="ruby-keyword">end</span>
<span class="line-num">106</span> 
<span class="line-num">107</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">valid</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">actual</span>)
<span class="line-num">108</span>     <span class="ruby-keyword">return</span>
<span class="line-num">109</span>   <span class="ruby-keyword">end</span>
<span class="line-num">110</span> 
<span class="line-num">111</span>   <span class="ruby-identifier">id</span>
<span class="line-num">112</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_active_session'>
<a name='method-i-remove_active_session'></a>
<div class='synopsis'>
<span class='name'>remove_active_session</span><span class='arguments'>(session_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_active_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_active_session-source'>   <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">92</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_active_session</span>(<span class="ruby-identifier">session_id</span>)
<span class="line-num">93</span>   <span class="ruby-identifier">active_sessions_ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">active_sessions_session_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session_id</span>).<span class="ruby-identifier">delete</span>
<span class="line-num">94</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_all_active_sessions'>
<a name='method-i-remove_all_active_sessions'></a>
<div class='synopsis'>
<span class='name'>remove_all_active_sessions</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_all_active_sessions-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_all_active_sessions-source'>   <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">96</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_all_active_sessions</span>
<span class="line-num">97</span>   <span class="ruby-identifier">active_sessions_ds</span>.<span class="ruby-identifier">delete</span>
<span class="line-num">98</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_all_active_sessions_except_current'>
<a name='method-i-remove_all_active_sessions_except_current'></a>
<div class='synopsis'>
<span class='name'>remove_all_active_sessions_except_current</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_all_active_sessions_except_current-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_all_active_sessions_except_current-source'>    <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">104</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_all_active_sessions_except_current</span> 
<span class="line-num">105</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">session_id</span> = <span class="ruby-identifier">session</span>[<span class="ruby-identifier">session_id_session_key</span>]
<span class="line-num">106</span>     <span class="ruby-identifier">remove_all_active_sessions_except_for</span>(<span class="ruby-identifier">session_id</span>)
<span class="line-num">107</span>   <span class="ruby-keyword">else</span>
<span class="line-num">108</span>     <span class="ruby-identifier">remove_all_active_sessions</span>
<span class="line-num">109</span>   <span class="ruby-keyword">end</span>
<span class="line-num">110</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_all_active_sessions_except_for'>
<a name='method-i-remove_all_active_sessions_except_for'></a>
<div class='synopsis'>
<span class='name'>remove_all_active_sessions_except_for</span><span class='arguments'>(session_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_all_active_sessions_except_for-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_all_active_sessions_except_for-source'>    <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">100</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_all_active_sessions_except_for</span>(<span class="ruby-identifier">session_id</span>)
<span class="line-num">101</span>   <span class="ruby-identifier">active_sessions_ds</span>.<span class="ruby-identifier">exclude</span>(<span class="ruby-identifier">active_sessions_session_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">compute_hmacs</span>(<span class="ruby-identifier">session_id</span>)).<span class="ruby-identifier">delete</span>
<span class="line-num">102</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_all_webauthn_keys_and_user_ids'>
<a name='method-i-remove_all_webauthn_keys_and_user_ids'></a>
<div class='synopsis'>
<span class='name'>remove_all_webauthn_keys_and_user_ids</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_all_webauthn_keys_and_user_ids-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_all_webauthn_keys_and_user_ids-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">381</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_all_webauthn_keys_and_user_ids</span>
<span class="line-num">382</span>   <span class="ruby-identifier">webauthn_user_ids_ds</span>.<span class="ruby-identifier">delete</span>
<span class="line-num">383</span>   <span class="ruby-identifier">webauthn_keys_ds</span>.<span class="ruby-identifier">delete</span>
<span class="line-num">384</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_current_session'>
<a name='method-i-remove_current_session'></a>
<div class='synopsis'>
<span class='name'>remove_current_session</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_current_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_current_session-source'>   <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">86</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_current_session</span>
<span class="line-num">87</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">session_id</span> = <span class="ruby-identifier">session</span>[<span class="ruby-identifier">session_id_session_key</span>]
<span class="line-num">88</span>     <span class="ruby-identifier">remove_active_session</span>(<span class="ruby-identifier">compute_hmacs</span>(<span class="ruby-identifier">session_id</span>))
<span class="line-num">89</span>   <span class="ruby-keyword">end</span>
<span class="line-num">90</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_email_auth_key'>
<a name='method-i-remove_email_auth_key'></a>
<div class='synopsis'>
<span class='name'>remove_email_auth_key</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_email_auth_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_email_auth_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/email_auth.rb</span>
<span class="line-num">127</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_email_auth_key</span>
<span class="line-num">128</span>   <span class="ruby-identifier">email_auth_ds</span>.<span class="ruby-identifier">delete</span>
<span class="line-num">129</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_inactive_sessions'>
<a name='method-i-remove_inactive_sessions'></a>
<div class='synopsis'>
<span class='name'>remove_inactive_sessions</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_inactive_sessions-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_inactive_sessions-source'>    <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">112</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_inactive_sessions</span>
<span class="line-num">113</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">cond</span> = <span class="ruby-identifier">inactive_session_cond</span>
<span class="line-num">114</span>     <span class="ruby-identifier">active_sessions_ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">cond</span>).<span class="ruby-identifier">delete</span>
<span class="line-num">115</span>   <span class="ruby-keyword">end</span>
<span class="line-num">116</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_jwt_refresh_token_key'>
<a name='method-i-remove_jwt_refresh_token_key'></a>
<div class='synopsis'>
<span class='name'>remove_jwt_refresh_token_key</span><span class='arguments'>(token)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_jwt_refresh_token_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_jwt_refresh_token_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/jwt_refresh.rb</span>
<span class="line-num">180</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_jwt_refresh_token_key</span>(<span class="ruby-identifier">token</span>)
<span class="line-num">181</span>   <span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">token_id</span>, <span class="ruby-identifier">_</span> = <span class="ruby-identifier">_account_refresh_token_split</span>(<span class="ruby-identifier">token</span>)
<span class="line-num">182</span>   <span class="ruby-identifier">jwt_refresh_token_account_token_ds</span>(<span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">token_id</span>).<span class="ruby-identifier">delete</span>
<span class="line-num">183</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_lockout_metadata'>
<a name='method-i-remove_lockout_metadata'></a>
<div class='synopsis'>
<span class='name'>remove_lockout_metadata</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_lockout_metadata-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_lockout_metadata-source'>    <span class="ruby-comment"># File lib/rodauth/features/lockout.rb</span>
<span class="line-num">274</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_lockout_metadata</span>
<span class="line-num">275</span>   <span class="ruby-identifier">account_login_failures_ds</span>.<span class="ruby-identifier">delete</span>
<span class="line-num">276</span>   <span class="ruby-identifier">account_lockouts_ds</span>.<span class="ruby-identifier">delete</span>
<span class="line-num">277</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_remember_key'>
<a name='method-i-remove_remember_key'></a>
<div class='synopsis'>
<span class='name'>remove_remember_key</span><span class='arguments'>(id=account_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_remember_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_remember_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/remember.rb</span>
<span class="line-num">170</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_remember_key</span>(<span class="ruby-identifier">id</span>=<span class="ruby-identifier">account_id</span>)
<span class="line-num">171</span>   <span class="ruby-identifier">remember_key_ds</span>(<span class="ruby-identifier">id</span>).<span class="ruby-identifier">delete</span>
<span class="line-num">172</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_reset_password_key'>
<a name='method-i-remove_reset_password_key'></a>
<div class='synopsis'>
<span class='name'>remove_reset_password_key</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_reset_password_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_reset_password_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/reset_password.rb</span>
<span class="line-num">180</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_reset_password_key</span>
<span class="line-num">181</span>   <span class="ruby-identifier">password_reset_ds</span>.<span class="ruby-identifier">delete</span>
<span class="line-num">182</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_session_value'>
<a name='method-i-remove_session_value'></a>
<div class='synopsis'>
<span class='name'>remove_session_value</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_session_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_session_value-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">947</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_session_value</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">948</span>   <span class="ruby-identifier">session</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">949</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_verify_account_key'>
<a name='method-i-remove_verify_account_key'></a>
<div class='synopsis'>
<span class='name'>remove_verify_account_key</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_verify_account_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_verify_account_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_account.rb</span>
<span class="line-num">167</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_verify_account_key</span>
<span class="line-num">168</span>   <span class="ruby-identifier">verify_account_ds</span>.<span class="ruby-identifier">delete</span>
<span class="line-num">169</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_verify_login_change_key'>
<a name='method-i-remove_verify_login_change_key'></a>
<div class='synopsis'>
<span class='name'>remove_verify_login_change_key</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_verify_login_change_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_verify_login_change_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb</span>
<span class="line-num">108</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_verify_login_change_key</span>
<span class="line-num">109</span>   <span class="ruby-identifier">verify_login_change_ds</span>.<span class="ruby-identifier">delete</span>
<span class="line-num">110</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-remove_webauthn_key'>
<a name='method-i-remove_webauthn_key'></a>
<div class='synopsis'>
<span class='name'>remove_webauthn_key</span><span class='arguments'>(webauthn_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-remove_webauthn_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-remove_webauthn_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">377</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">remove_webauthn_key</span>(<span class="ruby-identifier">webauthn_id</span>)
<span class="line-num">378</span>   <span class="ruby-identifier">webauthn_keys_ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">webauthn_keys_webauthn_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">webauthn_id</span>).<span class="ruby-identifier">delete</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
<span class="line-num">379</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-render'>
<a name='method-i-render'></a>
<div class='synopsis'>
<span class='name'>render</span><span class='arguments'>(page)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-render-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-render-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">429</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">render</span>(<span class="ruby-identifier">page</span>)
<span class="line-num">430</span>   <span class="ruby-identifier">_view</span>(<span class="ruby-value">:render</span>, <span class="ruby-identifier">page</span>)
<span class="line-num">431</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-render_multi_phase_login_forms'>
<a name='method-i-render_multi_phase_login_forms'></a>
<div class='synopsis'>
<span class='name'>render_multi_phase_login_forms</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-render_multi_phase_login_forms-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-render_multi_phase_login_forms-source'>    <span class="ruby-comment"># File lib/rodauth/features/login.rb</span>
<span class="line-num">138</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">render_multi_phase_login_forms</span>
<span class="line-num">139</span>   <span class="ruby-identifier">multi_phase_login_forms</span>.<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">_</span>, <span class="ruby-identifier">form</span>, <span class="ruby-identifier">_</span><span class="ruby-operator">|</span> <span class="ruby-identifier">form</span>}.<span class="ruby-identifier">join</span>(<span class="ruby-string">&quot;\n&quot;</span>)
<span class="line-num">140</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-request'>
<a name='method-i-request'></a>
<div class='synopsis'>
<span class='name'>request</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-request-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-request-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">153</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">request</span>
<span class="line-num">154</span>   <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">request</span>
<span class="line-num">155</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_account'>
<a name='method-i-require_account'></a>
<div class='synopsis'>
<span class='name'>require_account</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_account-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">374</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_account</span>
<span class="line-num">375</span>   <span class="ruby-identifier">require_authentication</span>
<span class="line-num">376</span>   <span class="ruby-identifier">require_account_session</span>
<span class="line-num">377</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_account_session'>
<a name='method-i-require_account_session'></a>
<div class='synopsis'>
<span class='name'>require_account_session</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_account_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_account_session-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">696</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_account_session</span>
<span class="line-num">697</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">account_from_session</span>
<span class="line-num">698</span>     <span class="ruby-identifier">clear_session</span>
<span class="line-num">699</span>     <span class="ruby-identifier">login_required</span>
<span class="line-num">700</span>   <span class="ruby-keyword">end</span>
<span class="line-num">701</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_authentication'>
<a name='method-i-require_authentication'></a>
<div class='synopsis'>
<span class='name'>require_authentication</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_authentication-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_authentication-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">370</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_authentication</span>
<span class="line-num">371</span>   <span class="ruby-identifier">require_login</span>
<span class="line-num">372</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_current_password'>
<a name='method-i-require_current_password'></a>
<div class='synopsis'>
<span class='name'>require_current_password</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_current_password-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_current_password-source'>   <span class="ruby-comment"># File lib/rodauth/features/password_expiration.rb</span>
<span class="line-num">61</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_current_password</span>
<span class="line-num">62</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">authenticated?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">password_expired?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">password_change_needed_redirect</span> <span class="ruby-operator">!=</span> <span class="ruby-identifier">request</span>.<span class="ruby-identifier">path_info</span>
<span class="line-num">63</span>     <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">password_expiration_error_flash</span>
<span class="line-num">64</span>     <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">password_change_needed_redirect</span>
<span class="line-num">65</span>   <span class="ruby-keyword">end</span>
<span class="line-num">66</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_http_basic_auth'>
<a name='method-i-require_http_basic_auth'></a>
<div class='synopsis'>
<span class='name'>require_http_basic_auth</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_http_basic_auth-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_http_basic_auth-source'>   <span class="ruby-comment"># File lib/rodauth/features/http_basic_auth.rb</span>
<span class="line-num">27</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_http_basic_auth</span>
<span class="line-num">28</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">http_basic_auth</span>
<span class="line-num">29</span>     <span class="ruby-identifier">set_http_basic_auth_error_response</span>
<span class="line-num">30</span>     <span class="ruby-identifier">return_response</span>
<span class="line-num">31</span>   <span class="ruby-keyword">end</span>
<span class="line-num">32</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_login'>
<a name='method-i-require_login'></a>
<div class='synopsis'>
<span class='name'>require_login</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_login-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">362</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_login</span>
<span class="line-num">363</span>   <span class="ruby-identifier">login_required</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">logged_in?</span>
<span class="line-num">364</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_login_confirmation-3F'>
<a name='method-i-require_login_confirmation-3F'></a>
<div class='synopsis'>
<span class='name'>require_login_confirmation?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_login_confirmation-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_login_confirmation-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_account.rb</span>
<span class="line-num">159</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_login_confirmation?</span>
<span class="line-num">160</span>   <span class="ruby-keyword">false</span>
<span class="line-num">161</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_login_redirect'>
<a name='method-i-require_login_redirect'></a>
<div class='synopsis'>
<span class='name'>require_login_redirect</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_login_redirect-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_login_redirect-source'>    <span class="ruby-comment"># File lib/rodauth/features/login.rb</span>
<span class="line-num">142</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_login_redirect</span>
<span class="line-num">143</span>   <span class="ruby-identifier">login_path</span>
<span class="line-num">144</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_otp_setup'>
<a name='method-i-require_otp_setup'></a>
<div class='synopsis'>
<span class='name'>require_otp_setup</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_otp_setup-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_otp_setup-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">234</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_otp_setup</span>
<span class="line-num">235</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">otp_exists?</span>
<span class="line-num">236</span>     <span class="ruby-identifier">set_redirect_error_status</span>(<span class="ruby-identifier">two_factor_not_setup_error_status</span>)
<span class="line-num">237</span>     <span class="ruby-identifier">set_error_reason</span> <span class="ruby-value">:two_factor_not_setup</span>
<span class="line-num">238</span>     <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">two_factor_not_setup_error_flash</span>
<span class="line-num">239</span>     <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">two_factor_need_setup_redirect</span>
<span class="line-num">240</span>   <span class="ruby-keyword">end</span>
<span class="line-num">241</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_password_authentication'>
<a name='method-i-require_password_authentication'></a>
<div class='synopsis'>
<span class='name'>require_password_authentication</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_password_authentication-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_password_authentication-source'>   <span class="ruby-comment"># File lib/rodauth/features/confirm_password.rb</span>
<span class="line-num">51</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_password_authentication</span>
<span class="line-num">52</span>   <span class="ruby-identifier">require_login</span>
<span class="line-num">53</span> 
<span class="line-num">54</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">require_password_authentication?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">has_password?</span>
<span class="line-num">55</span>     <span class="ruby-identifier">set_redirect_error_status</span>(<span class="ruby-identifier">password_authentication_required_error_status</span>)
<span class="line-num">56</span>     <span class="ruby-identifier">set_error_reason</span> <span class="ruby-value">:password_authentication_required</span>
<span class="line-num">57</span>     <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">password_authentication_required_error_flash</span>
<span class="line-num">58</span>     <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">confirm_password_redirect_session_key</span>, <span class="ruby-identifier">request</span>.<span class="ruby-identifier">fullpath</span>)
<span class="line-num">59</span>     <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">password_authentication_required_redirect</span>
<span class="line-num">60</span>   <span class="ruby-keyword">end</span>
<span class="line-num">61</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_password_authentication-3F'>
<a name='method-i-require_password_authentication-3F'></a>
<div class='synopsis'>
<span class='name'>require_password_authentication?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_password_authentication-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_password_authentication-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/confirm_password.rb</span>
<span class="line-num">87</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_password_authentication?</span>
<span class="line-num">88</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword">super</span>
<span class="line-num">89</span>   <span class="ruby-operator">!</span><span class="ruby-identifier">authenticated_by</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-string">&#39;password&#39;</span>)
<span class="line-num">90</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_response'>
<a name='method-i-require_response'></a>
<div class='synopsis'>
<span class='name'>require_response</span><span class='arguments'>(meth)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_response-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_response-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">938</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_response</span>(<span class="ruby-identifier">meth</span>)
<span class="line-num">939</span>   <span class="ruby-identifier">send</span>(<span class="ruby-identifier">meth</span>)
<span class="line-num">940</span>   <span class="ruby-identifier">raise</span> <span class="ruby-constant">ConfigurationError</span>, <span class="ruby-node">&quot;#{meth.to_s.sub(/\A_/, &#39;&#39;)} overridden without returning a response (should use redirect or request.halt).&quot;</span>
<span class="line-num">941</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_sms_available'>
<a name='method-i-require_sms_available'></a>
<div class='synopsis'>
<span class='name'>require_sms_available</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_sms_available-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_sms_available-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">337</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_sms_available</span>
<span class="line-num">338</span>   <span class="ruby-identifier">require_sms_setup</span>
<span class="line-num">339</span> 
<span class="line-num">340</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">sms_locked_out?</span>
<span class="line-num">341</span>     <span class="ruby-identifier">set_redirect_error_status</span>(<span class="ruby-identifier">lockout_error_status</span>)
<span class="line-num">342</span>     <span class="ruby-identifier">set_error_reason</span> <span class="ruby-value">:sms_locked_out</span>
<span class="line-num">343</span>     <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">sms_lockout_error_flash</span>
<span class="line-num">344</span>     <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">sms_lockout_redirect</span>
<span class="line-num">345</span>   <span class="ruby-keyword">end</span>
<span class="line-num">346</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_sms_not_setup'>
<a name='method-i-require_sms_not_setup'></a>
<div class='synopsis'>
<span class='name'>require_sms_not_setup</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_sms_not_setup-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_sms_not_setup-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">328</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_sms_not_setup</span>
<span class="line-num">329</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">sms_setup?</span>
<span class="line-num">330</span>     <span class="ruby-identifier">set_redirect_error_status</span>(<span class="ruby-identifier">sms_already_setup_error_status</span>)
<span class="line-num">331</span>     <span class="ruby-identifier">set_error_reason</span> <span class="ruby-value">:sms_already_setup</span>
<span class="line-num">332</span>     <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">sms_already_setup_error_flash</span>
<span class="line-num">333</span>     <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">sms_already_setup_redirect</span>
<span class="line-num">334</span>   <span class="ruby-keyword">end</span>
<span class="line-num">335</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_sms_setup'>
<a name='method-i-require_sms_setup'></a>
<div class='synopsis'>
<span class='name'>require_sms_setup</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_sms_setup-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_sms_setup-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">319</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_sms_setup</span>
<span class="line-num">320</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">sms_setup?</span>
<span class="line-num">321</span>     <span class="ruby-identifier">set_redirect_error_status</span>(<span class="ruby-identifier">two_factor_not_setup_error_status</span>)
<span class="line-num">322</span>     <span class="ruby-identifier">set_error_reason</span> <span class="ruby-value">:sms_not_setup</span>
<span class="line-num">323</span>     <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">sms_not_setup_error_flash</span>
<span class="line-num">324</span>     <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">sms_needs_setup_redirect</span>
<span class="line-num">325</span>   <span class="ruby-keyword">end</span>
<span class="line-num">326</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_two_factor_authenticated'>
<a name='method-i-require_two_factor_authenticated'></a>
<div class='synopsis'>
<span class='name'>require_two_factor_authenticated</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_two_factor_authenticated-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_two_factor_authenticated-source'>    <span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb</span>
<span class="line-num">156</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_two_factor_authenticated</span>
<span class="line-num">157</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">two_factor_authenticated?</span>
<span class="line-num">158</span>     <span class="ruby-keyword">if</span> <span class="ruby-identifier">two_factor_auth_return_to_requested_location?</span>
<span class="line-num">159</span>       <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">two_factor_auth_redirect_session_key</span>, <span class="ruby-identifier">request</span>.<span class="ruby-identifier">fullpath</span>)
<span class="line-num">160</span>     <span class="ruby-keyword">end</span>
<span class="line-num">161</span>     <span class="ruby-identifier">set_redirect_error_status</span>(<span class="ruby-identifier">two_factor_need_authentication_error_status</span>)
<span class="line-num">162</span>     <span class="ruby-identifier">set_error_reason</span> <span class="ruby-value">:two_factor_need_authentication</span>
<span class="line-num">163</span>     <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">two_factor_need_authentication_error_flash</span>
<span class="line-num">164</span>     <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">two_factor_auth_required_redirect</span>
<span class="line-num">165</span>   <span class="ruby-keyword">end</span>
<span class="line-num">166</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_two_factor_not_authenticated'>
<a name='method-i-require_two_factor_not_authenticated'></a>
<div class='synopsis'>
<span class='name'>require_two_factor_not_authenticated</span><span class='arguments'>(auth_type = nil)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_two_factor_not_authenticated-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_two_factor_not_authenticated-source'>    <span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb</span>
<span class="line-num">147</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_two_factor_not_authenticated</span>(<span class="ruby-identifier">auth_type</span> = <span class="ruby-keyword">nil</span>)
<span class="line-num">148</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">two_factor_authenticated?</span> <span class="ruby-operator">||</span> (<span class="ruby-identifier">auth_type</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">two_factor_login_type_match?</span>(<span class="ruby-identifier">auth_type</span>))
<span class="line-num">149</span>     <span class="ruby-identifier">set_redirect_error_status</span>(<span class="ruby-identifier">two_factor_already_authenticated_error_status</span>)
<span class="line-num">150</span>     <span class="ruby-identifier">set_error_reason</span> <span class="ruby-value">:two_factor_already_authenticated</span>
<span class="line-num">151</span>     <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">two_factor_already_authenticated_error_flash</span>
<span class="line-num">152</span>     <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">two_factor_already_authenticated_redirect</span>
<span class="line-num">153</span>   <span class="ruby-keyword">end</span>
<span class="line-num">154</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_two_factor_setup'>
<a name='method-i-require_two_factor_setup'></a>
<div class='synopsis'>
<span class='name'>require_two_factor_setup</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_two_factor_setup-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_two_factor_setup-source'>    <span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb</span>
<span class="line-num">135</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_two_factor_setup</span>
<span class="line-num">136</span>   <span class="ruby-comment"># Avoid database query if already authenticated via 2nd factor</span>
<span class="line-num">137</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">two_factor_authenticated?</span>
<span class="line-num">138</span> 
<span class="line-num">139</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">uses_two_factor_authentication?</span>
<span class="line-num">140</span> 
<span class="line-num">141</span>   <span class="ruby-identifier">set_redirect_error_status</span>(<span class="ruby-identifier">two_factor_not_setup_error_status</span>)
<span class="line-num">142</span>   <span class="ruby-identifier">set_error_reason</span> <span class="ruby-value">:two_factor_not_setup</span>
<span class="line-num">143</span>   <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">two_factor_not_setup_error_flash</span>
<span class="line-num">144</span>   <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">two_factor_need_setup_redirect</span>
<span class="line-num">145</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-require_webauthn_setup'>
<a name='method-i-require_webauthn_setup'></a>
<div class='synopsis'>
<span class='name'>require_webauthn_setup</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-require_webauthn_setup-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-require_webauthn_setup-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">390</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">require_webauthn_setup</span>
<span class="line-num">391</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">webauthn_setup?</span>
<span class="line-num">392</span>     <span class="ruby-identifier">set_redirect_error_status</span>(<span class="ruby-identifier">webauthn_not_setup_error_status</span>)
<span class="line-num">393</span>     <span class="ruby-identifier">set_error_reason</span> <span class="ruby-value">:webauthn_not_setup</span>
<span class="line-num">394</span>     <span class="ruby-identifier">set_redirect_error_flash</span> <span class="ruby-identifier">webauthn_not_setup_error_flash</span>
<span class="line-num">395</span>     <span class="ruby-identifier">redirect</span> <span class="ruby-identifier">two_factor_need_setup_redirect</span>
<span class="line-num">396</span>   <span class="ruby-keyword">end</span>
<span class="line-num">397</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-rescue_jwt_payload'>
<a name='method-i-rescue_jwt_payload'></a>
<div class='synopsis'>
<span class='name'>rescue_jwt_payload</span><span class='arguments'>(_)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-rescue_jwt_payload-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-rescue_jwt_payload-source'>    <span class="ruby-comment"># File lib/rodauth/features/jwt.rb</span>
<span class="line-num">129</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">rescue_jwt_payload</span>(<span class="ruby-identifier">_</span>)
<span class="line-num">130</span>   <span class="ruby-ivar">@jwt_payload</span> = <span class="ruby-keyword">false</span>
<span class="line-num">131</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-reset_password_email_link'>
<a name='method-i-reset_password_email_link'></a>
<div class='synopsis'>
<span class='name'>reset_password_email_link</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-reset_password_email_link-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-reset_password_email_link-source'>    <span class="ruby-comment"># File lib/rodauth/features/reset_password.rb</span>
<span class="line-num">188</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reset_password_email_link</span>
<span class="line-num">189</span>   <span class="ruby-identifier">token_link</span>(<span class="ruby-identifier">reset_password_route</span>, <span class="ruby-identifier">reset_password_key_param</span>, <span class="ruby-identifier">reset_password_key_value</span>)
<span class="line-num">190</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-reset_password_email_recently_sent-3F'>
<a name='method-i-reset_password_email_recently_sent-3F'></a>
<div class='synopsis'>
<span class='name'>reset_password_email_recently_sent?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-reset_password_email_recently_sent-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-reset_password_email_recently_sent-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/reset_password.rb</span>
<span class="line-num">210</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reset_password_email_recently_sent?</span>
<span class="line-num">211</span>   (<span class="ruby-identifier">email_last_sent</span> = <span class="ruby-identifier">get_reset_password_email_last_sent</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">email_last_sent</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">reset_password_skip_resend_email_within</span>)
<span class="line-num">212</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-reset_password_key_insert_hash'>
<a name='method-i-reset_password_key_insert_hash'></a>
<div class='synopsis'>
<span class='name'>reset_password_key_insert_hash</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-reset_password_key_insert_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-reset_password_key_insert_hash-source'>    <span class="ruby-comment"># File lib/rodauth/features/reset_password.rb</span>
<span class="line-num">246</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reset_password_key_insert_hash</span>
<span class="line-num">247</span>   <span class="ruby-identifier">hash</span> = {<span class="ruby-identifier">reset_password_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">reset_password_key_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">reset_password_key_value</span>}
<span class="line-num">248</span>   <span class="ruby-identifier">set_deadline_value</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">reset_password_deadline_column</span>, <span class="ruby-identifier">reset_password_deadline_interval</span>)
<span class="line-num">249</span>   <span class="ruby-identifier">hash</span>
<span class="line-num">250</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-reset_password_request_for_unverified_account'>
<a name='method-i-reset_password_request_for_unverified_account'></a>
<div class='synopsis'>
<span class='name'>reset_password_request_for_unverified_account</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-reset_password_request_for_unverified_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-reset_password_request_for_unverified_account-source'>    <span class="ruby-comment"># File lib/rodauth/features/reset_password.rb</span>
<span class="line-num">176</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reset_password_request_for_unverified_account</span>
<span class="line-num">177</span>   <span class="ruby-identifier">throw_error_reason</span>(<span class="ruby-value">:unverified_account</span>, <span class="ruby-identifier">unopen_account_error_status</span>, <span class="ruby-identifier">login_param</span>, <span class="ruby-identifier">unverified_account_message</span>)
<span class="line-num">178</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-reset_single_session_key'>
<a name='method-i-reset_single_session_key'></a>
<div class='synopsis'>
<span class='name'>reset_single_session_key</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-reset_single_session_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-reset_single_session_key-source'>   <span class="ruby-comment"># File lib/rodauth/features/single_session.rb</span>
<span class="line-num">22</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">reset_single_session_key</span>
<span class="line-num">23</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">logged_in?</span>
<span class="line-num">24</span>     <span class="ruby-identifier">single_session_ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">single_session_key_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">random_key</span>)
<span class="line-num">25</span>   <span class="ruby-keyword">end</span>
<span class="line-num">26</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-response'>
<a name='method-i-response'></a>
<div class='synopsis'>
<span class='name'>response</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-response-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-response-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">157</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">response</span>
<span class="line-num">158</span>   <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">response</span>
<span class="line-num">159</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-retry_on_uniqueness_violation'>
<a name='method-i-retry_on_uniqueness_violation'></a>
<div class='synopsis'>
<span class='name'>retry_on_uniqueness_violation</span><span class='arguments'>(&block)</span>

</div>
<div class='description'>

<p>This is used to avoid race conditions when using the pattern of inserting when an update affects no rows.  In such cases, if a row is inserted between the update and the insert, the insert will fail with a uniqueness error, but retrying will work.  It is possible for it to fail again, but only if the row is deleted before the update and readded before the insert, which is very unlikely to happen.  In such cases, raising an exception is acceptable.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-retry_on_uniqueness_violation-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-retry_on_uniqueness_violation-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">880</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">retry_on_uniqueness_violation</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">881</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">raises_uniqueness_violation?</span>(<span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">882</span>     <span class="ruby-keyword">yield</span>
<span class="line-num">883</span>   <span class="ruby-keyword">end</span>
<span class="line-num">884</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-return_json_response'>
<a name='method-i-return_json_response'></a>
<div class='synopsis'>
<span class='name'>return_json_response</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-return_json_response-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-return_json_response-source'>    <span class="ruby-comment"># File lib/rodauth/features/json.rb</span>
<span class="line-num">206</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">return_json_response</span>
<span class="line-num">207</span>   <span class="ruby-identifier">_return_json_response</span>
<span class="line-num">208</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-return_response'>
<a name='method-i-return_response'></a>
<div class='synopsis'>
<span class='name'>return_response</span><span class='arguments'>(body=nil)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-return_response-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-return_response-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">659</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">return_response</span>(<span class="ruby-identifier">body</span>=<span class="ruby-keyword">nil</span>)
<span class="line-num">660</span>   <span class="ruby-identifier">response</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">body</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">body</span>
<span class="line-num">661</span>   <span class="ruby-identifier">request</span>.<span class="ruby-identifier">halt</span>
<span class="line-num">662</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-route-21'>
<a name='method-i-route-21'></a>
<div class='synopsis'>
<span class='name'>route!</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-route-21-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-route-21-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">169</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">route!</span>
<span class="line-num">170</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">meth</span> = <span class="ruby-keyword">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">route_hash</span>[<span class="ruby-identifier">request</span>.<span class="ruby-identifier">remaining_path</span>]
<span class="line-num">171</span>     <span class="ruby-identifier">send</span>(<span class="ruby-identifier">meth</span>)
<span class="line-num">172</span>   <span class="ruby-keyword">end</span>
<span class="line-num">173</span> 
<span class="line-num">174</span>   <span class="ruby-keyword">nil</span>
<span class="line-num">175</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-route_path'>
<a name='method-i-route_path'></a>
<div class='synopsis'>
<span class='name'>route_path</span><span class='arguments'>(route, opts={})</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-route_path-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-route_path-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">664</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">route_path</span>(<span class="ruby-identifier">route</span>, <span class="ruby-identifier">opts</span>={})
<span class="line-num">665</span>   <span class="ruby-identifier">path</span>  = <span class="ruby-node">&quot;#{prefix}/#{route}&quot;</span>
<span class="line-num">666</span>   <span class="ruby-identifier">path</span> <span class="ruby-operator">+=</span> <span class="ruby-node">&quot;?#{Rack::Utils.build_nested_query(opts)}&quot;</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">empty?</span>
<span class="line-num">667</span>   <span class="ruby-identifier">path</span>
<span class="line-num">668</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-route_url'>
<a name='method-i-route_url'></a>
<div class='synopsis'>
<span class='name'>route_url</span><span class='arguments'>(route, opts={})</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-route_url-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-route_url-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">670</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">route_url</span>(<span class="ruby-identifier">route</span>, <span class="ruby-identifier">opts</span>={})
<span class="line-num">671</span>   <span class="ruby-node">&quot;#{base_url}#{route_path(route, opts)}&quot;</span>
<span class="line-num">672</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-save_account'>
<a name='method-i-save_account'></a>
<div class='synopsis'>
<span class='name'>save_account</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-save_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-save_account-source'>    <span class="ruby-comment"># File lib/rodauth/features/create_account.rb</span>
<span class="line-num">100</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">save_account</span>
<span class="line-num">101</span>   <span class="ruby-identifier">id</span> = <span class="ruby-keyword">nil</span>
<span class="line-num">102</span>   <span class="ruby-identifier">raised</span> = <span class="ruby-identifier">raises_uniqueness_violation?</span>{<span class="ruby-identifier">id</span> = <span class="ruby-identifier">db</span>[<span class="ruby-identifier">accounts_table</span>].<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">account</span>)}
<span class="line-num">103</span> 
<span class="line-num">104</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">raised</span>
<span class="line-num">105</span>     <span class="ruby-identifier">set_login_requirement_error_message</span>(<span class="ruby-value">:already_an_account_with_this_login</span>, <span class="ruby-identifier">already_an_account_with_this_login_message</span>)
<span class="line-num">106</span>   <span class="ruby-keyword">end</span>
<span class="line-num">107</span> 
<span class="line-num">108</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">id</span>
<span class="line-num">109</span>     <span class="ruby-identifier">account</span>[<span class="ruby-identifier">account_id_column</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">id</span>
<span class="line-num">110</span>   <span class="ruby-keyword">end</span>
<span class="line-num">111</span> 
<span class="line-num">112</span>   <span class="ruby-identifier">id</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">raised</span>
<span class="line-num">113</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-send_email'>
<a name='method-i-send_email'></a>
<div class='synopsis'>
<span class='name'>send_email</span><span class='arguments'>(email)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-send_email-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-send_email-source'>   <span class="ruby-comment"># File lib/rodauth/features/email_base.rb</span>
<span class="line-num">36</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">send_email</span>(<span class="ruby-identifier">email</span>)
<span class="line-num">37</span>   <span class="ruby-identifier">email</span>.<span class="ruby-identifier">deliver!</span>
<span class="line-num">38</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-send_verify_login_change_email'>
<a name='method-i-send_verify_login_change_email'></a>
<div class='synopsis'>
<span class='name'>send_verify_login_change_email</span><span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-send_verify_login_change_email-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-send_verify_login_change_email-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb</span>
<span class="line-num">124</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">send_verify_login_change_email</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">125</span>   <span class="ruby-identifier">send_email</span>(<span class="ruby-identifier">create_verify_login_change_email</span>(<span class="ruby-identifier">login</span>))
<span class="line-num">126</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-serialize_audit_log_metadata'>
<a name='method-i-serialize_audit_log_metadata'></a>
<div class='synopsis'>
<span class='name'>serialize_audit_log_metadata</span><span class='arguments'>(metadata)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-serialize_audit_log_metadata-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-serialize_audit_log_metadata-source'>   <span class="ruby-comment"># File lib/rodauth/features/audit_logging.rb</span>
<span class="line-num">55</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">serialize_audit_log_metadata</span>(<span class="ruby-identifier">metadata</span>)
<span class="line-num">56</span>   <span class="ruby-identifier">metadata</span>.<span class="ruby-identifier">to_json</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">metadata</span>.<span class="ruby-identifier">nil?</span>
<span class="line-num">57</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-session'>
<a name='method-i-session'></a>
<div class='synopsis'>
<span class='name'>session</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-session-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">161</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">session</span>
<span class="line-num">162</span>   <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">session</span>
<span class="line-num">163</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-session_inactivity_deadline_condition'>
<a name='method-i-session_inactivity_deadline_condition'></a>
<div class='synopsis'>
<span class='name'>session_inactivity_deadline_condition</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-session_inactivity_deadline_condition-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-session_inactivity_deadline_condition-source'>    <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">176</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">session_inactivity_deadline_condition</span>
<span class="line-num">177</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">deadline</span> = <span class="ruby-identifier">session_inactivity_deadline</span>
<span class="line-num">178</span>     <span class="ruby-constant">Sequel</span>[<span class="ruby-identifier">active_sessions_last_use_column</span>] <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">date_sub</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>, <span class="ruby-value">seconds:</span> <span class="ruby-identifier">deadline</span>)
<span class="line-num">179</span>   <span class="ruby-keyword">end</span>
<span class="line-num">180</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-session_jwt'>
<a name='method-i-session_jwt'></a>
<div class='synopsis'>
<span class='name'>session_jwt</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-session_jwt-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-session_jwt-source'>   <span class="ruby-comment"># File lib/rodauth/features/jwt.rb</span>
<span class="line-num">74</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">session_jwt</span>
<span class="line-num">75</span>   <span class="ruby-constant">JWT</span>.<span class="ruby-identifier">encode</span>(<span class="ruby-identifier">jwt_session_hash</span>, <span class="ruby-identifier">jwt_secret</span>, <span class="ruby-identifier">jwt_algorithm</span>)
<span class="line-num">76</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-session_lifetime_deadline_condition'>
<a name='method-i-session_lifetime_deadline_condition'></a>
<div class='synopsis'>
<span class='name'>session_lifetime_deadline_condition</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-session_lifetime_deadline_condition-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-session_lifetime_deadline_condition-source'>    <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">182</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">session_lifetime_deadline_condition</span>
<span class="line-num">183</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">deadline</span> = <span class="ruby-identifier">session_lifetime_deadline</span>
<span class="line-num">184</span>     <span class="ruby-constant">Sequel</span>[<span class="ruby-identifier">active_sessions_created_at_column</span>] <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">date_sub</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>, <span class="ruby-value">seconds:</span> <span class="ruby-identifier">deadline</span>)
<span class="line-num">185</span>   <span class="ruby-keyword">end</span>
<span class="line-num">186</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-session_value'>
<a name='method-i-session_value'></a>
<div class='synopsis'>
<span class='name'>session_value</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-session_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-session_value-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">276</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">session_value</span>
<span class="line-num">277</span>   <span class="ruby-identifier">session</span>[<span class="ruby-identifier">session_key</span>]
<span class="line-num">278</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_deadline_value'>
<a name='method-i-set_deadline_value'></a>
<div class='synopsis'>
<span class='name'>set_deadline_value</span><span class='arguments'>(hash, column, interval)</span>

</div>
<div class='description'>

<p>This is needed on MySQL, which doesn’t support non constant defaults other than CURRENT_TIMESTAMP.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_deadline_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_deadline_value-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">916</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_deadline_value</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">column</span>, <span class="ruby-identifier">interval</span>)
<span class="line-num">917</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">set_deadline_values?</span>
<span class="line-num">918</span>     <span class="ruby-comment"># :nocov:</span>
<span class="line-num">919</span>     <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">column</span>] = <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">date_add</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>, <span class="ruby-identifier">interval</span>)
<span class="line-num">920</span>     <span class="ruby-comment"># :nocov:</span>
<span class="line-num">921</span>   <span class="ruby-keyword">end</span>
<span class="line-num">922</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_deadline_values-3F'>
<a name='method-i-set_deadline_values-3F'></a>
<div class='synopsis'>
<span class='name'>set_deadline_values?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_deadline_values-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_deadline_values-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">746</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_deadline_values?</span>
<span class="line-num">747</span>   <span class="ruby-identifier">db</span>.<span class="ruby-identifier">database_type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:mysql</span>
<span class="line-num">748</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_email_auth_email_last_sent'>
<a name='method-i-set_email_auth_email_last_sent'></a>
<div class='synopsis'>
<span class='name'>set_email_auth_email_last_sent</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_email_auth_email_last_sent-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_email_auth_email_last_sent-source'>    <span class="ruby-comment"># File lib/rodauth/features/email_auth.rb</span>
<span class="line-num">115</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_email_auth_email_last_sent</span>
<span class="line-num">116</span>    <span class="ruby-identifier">email_auth_ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">email_auth_email_last_sent_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">email_auth_email_last_sent_column</span>
<span class="line-num">117</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_error_flash'>
<a name='method-i-set_error_flash'></a>
<div class='synopsis'>
<span class='name'>set_error_flash</span><span class='arguments'>(message)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_error_flash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_error_flash-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">346</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_error_flash</span>(<span class="ruby-identifier">message</span>)
<span class="line-num">347</span>   <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-identifier">flash_error_key</span>] = <span class="ruby-identifier">message</span>
<span class="line-num">348</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_error_reason'>
<a name='method-i-set_error_reason'></a>
<div class='synopsis'>
<span class='name'>set_error_reason</span><span class='arguments'>(reason)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_error_reason-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_error_reason-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">734</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_error_reason</span>(<span class="ruby-identifier">reason</span>)
<span class="line-num">735</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_expired'>
<a name='method-i-set_expired'></a>
<div class='synopsis'>
<span class='name'>set_expired</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_expired-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_expired-source'>   <span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb</span>
<span class="line-num">49</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_expired</span>
<span class="line-num">50</span>   <span class="ruby-identifier">update_activity</span>(<span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">account_activity_expired_column</span>)
<span class="line-num">51</span>   <span class="ruby-identifier">after_account_expiration</span>
<span class="line-num">52</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_field_error'>
<a name='method-i-set_field_error'></a>
<div class='synopsis'>
<span class='name'>set_field_error</span><span class='arguments'>(field, error)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_field_error-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_field_error-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">177</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_field_error</span>(<span class="ruby-identifier">field</span>, <span class="ruby-identifier">error</span>)
<span class="line-num">178</span>   (<span class="ruby-ivar">@field_errors</span> <span class="ruby-operator">||=</span> {})[<span class="ruby-identifier">field</span>] = <span class="ruby-identifier">error</span>
<span class="line-num">179</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_http_basic_auth_error_response'>
<a name='method-i-set_http_basic_auth_error_response'></a>
<div class='synopsis'>
<span class='name'>set_http_basic_auth_error_response</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_http_basic_auth_error_response-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_http_basic_auth_error_response-source'>   <span class="ruby-comment"># File lib/rodauth/features/http_basic_auth.rb</span>
<span class="line-num">74</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_http_basic_auth_error_response</span>
<span class="line-num">75</span>   <span class="ruby-identifier">response</span>.<span class="ruby-identifier">status</span> = <span class="ruby-value">401</span>
<span class="line-num">76</span>   <span class="ruby-identifier">set_response_header</span>(<span class="ruby-string">&quot;www-authenticate&quot;</span>, <span class="ruby-node">&quot;Basic realm=\&quot;#{http_basic_auth_realm}\&quot;&quot;</span>)
<span class="line-num">77</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_jwt'>
<a name='method-i-set_jwt'></a>
<div class='synopsis'>
<span class='name'>set_jwt</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_jwt-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_jwt-source'>    <span class="ruby-comment"># File lib/rodauth/features/jwt.rb</span>
<span class="line-num">150</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_jwt</span>
<span class="line-num">151</span>   <span class="ruby-identifier">set_jwt_token</span>(<span class="ruby-identifier">session_jwt</span>)
<span class="line-num">152</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_jwt_refresh_token_hmac_session_key'>
<a name='method-i-set_jwt_refresh_token_hmac_session_key'></a>
<div class='synopsis'>
<span class='name'>set_jwt_refresh_token_hmac_session_key</span><span class='arguments'>(token)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_jwt_refresh_token_hmac_session_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_jwt_refresh_token_hmac_session_key-source'>    <span class="ruby-comment"># File lib/rodauth/features/jwt_refresh.rb</span>
<span class="line-num">196</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_jwt_refresh_token_hmac_session_key</span>(<span class="ruby-identifier">token</span>)
<span class="line-num">197</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">allow_refresh_with_expired_jwt_access_token?</span>
<span class="line-num">198</span>     <span class="ruby-identifier">key</span> = <span class="ruby-identifier">_account_refresh_token_split</span>(<span class="ruby-identifier">token</span>).<span class="ruby-identifier">last</span>
<span class="line-num">199</span>     <span class="ruby-identifier">data</span> = <span class="ruby-identifier">random_key</span>
<span class="line-num">200</span>     <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">jwt_refresh_token_data_session_key</span>, <span class="ruby-identifier">data</span>)
<span class="line-num">201</span>     <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">jwt_refresh_token_hmac_session_key</span>, <span class="ruby-identifier">compute_hmac</span>(<span class="ruby-identifier">data</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">key</span>))
<span class="line-num">202</span>   <span class="ruby-keyword">end</span>
<span class="line-num">203</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_jwt_token'>
<a name='method-i-set_jwt_token'></a>
<div class='synopsis'>
<span class='name'>set_jwt_token</span><span class='arguments'>(token)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_jwt_token-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_jwt_token-source'>   <span class="ruby-comment"># File lib/rodauth/features/jwt.rb</span>
<span class="line-num">86</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_jwt_token</span>(<span class="ruby-identifier">token</span>)
<span class="line-num">87</span>   <span class="ruby-identifier">set_response_header</span>(<span class="ruby-string">&#39;authorization&#39;</span>, <span class="ruby-identifier">token</span>)
<span class="line-num">88</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_last_password_entry'>
<a name='method-i-set_last_password_entry'></a>
<div class='synopsis'>
<span class='name'>set_last_password_entry</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_last_password_entry-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_last_password_entry-source'>   <span class="ruby-comment"># File lib/rodauth/features/password_grace_period.rb</span>
<span class="line-num">44</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_last_password_entry</span>
<span class="line-num">45</span>   <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">last_password_entry_session_key</span>, <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_i</span>)
<span class="line-num">46</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_login_requirement_error_message'>
<a name='method-i-set_login_requirement_error_message'></a>
<div class='synopsis'>
<span class='name'>set_login_requirement_error_message</span><span class='arguments'>(reason, message)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_login_requirement_error_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_login_requirement_error_message-source'>    <span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb</span>
<span class="line-num">125</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_login_requirement_error_message</span>(<span class="ruby-identifier">reason</span>, <span class="ruby-identifier">message</span>)
<span class="line-num">126</span>   <span class="ruby-identifier">set_error_reason</span>(<span class="ruby-identifier">reason</span>)
<span class="line-num">127</span>   <span class="ruby-ivar">@login_requirement_message</span> = <span class="ruby-identifier">message</span>
<span class="line-num">128</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_new_account_password'>
<a name='method-i-set_new_account_password'></a>
<div class='synopsis'>
<span class='name'>set_new_account_password</span><span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_new_account_password-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_new_account_password-source'>   <span class="ruby-comment"># File lib/rodauth/features/create_account.rb</span>
<span class="line-num">92</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_new_account_password</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">93</span>   <span class="ruby-identifier">account</span>[<span class="ruby-identifier">account_password_hash_column</span>] = <span class="ruby-identifier">password_hash</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">94</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_notice_flash'>
<a name='method-i-set_notice_flash'></a>
<div class='synopsis'>
<span class='name'>set_notice_flash</span><span class='arguments'>(message)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_notice_flash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_notice_flash-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">354</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_notice_flash</span>(<span class="ruby-identifier">message</span>)
<span class="line-num">355</span>   <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">flash_notice_key</span>] = <span class="ruby-identifier">message</span>
<span class="line-num">356</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_notice_now_flash'>
<a name='method-i-set_notice_now_flash'></a>
<div class='synopsis'>
<span class='name'>set_notice_now_flash</span><span class='arguments'>(message)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_notice_now_flash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_notice_now_flash-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">358</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_notice_now_flash</span>(<span class="ruby-identifier">message</span>)
<span class="line-num">359</span>   <span class="ruby-identifier">flash</span>.<span class="ruby-identifier">now</span>[<span class="ruby-identifier">flash_notice_key</span>] = <span class="ruby-identifier">message</span>
<span class="line-num">360</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_password'>
<a name='method-i-set_password'></a>
<div class='synopsis'>
<span class='name'>set_password</span><span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_password-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_password-source'>   <span class="ruby-comment"># File lib/rodauth/features/disallow_password_reuse.rb</span>
<span class="line-num">19</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_password</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">20</span>   <span class="ruby-identifier">hash</span> = <span class="ruby-keyword">super</span>
<span class="line-num">21</span>   <span class="ruby-identifier">add_previous_password_hash</span>(<span class="ruby-identifier">hash</span>)
<span class="line-num">22</span>   <span class="ruby-identifier">hash</span>
<span class="line-num">23</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_password_requirement_error_message'>
<a name='method-i-set_password_requirement_error_message'></a>
<div class='synopsis'>
<span class='name'>set_password_requirement_error_message</span><span class='arguments'>(reason, message)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_password_requirement_error_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_password_requirement_error_message-source'>    <span class="ruby-comment"># File lib/rodauth/features/login_password_requirements_base.rb</span>
<span class="line-num">104</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_password_requirement_error_message</span>(<span class="ruby-identifier">reason</span>, <span class="ruby-identifier">message</span>)
<span class="line-num">105</span>   <span class="ruby-identifier">set_error_reason</span>(<span class="ruby-identifier">reason</span>)
<span class="line-num">106</span>   <span class="ruby-ivar">@password_requirement_message</span> = <span class="ruby-identifier">message</span>
<span class="line-num">107</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_redirect_error_flash'>
<a name='method-i-set_redirect_error_flash'></a>
<div class='synopsis'>
<span class='name'>set_redirect_error_flash</span><span class='arguments'>(message)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_redirect_error_flash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_redirect_error_flash-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">350</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_redirect_error_flash</span>(<span class="ruby-identifier">message</span>)
<span class="line-num">351</span>   <span class="ruby-identifier">flash</span>[<span class="ruby-identifier">flash_error_key</span>] = <span class="ruby-identifier">message</span>
<span class="line-num">352</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_redirect_error_status'>
<a name='method-i-set_redirect_error_status'></a>
<div class='synopsis'>
<span class='name'>set_redirect_error_status</span><span class='arguments'>(status)</span>

</div>
<div class='description'>

<p>Don’t set an error status when redirecting in an error case, as a redirect status is needed.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_redirect_error_status-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_redirect_error_status-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">708</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_redirect_error_status</span>(<span class="ruby-identifier">status</span>)
<span class="line-num">709</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_remember_cookie'>
<a name='method-i-set_remember_cookie'></a>
<div class='synopsis'>
<span class='name'>set_remember_cookie</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_remember_cookie-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_remember_cookie-source'>    <span class="ruby-comment"># File lib/rodauth/features/remember.rb</span>
<span class="line-num">190</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_remember_cookie</span>
<span class="line-num">191</span>   <span class="ruby-identifier">_set_remember_cookie</span>(<span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">remember_key_value</span>, <span class="ruby-identifier">active_remember_key_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">remember_deadline_column</span>))
<span class="line-num">192</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_reset_password_email_last_sent'>
<a name='method-i-set_reset_password_email_last_sent'></a>
<div class='synopsis'>
<span class='name'>set_reset_password_email_last_sent</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_reset_password_email_last_sent-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_reset_password_email_last_sent-source'>    <span class="ruby-comment"># File lib/rodauth/features/reset_password.rb</span>
<span class="line-num">198</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_reset_password_email_last_sent</span>
<span class="line-num">199</span>    <span class="ruby-identifier">password_reset_ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">reset_password_email_last_sent_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">reset_password_email_last_sent_column</span>
<span class="line-num">200</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_response_error_reason_status'>
<a name='method-i-set_response_error_reason_status'></a>
<div class='synopsis'>
<span class='name'>set_response_error_reason_status</span><span class='arguments'>(reason, status)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_response_error_reason_status-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_response_error_reason_status-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">715</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_response_error_reason_status</span>(<span class="ruby-identifier">reason</span>, <span class="ruby-identifier">status</span>)
<span class="line-num">716</span>   <span class="ruby-identifier">set_error_reason</span>(<span class="ruby-identifier">reason</span>)
<span class="line-num">717</span>   <span class="ruby-identifier">set_response_error_status</span>(<span class="ruby-identifier">status</span>)
<span class="line-num">718</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_response_error_status'>
<a name='method-i-set_response_error_status'></a>
<div class='synopsis'>
<span class='name'>set_response_error_status</span><span class='arguments'>(status)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_response_error_status-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_response_error_status-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">711</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_response_error_status</span>(<span class="ruby-identifier">status</span>)
<span class="line-num">712</span>   <span class="ruby-identifier">response</span>.<span class="ruby-identifier">status</span> = <span class="ruby-identifier">status</span>
<span class="line-num">713</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_response_header'>
<a name='method-i-set_response_header'></a>
<div class='synopsis'>
<span class='name'>set_response_header</span><span class='arguments'>(key, value)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_response_header-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_response_header-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">567</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_response_header</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)
<span class="line-num">568</span>   <span class="ruby-identifier">response</span>.<span class="ruby-identifier">headers</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">value</span>
<span class="line-num">569</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_session_value'>
<a name='method-i-set_session_value'></a>
<div class='synopsis'>
<span class='name'>set_session_value</span><span class='arguments'>(key, value)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_session_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_session_value-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">943</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_session_value</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)
<span class="line-num">944</span>   <span class="ruby-identifier">session</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">value</span>
<span class="line-num">945</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_single_session_key'>
<a name='method-i-set_single_session_key'></a>
<div class='synopsis'>
<span class='name'>set_single_session_key</span><span class='arguments'>(data)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_single_session_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_single_session_key-source'>   <span class="ruby-comment"># File lib/rodauth/features/single_session.rb</span>
<span class="line-num">94</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_single_session_key</span>(<span class="ruby-identifier">data</span>)
<span class="line-num">95</span>   <span class="ruby-identifier">data</span> = <span class="ruby-identifier">compute_hmac</span>(<span class="ruby-identifier">data</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">hmac_secret</span>
<span class="line-num">96</span>   <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">single_session_session_key</span>, <span class="ruby-identifier">data</span>)
<span class="line-num">97</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_title'>
<a name='method-i-set_title'></a>
<div class='synopsis'>
<span class='name'>set_title</span><span class='arguments'>(title)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_title-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_title-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">340</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_title</span>(<span class="ruby-identifier">title</span>)
<span class="line-num">341</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">title_instance_variable</span>
<span class="line-num">342</span>     <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-identifier">title_instance_variable</span>, <span class="ruby-identifier">title</span>)
<span class="line-num">343</span>   <span class="ruby-keyword">end</span>
<span class="line-num">344</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_unlock_account_email_last_sent'>
<a name='method-i-set_unlock_account_email_last_sent'></a>
<div class='synopsis'>
<span class='name'>set_unlock_account_email_last_sent</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_unlock_account_email_last_sent-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_unlock_account_email_last_sent-source'>    <span class="ruby-comment"># File lib/rodauth/features/lockout.rb</span>
<span class="line-num">236</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_unlock_account_email_last_sent</span>
<span class="line-num">237</span>   <span class="ruby-identifier">account_lockouts_ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">account_lockouts_email_last_sent_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">account_lockouts_email_last_sent_column</span>
<span class="line-num">238</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-set_verify_account_email_last_sent'>
<a name='method-i-set_verify_account_email_last_sent'></a>
<div class='synopsis'>
<span class='name'>set_verify_account_email_last_sent</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-set_verify_account_email_last_sent-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-set_verify_account_email_last_sent-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_account.rb</span>
<span class="line-num">225</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">set_verify_account_email_last_sent</span>
<span class="line-num">226</span>    <span class="ruby-identifier">verify_account_ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">verify_account_email_last_sent_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">verify_account_email_last_sent_column</span>
<span class="line-num">227</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-setup_account_verification'>
<a name='method-i-setup_account_verification'></a>
<div class='synopsis'>
<span class='name'>setup_account_verification</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-setup_account_verification-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-setup_account_verification-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_account.rb</span>
<span class="line-num">237</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">setup_account_verification</span>
<span class="line-num">238</span>   <span class="ruby-identifier">generate_verify_account_key_value</span>
<span class="line-num">239</span>   <span class="ruby-identifier">create_verify_account_key</span>
<span class="line-num">240</span>   <span class="ruby-identifier">send_verify_account_email</span>
<span class="line-num">241</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-show_lockout_page'>
<a name='method-i-show_lockout_page'></a>
<div class='synopsis'>
<span class='name'>show_lockout_page</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-show_lockout_page-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-show_lockout_page-source'>    <span class="ruby-comment"># File lib/rodauth/features/lockout.rb</span>
<span class="line-num">279</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">show_lockout_page</span>
<span class="line-num">280</span>   <span class="ruby-identifier">set_response_error_reason_status</span>(<span class="ruby-value">:account_locked_out</span>, <span class="ruby-identifier">lockout_error_status</span>)
<span class="line-num">281</span>   <span class="ruby-identifier">set_error_flash</span> <span class="ruby-identifier">login_lockout_error_flash</span>
<span class="line-num">282</span>   <span class="ruby-identifier">return_response</span> <span class="ruby-identifier">unlock_account_request_view</span>
<span class="line-num">283</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-show_otp_auth_link-3F'>
<a name='method-i-show_otp_auth_link-3F'></a>
<div class='synopsis'>
<span class='name'>show_otp_auth_link?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-show_otp_auth_link-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-show_otp_auth_link-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">454</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">show_otp_auth_link?</span>
<span class="line-num">455</span>   <span class="ruby-identifier">otp_available?</span>
<span class="line-num">456</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-single_session_ds'>
<a name='method-i-single_session_ds'></a>
<div class='synopsis'>
<span class='name'>single_session_ds</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-single_session_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-single_session_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/single_session.rb</span>
<span class="line-num"> 99</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">single_session_ds</span>
<span class="line-num">100</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">single_session_table</span>].
<span class="line-num">101</span>     <span class="ruby-identifier">where</span>(<span class="ruby-identifier">single_session_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session_value</span>)
<span class="line-num">102</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-skip_login_field_on_login-3F'>
<a name='method-i-skip_login_field_on_login-3F'></a>
<div class='synopsis'>
<span class='name'>skip_login_field_on_login?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-skip_login_field_on_login-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-skip_login_field_on_login-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/login.rb</span>
<span class="line-num">116</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">skip_login_field_on_login?</span>
<span class="line-num">117</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">use_multi_phase_login?</span>
<span class="line-num">118</span>   <span class="ruby-identifier">valid_login_entered?</span>
<span class="line-num">119</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-skip_password_field_on_login-3F'>
<a name='method-i-skip_password_field_on_login-3F'></a>
<div class='synopsis'>
<span class='name'>skip_password_field_on_login?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-skip_password_field_on_login-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-skip_password_field_on_login-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/login.rb</span>
<span class="line-num">121</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">skip_password_field_on_login?</span>
<span class="line-num">122</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">use_multi_phase_login?</span>
<span class="line-num">123</span>   <span class="ruby-operator">!</span><span class="ruby-identifier">valid_login_entered?</span>
<span class="line-num">124</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-skip_status_checks-3F'>
<a name='method-i-skip_status_checks-3F'></a>
<div class='synopsis'>
<span class='name'>skip_status_checks?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-skip_status_checks-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-skip_status_checks-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/close_account.rb</span>
<span class="line-num">84</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">skip_status_checks?</span>
<span class="line-num">85</span>   <span class="ruby-keyword">false</span>
<span class="line-num">86</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_auth_message'>
<a name='method-i-sms_auth_message'></a>
<div class='synopsis'>
<span class='name'>sms_auth_message</span><span class='arguments'>(code)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_auth_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_auth_message-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">399</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_auth_message</span>(<span class="ruby-identifier">code</span>)
<span class="line-num">400</span>   <span class="ruby-node">&quot;SMS authentication code for #{domain} is #{code}&quot;</span>
<span class="line-num">401</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_available-3F'>
<a name='method-i-sms_available-3F'></a>
<div class='synopsis'>
<span class='name'>sms_available?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_available-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_available-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">452</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_available?</span>
<span class="line-num">453</span>   <span class="ruby-identifier">sms_setup?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">sms_locked_out?</span>
<span class="line-num">454</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_code'>
<a name='method-i-sms_code'></a>
<div class='synopsis'>
<span class='name'>sms_code</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_code-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_code-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">431</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_code</span>
<span class="line-num">432</span>   <span class="ruby-identifier">sms</span>[<span class="ruby-identifier">sms_code_column</span>]
<span class="line-num">433</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_code_issued_at'>
<a name='method-i-sms_code_issued_at'></a>
<div class='synopsis'>
<span class='name'>sms_code_issued_at</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_code_issued_at-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_code_issued_at-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">435</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_code_issued_at</span>
<span class="line-num">436</span>   <span class="ruby-identifier">convert_timestamp</span>(<span class="ruby-identifier">sms</span>[<span class="ruby-identifier">sms_issued_at_column</span>])
<span class="line-num">437</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_code_match-3F'>
<a name='method-i-sms_code_match-3F'></a>
<div class='synopsis'>
<span class='name'>sms_code_match?</span><span class='arguments'>(code)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_code_match-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_code_match-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">348</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_code_match?</span>(<span class="ruby-identifier">code</span>)
<span class="line-num">349</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">sms_current_auth?</span>
<span class="line-num">350</span>   <span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">code</span>, <span class="ruby-identifier">sms_code</span>)
<span class="line-num">351</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_codes_primary-3F'>
<a name='method-i-sms_codes_primary-3F'></a>
<div class='synopsis'>
<span class='name'>sms_codes_primary?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_codes_primary-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_codes_primary-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">500</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_codes_primary?</span>
<span class="line-num">501</span>   (<span class="ruby-identifier">features</span> <span class="ruby-operator">&amp;</span> [<span class="ruby-value">:otp</span>, <span class="ruby-value">:webauthn</span>]).<span class="ruby-identifier">empty?</span>
<span class="line-num">502</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_confirm'>
<a name='method-i-sms_confirm'></a>
<div class='synopsis'>
<span class='name'>sms_confirm</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_confirm-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_confirm-source'>    <span class="ruby-comment"># File lib/rodauth/features/recovery_codes.rb</span>
<span class="line-num">146</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_confirm</span>
<span class="line-num">147</span>   <span class="ruby-keyword">super</span> <span class="ruby-keyword">if</span> <span class="ruby-keyword">defined?</span>(<span class="ruby-keyword">super</span>)
<span class="line-num">148</span>   <span class="ruby-identifier">auto_add_missing_recovery_codes</span>
<span class="line-num">149</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_confirm_failure'>
<a name='method-i-sms_confirm_failure'></a>
<div class='synopsis'>
<span class='name'>sms_confirm_failure</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_confirm_failure-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_confirm_failure-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">362</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_confirm_failure</span>
<span class="line-num">363</span>   <span class="ruby-identifier">sms_ds</span>.<span class="ruby-identifier">delete</span>
<span class="line-num">364</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_confirm_message'>
<a name='method-i-sms_confirm_message'></a>
<div class='synopsis'>
<span class='name'>sms_confirm_message</span><span class='arguments'>(code)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_confirm_message-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_confirm_message-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">403</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_confirm_message</span>(<span class="ruby-identifier">code</span>)
<span class="line-num">404</span>   <span class="ruby-node">&quot;SMS confirmation code for #{domain} is #{code}&quot;</span>
<span class="line-num">405</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_confirmation_match-3F'>
<a name='method-i-sms_confirmation_match-3F'></a>
<div class='synopsis'>
<span class='name'>sms_confirmation_match?</span><span class='arguments'>(code)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_confirmation_match-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_confirmation_match-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">353</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_confirmation_match?</span>(<span class="ruby-identifier">code</span>)
<span class="line-num">354</span>   <span class="ruby-identifier">sms_needs_confirmation?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">sms_code_match?</span>(<span class="ruby-identifier">code</span>)
<span class="line-num">355</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_current_auth-3F'>
<a name='method-i-sms_current_auth-3F'></a>
<div class='synopsis'>
<span class='name'>sms_current_auth?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_current_auth-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_current_auth-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">460</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_current_auth?</span>
<span class="line-num">461</span>   <span class="ruby-identifier">sms_code</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">sms_code_issued_at</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">sms_code_allowed_seconds</span> <span class="ruby-operator">&gt;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>
<span class="line-num">462</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_disable'>
<a name='method-i-sms_disable'></a>
<div class='synopsis'>
<span class='name'>sms_disable</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_disable-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_disable-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">357</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_disable</span>
<span class="line-num">358</span>   <span class="ruby-identifier">sms_ds</span>.<span class="ruby-identifier">delete</span>
<span class="line-num">359</span>   <span class="ruby-ivar">@sms</span> = <span class="ruby-keyword">nil</span>
<span class="line-num">360</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_ds'>
<a name='method-i-sms_ds'></a>
<div class='synopsis'>
<span class='name'>sms_ds</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">528</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_ds</span>
<span class="line-num">529</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">sms_codes_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">sms_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session_value</span>)
<span class="line-num">530</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_failures'>
<a name='method-i-sms_failures'></a>
<div class='synopsis'>
<span class='name'>sms_failures</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_failures-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_failures-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">439</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_failures</span>
<span class="line-num">440</span>   <span class="ruby-identifier">sms</span>[<span class="ruby-identifier">sms_failures_column</span>]
<span class="line-num">441</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_locked_out-3F'>
<a name='method-i-sms_locked_out-3F'></a>
<div class='synopsis'>
<span class='name'>sms_locked_out?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_locked_out-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_locked_out-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">456</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_locked_out?</span>
<span class="line-num">457</span>   <span class="ruby-identifier">sms_failures</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">sms_failure_limit</span>
<span class="line-num">458</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_needs_confirmation-3F'>
<a name='method-i-sms_needs_confirmation-3F'></a>
<div class='synopsis'>
<span class='name'>sms_needs_confirmation?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_needs_confirmation-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_needs_confirmation-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">448</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_needs_confirmation?</span>
<span class="line-num">449</span>   <span class="ruby-identifier">sms</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">sms_failures</span>.<span class="ruby-identifier">nil?</span>
<span class="line-num">450</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_needs_confirmation_notice_flash'>
<a name='method-i-sms_needs_confirmation_notice_flash'></a>
<div class='synopsis'>
<span class='name'>sms_needs_confirmation_notice_flash</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_needs_confirmation_notice_flash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_needs_confirmation_notice_flash-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">407</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_needs_confirmation_notice_flash</span>
<span class="line-num">408</span>   <span class="ruby-identifier">sms_needs_confirmation_error_flash</span>
<span class="line-num">409</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_new_auth_code'>
<a name='method-i-sms_new_auth_code'></a>
<div class='synopsis'>
<span class='name'>sms_new_auth_code</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_new_auth_code-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_new_auth_code-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">508</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_new_auth_code</span>
<span class="line-num">509</span>   <span class="ruby-constant">SecureRandom</span>.<span class="ruby-identifier">random_number</span>(<span class="ruby-value">10</span><span class="ruby-operator">**</span><span class="ruby-identifier">sms_auth_code_length</span>).<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">rjust</span>(<span class="ruby-identifier">sms_auth_code_length</span>, <span class="ruby-string">&quot;0&quot;</span>)
<span class="line-num">510</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_new_confirm_code'>
<a name='method-i-sms_new_confirm_code'></a>
<div class='synopsis'>
<span class='name'>sms_new_confirm_code</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_new_confirm_code-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_new_confirm_code-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">512</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_new_confirm_code</span>
<span class="line-num">513</span>   <span class="ruby-constant">SecureRandom</span>.<span class="ruby-identifier">random_number</span>(<span class="ruby-value">10</span><span class="ruby-operator">**</span><span class="ruby-identifier">sms_confirm_code_length</span>).<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">rjust</span>(<span class="ruby-identifier">sms_confirm_code_length</span>, <span class="ruby-string">&quot;0&quot;</span>)
<span class="line-num">514</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_normalize_phone'>
<a name='method-i-sms_normalize_phone'></a>
<div class='synopsis'>
<span class='name'>sms_normalize_phone</span><span class='arguments'>(phone)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_normalize_phone-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_normalize_phone-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">504</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_normalize_phone</span>(<span class="ruby-identifier">phone</span>)
<span class="line-num">505</span>   <span class="ruby-identifier">phone</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp">/\D+/</span>, <span class="ruby-string">&#39;&#39;</span>)
<span class="line-num">506</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_phone'>
<a name='method-i-sms_phone'></a>
<div class='synopsis'>
<span class='name'>sms_phone</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_phone-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_phone-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">427</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_phone</span>
<span class="line-num">428</span>   <span class="ruby-identifier">sms</span>[<span class="ruby-identifier">sms_phone_column</span>]
<span class="line-num">429</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_record_failure'>
<a name='method-i-sms_record_failure'></a>
<div class='synopsis'>
<span class='name'>sms_record_failure</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_record_failure-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_record_failure-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">422</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_record_failure</span>
<span class="line-num">423</span>   <span class="ruby-identifier">update_sms</span>(<span class="ruby-identifier">sms_failures_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">expr</span>(<span class="ruby-identifier">sms_failures_column</span>)<span class="ruby-value">+1</span>)
<span class="line-num">424</span>   <span class="ruby-identifier">sms</span>[<span class="ruby-identifier">sms_failures_column</span>] = <span class="ruby-identifier">sms_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">sms_failures_column</span>)
<span class="line-num">425</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_remove_expired_confirm_code'>
<a name='method-i-sms_remove_expired_confirm_code'></a>
<div class='synopsis'>
<span class='name'>sms_remove_expired_confirm_code</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_remove_expired_confirm_code-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_remove_expired_confirm_code-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">415</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_remove_expired_confirm_code</span>
<span class="line-num">416</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">sms_codes_table</span>].
<span class="line-num">417</span>     <span class="ruby-identifier">where</span>(<span class="ruby-identifier">sms_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session_value</span>, <span class="ruby-identifier">sms_failures_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-keyword">nil</span>).
<span class="line-num">418</span>     <span class="ruby-identifier">where</span>(<span class="ruby-constant">Sequel</span>[<span class="ruby-identifier">sms_issued_at_column</span>] <span class="ruby-operator">&lt;</span> <span class="ruby-constant">Sequel</span>.<span class="ruby-identifier">date_sub</span>(<span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>, <span class="ruby-value">seconds:</span> <span class="ruby-identifier">sms_confirm_deadline</span>)).
<span class="line-num">419</span>     <span class="ruby-identifier">delete</span>
<span class="line-num">420</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_remove_failures'>
<a name='method-i-sms_remove_failures'></a>
<div class='synopsis'>
<span class='name'>sms_remove_failures</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_remove_failures-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_remove_failures-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">373</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_remove_failures</span>
<span class="line-num">374</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">sms_needs_confirmation?</span>
<span class="line-num">375</span>   <span class="ruby-identifier">update_hash_ds</span>(<span class="ruby-identifier">sms</span>, <span class="ruby-identifier">sms_ds</span>.<span class="ruby-identifier">exclude</span>(<span class="ruby-identifier">sms_failures_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-keyword">nil</span>), <span class="ruby-identifier">sms_failures_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-value">0</span>, <span class="ruby-identifier">sms_code_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-keyword">nil</span>)
<span class="line-num">376</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_send'>
<a name='method-i-sms_send'></a>
<div class='synopsis'>
<span class='name'>sms_send</span><span class='arguments'>(phone, message)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_send-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_send-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">516</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_send</span>(<span class="ruby-identifier">phone</span>, <span class="ruby-identifier">message</span>)
<span class="line-num">517</span>   <span class="ruby-identifier">raise</span> <span class="ruby-constant">ConfigurationError</span>, <span class="ruby-string">&quot;sms_send needs to be defined in the Rodauth configuration for SMS sending to work&quot;</span>
<span class="line-num">518</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_send_auth_code'>
<a name='method-i-sms_send_auth_code'></a>
<div class='synopsis'>
<span class='name'>sms_send_auth_code</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_send_auth_code-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_send_auth_code-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">383</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_send_auth_code</span>
<span class="line-num">384</span>   <span class="ruby-identifier">code</span> = <span class="ruby-identifier">sms_new_auth_code</span>
<span class="line-num">385</span>   <span class="ruby-identifier">sms_set_code</span>(<span class="ruby-identifier">code</span>)
<span class="line-num">386</span>   <span class="ruby-identifier">sms_send</span>(<span class="ruby-identifier">sms_phone</span>, <span class="ruby-identifier">sms_auth_message</span>(<span class="ruby-identifier">code</span>))
<span class="line-num">387</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_send_confirm_code'>
<a name='method-i-sms_send_confirm_code'></a>
<div class='synopsis'>
<span class='name'>sms_send_confirm_code</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_send_confirm_code-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_send_confirm_code-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">389</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_send_confirm_code</span>
<span class="line-num">390</span>   <span class="ruby-identifier">code</span> = <span class="ruby-identifier">sms_new_confirm_code</span>
<span class="line-num">391</span>   <span class="ruby-identifier">sms_set_code</span>(<span class="ruby-identifier">code</span>)
<span class="line-num">392</span>   <span class="ruby-identifier">sms_send</span>(<span class="ruby-identifier">sms_phone</span>, <span class="ruby-identifier">sms_confirm_message</span>(<span class="ruby-identifier">code</span>))
<span class="line-num">393</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_set_code'>
<a name='method-i-sms_set_code'></a>
<div class='synopsis'>
<span class='name'>sms_set_code</span><span class='arguments'>(code)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_set_code-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_set_code-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">411</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_set_code</span>(<span class="ruby-identifier">code</span>)
<span class="line-num">412</span>  <span class="ruby-identifier">update_sms</span>(<span class="ruby-identifier">sms_code_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">code</span>, <span class="ruby-identifier">sms_issued_at_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>)
<span class="line-num">413</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_setup'>
<a name='method-i-sms_setup'></a>
<div class='synopsis'>
<span class='name'>sms_setup</span><span class='arguments'>(phone_number)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_setup-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_setup-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">366</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_setup</span>(<span class="ruby-identifier">phone_number</span>)
<span class="line-num">367</span>   <span class="ruby-comment"># Cannot handle uniqueness violation here, as the phone number given may not match the</span>
<span class="line-num">368</span>   <span class="ruby-comment"># one in the table.</span>
<span class="line-num">369</span>   <span class="ruby-identifier">sms_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">sms_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session_value</span>, <span class="ruby-identifier">sms_phone_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">phone_number</span>, <span class="ruby-identifier">sms_failures_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-keyword">nil</span>)
<span class="line-num">370</span>   <span class="ruby-identifier">remove_instance_variable</span>(<span class="ruby-value">:@sms</span>) <span class="ruby-keyword">if</span> <span class="ruby-identifier">instance_variable_defined?</span>(<span class="ruby-value">:@sms</span>)
<span class="line-num">371</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_setup-3F'>
<a name='method-i-sms_setup-3F'></a>
<div class='synopsis'>
<span class='name'>sms_setup?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_setup-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_setup-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">443</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_setup?</span>
<span class="line-num">444</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">sms</span>
<span class="line-num">445</span>   <span class="ruby-operator">!</span><span class="ruby-identifier">sms_needs_confirmation?</span>
<span class="line-num">446</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-sms_valid_phone-3F'>
<a name='method-i-sms_valid_phone-3F'></a>
<div class='synopsis'>
<span class='name'>sms_valid_phone?</span><span class='arguments'>(phone)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-sms_valid_phone-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-sms_valid_phone-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">395</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">sms_valid_phone?</span>(<span class="ruby-identifier">phone</span>)
<span class="line-num">396</span>   <span class="ruby-identifier">phone</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">sms_phone_min_length</span>
<span class="line-num">397</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-split_token'>
<a name='method-i-split_token'></a>
<div class='synopsis'>
<span class='name'>split_token</span><span class='arguments'>(token)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-split_token-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-split_token-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">632</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">split_token</span>(<span class="ruby-identifier">token</span>)
<span class="line-num">633</span>   <span class="ruby-identifier">token</span>.<span class="ruby-identifier">split</span>(<span class="ruby-identifier">token_separator</span>, <span class="ruby-value">2</span>)
<span class="line-num">634</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-template_path'>
<a name='method-i-template_path'></a>
<div class='synopsis'>
<span class='name'>template_path</span><span class='arguments'>(page)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-template_path-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-template_path-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">845</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">template_path</span>(<span class="ruby-identifier">page</span>)
<span class="line-num">846</span>   <span class="ruby-constant">File</span>.<span class="ruby-identifier">join</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">dirname</span>(<span class="ruby-keyword">__FILE__</span>), <span class="ruby-string">&#39;../../../templates&#39;</span>, <span class="ruby-node">&quot;#{page}.str&quot;</span>)
<span class="line-num">847</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-throw_basic_auth_error'>
<a name='method-i-throw_basic_auth_error'></a>
<div class='synopsis'>
<span class='name'>throw_basic_auth_error</span><span class='arguments'>(*args)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-throw_basic_auth_error-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-throw_basic_auth_error-source'>   <span class="ruby-comment"># File lib/rodauth/features/http_basic_auth.rb</span>
<span class="line-num">79</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">throw_basic_auth_error</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>)
<span class="line-num">80</span>   <span class="ruby-identifier">set_http_basic_auth_error_response</span>
<span class="line-num">81</span>   <span class="ruby-identifier">throw_error</span>(<span class="ruby-operator">*</span><span class="ruby-identifier">args</span>) 
<span class="line-num">82</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-throw_error'>
<a name='method-i-throw_error'></a>
<div class='synopsis'>
<span class='name'>throw_error</span><span class='arguments'>(field, error)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-throw_error-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-throw_error-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">724</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">throw_error</span>(<span class="ruby-identifier">field</span>, <span class="ruby-identifier">error</span>)
<span class="line-num">725</span>   <span class="ruby-identifier">set_field_error</span>(<span class="ruby-identifier">field</span>, <span class="ruby-identifier">error</span>)
<span class="line-num">726</span>   <span class="ruby-identifier">throw_rodauth_error</span>
<span class="line-num">727</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-throw_error_reason'>
<a name='method-i-throw_error_reason'></a>
<div class='synopsis'>
<span class='name'>throw_error_reason</span><span class='arguments'>(reason, status, field, message)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-throw_error_reason-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-throw_error_reason-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">737</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">throw_error_reason</span>(<span class="ruby-identifier">reason</span>, <span class="ruby-identifier">status</span>, <span class="ruby-identifier">field</span>, <span class="ruby-identifier">message</span>)
<span class="line-num">738</span>   <span class="ruby-identifier">set_error_reason</span>(<span class="ruby-identifier">reason</span>)
<span class="line-num">739</span>   <span class="ruby-identifier">throw_error_status</span>(<span class="ruby-identifier">status</span>, <span class="ruby-identifier">field</span>, <span class="ruby-identifier">message</span>)
<span class="line-num">740</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-throw_error_status'>
<a name='method-i-throw_error_status'></a>
<div class='synopsis'>
<span class='name'>throw_error_status</span><span class='arguments'>(status, field, error)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-throw_error_status-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-throw_error_status-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">729</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">throw_error_status</span>(<span class="ruby-identifier">status</span>, <span class="ruby-identifier">field</span>, <span class="ruby-identifier">error</span>)
<span class="line-num">730</span>   <span class="ruby-identifier">set_response_error_status</span>(<span class="ruby-identifier">status</span>)
<span class="line-num">731</span>   <span class="ruby-identifier">throw_error</span>(<span class="ruby-identifier">field</span>, <span class="ruby-identifier">error</span>)
<span class="line-num">732</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-throw_rodauth_error'>
<a name='method-i-throw_rodauth_error'></a>
<div class='synopsis'>
<span class='name'>throw_rodauth_error</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-throw_rodauth_error-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-throw_rodauth_error-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">720</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">throw_rodauth_error</span>
<span class="line-num">721</span>   <span class="ruby-identifier">throw</span> <span class="ruby-value">:rodauth_error</span>
<span class="line-num">722</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-timing_safe_eql-3F'>
<a name='method-i-timing_safe_eql-3F'></a>
<div class='synopsis'>
<span class='name'>timing_safe_eql?</span><span class='arguments'>(provided, actual)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-timing_safe_eql-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-timing_safe_eql-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">691</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">timing_safe_eql?</span>(<span class="ruby-identifier">provided</span>, <span class="ruby-identifier">actual</span>)
<span class="line-num">692</span>   <span class="ruby-identifier">provided</span> = <span class="ruby-identifier">provided</span>.<span class="ruby-identifier">to_s</span>
<span class="line-num">693</span>   <span class="ruby-constant">Rack</span><span class="ruby-operator">::</span><span class="ruby-constant">Utils</span>.<span class="ruby-identifier">secure_compare</span>(<span class="ruby-identifier">provided</span>.<span class="ruby-identifier">ljust</span>(<span class="ruby-identifier">actual</span>.<span class="ruby-identifier">length</span>), <span class="ruby-identifier">actual</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">provided</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">actual</span>.<span class="ruby-identifier">length</span>
<span class="line-num">694</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-token_link'>
<a name='method-i-token_link'></a>
<div class='synopsis'>
<span class='name'>token_link</span><span class='arguments'>(route, param, key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-token_link-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-token_link-source'>   <span class="ruby-comment"># File lib/rodauth/features/email_base.rb</span>
<span class="line-num">53</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">token_link</span>(<span class="ruby-identifier">route</span>, <span class="ruby-identifier">param</span>, <span class="ruby-identifier">key</span>)
<span class="line-num">54</span>   <span class="ruby-identifier">route_url</span>(<span class="ruby-identifier">route</span>, <span class="ruby-identifier">param</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">token_param_value</span>(<span class="ruby-identifier">key</span>))
<span class="line-num">55</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-token_param_value'>
<a name='method-i-token_param_value'></a>
<div class='synopsis'>
<span class='name'>token_param_value</span><span class='arguments'>(key)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-token_param_value-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-token_param_value-source'>   <span class="ruby-comment"># File lib/rodauth/features/email_base.rb</span>
<span class="line-num">57</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">token_param_value</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">58</span>   <span class="ruby-node">&quot;#{account_id}#{token_separator}#{convert_email_token_key(key)}&quot;</span>
<span class="line-num">59</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-transaction'>
<a name='method-i-transaction'></a>
<div class='synopsis'>
<span class='name'>transaction</span><span class='arguments'>(opts={}, &block)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-transaction-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-transaction-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">674</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">transaction</span>(<span class="ruby-identifier">opts</span>={}, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">675</span>   <span class="ruby-identifier">db</span>.<span class="ruby-identifier">transaction</span>(<span class="ruby-identifier">opts</span>, <span class="ruby-operator">&amp;</span><span class="ruby-identifier">block</span>)
<span class="line-num">676</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-translate'>
<a name='method-i-translate'></a>
<div class='synopsis'>
<span class='name'>translate</span><span class='arguments'>(_key, default)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-translate-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-translate-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">244</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">translate</span>(<span class="ruby-identifier">_key</span>, <span class="ruby-identifier">default</span>)
<span class="line-num">245</span>   <span class="ruby-comment"># do not attempt to translate by default</span>
<span class="line-num">246</span>   <span class="ruby-identifier">default</span>
<span class="line-num">247</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_auth_links'>
<a name='method-i-two_factor_auth_links'></a>
<div class='synopsis'>
<span class='name'>two_factor_auth_links</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_auth_links-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_auth_links-source'>    <span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb</span>
<span class="line-num">206</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_auth_links</span>
<span class="line-num">207</span>   <span class="ruby-ivar">@two_factor_auth_links</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">_filter_links</span>(<span class="ruby-identifier">_two_factor_auth_links</span>)
<span class="line-num">208</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_authenticate'>
<a name='method-i-two_factor_authenticate'></a>
<div class='synopsis'>
<span class='name'>two_factor_authenticate</span><span class='arguments'>(type)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_authenticate-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_authenticate-source'>    <span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb</span>
<span class="line-num">241</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_authenticate</span>(<span class="ruby-identifier">type</span>)
<span class="line-num">242</span>   <span class="ruby-identifier">two_factor_update_session</span>(<span class="ruby-identifier">type</span>)
<span class="line-num">243</span>   <span class="ruby-identifier">two_factor_remove_auth_failures</span>
<span class="line-num">244</span>   <span class="ruby-identifier">after_two_factor_authentication</span>
<span class="line-num">245</span>   <span class="ruby-identifier">require_response</span>(<span class="ruby-value">:_two_factor_auth_response</span>)
<span class="line-num">246</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_authenticated-3F'>
<a name='method-i-two_factor_authenticated-3F'></a>
<div class='synopsis'>
<span class='name'>two_factor_authenticated?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_authenticated-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_authenticated-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb</span>
<span class="line-num">184</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_authenticated?</span>
<span class="line-num">185</span>   <span class="ruby-identifier">authenticated_by</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">authenticated_by</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">2</span>
<span class="line-num">186</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_authentication_setup-3F'>
<a name='method-i-two_factor_authentication_setup-3F'></a>
<div class='synopsis'>
<span class='name'>two_factor_authentication_setup?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_authentication_setup-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_authentication_setup-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb</span>
<span class="line-num">188</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_authentication_setup?</span>
<span class="line-num">189</span>   <span class="ruby-identifier">possible_authentication_methods</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">2</span>
<span class="line-num">190</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_login_type_match-3F'>
<a name='method-i-two_factor_login_type_match-3F'></a>
<div class='synopsis'>
<span class='name'>two_factor_login_type_match?</span><span class='arguments'>(type)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_login_type_match-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_login_type_match-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb</span>
<span class="line-num">198</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_login_type_match?</span>(<span class="ruby-identifier">type</span>)
<span class="line-num">199</span>   <span class="ruby-identifier">authenticated_by</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">authenticated_by</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">type</span>)
<span class="line-num">200</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_modifications_require_password-3F'>
<a name='method-i-two_factor_modifications_require_password-3F'></a>
<div class='synopsis'>
<span class='name'>two_factor_modifications_require_password?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_modifications_require_password-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_modifications_require_password-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb</span>
<span class="line-num">122</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_modifications_require_password?</span>
<span class="line-num">123</span>   <span class="ruby-identifier">modifications_require_password?</span>
<span class="line-num">124</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_partially_authenticated-3F'>
<a name='method-i-two_factor_partially_authenticated-3F'></a>
<div class='synopsis'>
<span class='name'>two_factor_partially_authenticated?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_partially_authenticated-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_partially_authenticated-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb</span>
<span class="line-num">180</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_partially_authenticated?</span>
<span class="line-num">181</span>   <span class="ruby-identifier">logged_in?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">two_factor_authenticated?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">uses_two_factor_authentication?</span>
<span class="line-num">182</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_password_match-3F'>
<a name='method-i-two_factor_password_match-3F'></a>
<div class='synopsis'>
<span class='name'>two_factor_password_match?</span><span class='arguments'>(password)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_password_match-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_password_match-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb</span>
<span class="line-num">172</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_password_match?</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">173</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">two_factor_modifications_require_password?</span>
<span class="line-num">174</span>     <span class="ruby-identifier">password_match?</span>(<span class="ruby-identifier">password</span>)
<span class="line-num">175</span>   <span class="ruby-keyword">else</span>
<span class="line-num">176</span>     <span class="ruby-keyword">true</span>
<span class="line-num">177</span>   <span class="ruby-keyword">end</span>
<span class="line-num">178</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_remove'>
<a name='method-i-two_factor_remove'></a>
<div class='synopsis'>
<span class='name'>two_factor_remove</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_remove-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_remove-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">224</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_remove</span>
<span class="line-num">225</span>   <span class="ruby-keyword">super</span>
<span class="line-num">226</span>   <span class="ruby-identifier">otp_remove</span>
<span class="line-num">227</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_remove_auth_failures'>
<a name='method-i-two_factor_remove_auth_failures'></a>
<div class='synopsis'>
<span class='name'>two_factor_remove_auth_failures</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_remove_auth_failures-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_remove_auth_failures-source'>    <span class="ruby-comment"># File lib/rodauth/features/otp.rb</span>
<span class="line-num">229</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_remove_auth_failures</span>
<span class="line-num">230</span>   <span class="ruby-keyword">super</span>
<span class="line-num">231</span>   <span class="ruby-identifier">otp_remove_auth_failures</span>
<span class="line-num">232</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_remove_links'>
<a name='method-i-two_factor_remove_links'></a>
<div class='synopsis'>
<span class='name'>two_factor_remove_links</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_remove_links-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_remove_links-source'>    <span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb</span>
<span class="line-num">214</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_remove_links</span>
<span class="line-num">215</span>   <span class="ruby-ivar">@two_factor_remove_links</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">_filter_links</span>(<span class="ruby-identifier">_two_factor_remove_links</span>)
<span class="line-num">216</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_remove_session'>
<a name='method-i-two_factor_remove_session'></a>
<div class='synopsis'>
<span class='name'>two_factor_remove_session</span><span class='arguments'>(type)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_remove_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_remove_session-source'>    <span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb</span>
<span class="line-num">254</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_remove_session</span>(<span class="ruby-identifier">type</span>)
<span class="line-num">255</span>   <span class="ruby-identifier">authenticated_by</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">type</span>)
<span class="line-num">256</span>   <span class="ruby-identifier">remove_session_value</span>(<span class="ruby-identifier">two_factor_setup_session_key</span>)
<span class="line-num">257</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">authenticated_by</span>.<span class="ruby-identifier">empty?</span>
<span class="line-num">258</span>     <span class="ruby-identifier">clear_session</span>
<span class="line-num">259</span>   <span class="ruby-keyword">end</span>
<span class="line-num">260</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_setup_links'>
<a name='method-i-two_factor_setup_links'></a>
<div class='synopsis'>
<span class='name'>two_factor_setup_links</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_setup_links-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_setup_links-source'>    <span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb</span>
<span class="line-num">210</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_setup_links</span>
<span class="line-num">211</span>   <span class="ruby-ivar">@two_factor_setup_links</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">_filter_links</span>(<span class="ruby-identifier">_two_factor_setup_links</span>)
<span class="line-num">212</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-two_factor_update_session'>
<a name='method-i-two_factor_update_session'></a>
<div class='synopsis'>
<span class='name'>two_factor_update_session</span><span class='arguments'>(auth_type)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-two_factor_update_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-two_factor_update_session-source'>    <span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb</span>
<span class="line-num">262</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">two_factor_update_session</span>(<span class="ruby-identifier">auth_type</span>)
<span class="line-num">263</span>   <span class="ruby-identifier">authenticated_by</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">auth_type</span>
<span class="line-num">264</span>   <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">two_factor_setup_session_key</span>, <span class="ruby-keyword">true</span>)
<span class="line-num">265</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-unique_constraint_violation_class'>
<a name='method-i-unique_constraint_violation_class'></a>
<div class='synopsis'>
<span class='name'>unique_constraint_violation_class</span><span class='arguments'>()</span>

</div>
<div class='description'>

<p>Work around jdbc/sqlite issue where it only raises ConstraintViolation and not UniqueConstraintViolation.</p>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-unique_constraint_violation_class-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-unique_constraint_violation_class-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">898</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">unique_constraint_violation_class</span>
<span class="line-num">899</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">adapter_scheme</span> <span class="ruby-operator">==</span> <span class="ruby-value">:jdbc</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">database_type</span> <span class="ruby-operator">==</span> <span class="ruby-value">:sqlite</span>
<span class="line-num">900</span>     <span class="ruby-comment"># :nocov:</span>
<span class="line-num">901</span>     <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">ConstraintViolation</span>
<span class="line-num">902</span>     <span class="ruby-comment"># :nocov:</span>
<span class="line-num">903</span>   <span class="ruby-keyword">else</span>
<span class="line-num">904</span>     <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">UniqueConstraintViolation</span>
<span class="line-num">905</span>   <span class="ruby-keyword">end</span>
<span class="line-num">906</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-unlock_account'>
<a name='method-i-unlock_account'></a>
<div class='synopsis'>
<span class='name'>unlock_account</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-unlock_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-unlock_account-source'>    <span class="ruby-comment"># File lib/rodauth/features/lockout.rb</span>
<span class="line-num">159</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">unlock_account</span>
<span class="line-num">160</span>   <span class="ruby-identifier">transaction</span> <span class="ruby-keyword">do</span>
<span class="line-num">161</span>     <span class="ruby-identifier">remove_lockout_metadata</span>
<span class="line-num">162</span>   <span class="ruby-keyword">end</span>
<span class="line-num">163</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-unlock_account_email_link'>
<a name='method-i-unlock_account_email_link'></a>
<div class='synopsis'>
<span class='name'>unlock_account_email_link</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-unlock_account_email_link-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-unlock_account_email_link-source'>    <span class="ruby-comment"># File lib/rodauth/features/lockout.rb</span>
<span class="line-num">224</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">unlock_account_email_link</span>
<span class="line-num">225</span>   <span class="ruby-identifier">token_link</span>(<span class="ruby-identifier">unlock_account_route</span>, <span class="ruby-identifier">unlock_account_key_param</span>, <span class="ruby-identifier">unlock_account_key_value</span>)
<span class="line-num">226</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-unlock_account_email_recently_sent-3F'>
<a name='method-i-unlock_account_email_recently_sent-3F'></a>
<div class='synopsis'>
<span class='name'>unlock_account_email_recently_sent?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-unlock_account_email_recently_sent-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-unlock_account_email_recently_sent-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/lockout.rb</span>
<span class="line-num">240</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">unlock_account_email_recently_sent?</span>
<span class="line-num">241</span>   (<span class="ruby-identifier">email_last_sent</span> = <span class="ruby-identifier">get_unlock_account_email_last_sent</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">email_last_sent</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">unlock_account_skip_resend_email_within</span>)
<span class="line-num">242</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-unverified_grace_period_expired-3F'>
<a name='method-i-unverified_grace_period_expired-3F'></a>
<div class='synopsis'>
<span class='name'>unverified_grace_period_expired?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-unverified_grace_period_expired-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-unverified_grace_period_expired-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/verify_account_grace_period.rb</span>
<span class="line-num">92</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">unverified_grace_period_expired?</span>
<span class="line-num">93</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">expires_at</span> = <span class="ruby-identifier">session</span>[<span class="ruby-identifier">unverified_account_session_key</span>]
<span class="line-num">94</span>   <span class="ruby-identifier">expires_at</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Integer</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">expires_at</span>
<span class="line-num">95</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_account'>
<a name='method-i-update_account'></a>
<div class='synopsis'>
<span class='name'>update_account</span><span class='arguments'>(values, ds=account_ds)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_account-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">961</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_account</span>(<span class="ruby-identifier">values</span>, <span class="ruby-identifier">ds</span>=<span class="ruby-identifier">account_ds</span>)
<span class="line-num">962</span>   <span class="ruby-identifier">update_hash_ds</span>(<span class="ruby-identifier">account</span>, <span class="ruby-identifier">ds</span>, <span class="ruby-identifier">values</span>)
<span class="line-num">963</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_activity'>
<a name='method-i-update_activity'></a>
<div class='synopsis'>
<span class='name'>update_activity</span><span class='arguments'>(account_id, *columns)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_activity-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_activity-source'>    <span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb</span>
<span class="line-num">113</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_activity</span>(<span class="ruby-identifier">account_id</span>, <span class="ruby-operator">*</span><span class="ruby-identifier">columns</span>)
<span class="line-num">114</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">account_activity_ds</span>(<span class="ruby-identifier">account_id</span>)
<span class="line-num">115</span>   <span class="ruby-identifier">hash</span> = {}
<span class="line-num">116</span>   <span class="ruby-identifier">columns</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
<span class="line-num">117</span>     <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">c</span>] = <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>
<span class="line-num">118</span>   <span class="ruby-keyword">end</span>
<span class="line-num">119</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">hash</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
<span class="line-num">120</span>     <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">account_activity_id_column</span>] = <span class="ruby-identifier">account_id</span>
<span class="line-num">121</span>     <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">account_activity_last_activity_column</span>] <span class="ruby-operator">||=</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>
<span class="line-num">122</span>     <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">account_activity_last_login_column</span>] <span class="ruby-operator">||=</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>
<span class="line-num">123</span>     <span class="ruby-comment"># It is safe to ignore uniqueness violations here, as a concurrent insert would also use current timestamps.</span>
<span class="line-num">124</span>     <span class="ruby-identifier">ignore_uniqueness_violation</span>{<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">hash</span>)}
<span class="line-num">125</span>   <span class="ruby-keyword">end</span>
<span class="line-num">126</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_current_session-3F'>
<a name='method-i-update_current_session-3F'></a>
<div class='synopsis'>
<span class='name'>update_current_session?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_current_session-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_current_session-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">195</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_current_session?</span>
<span class="line-num">196</span>   <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-identifier">session_inactivity_deadline</span>
<span class="line-num">197</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_hash_ds'>
<a name='method-i-update_hash_ds'></a>
<div class='synopsis'>
<span class='name'>update_hash_ds</span><span class='arguments'>(hash, ds, values)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_hash_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_hash_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">951</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_hash_ds</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">ds</span>, <span class="ruby-identifier">values</span>)
<span class="line-num">952</span>   <span class="ruby-identifier">num</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">values</span>)
<span class="line-num">953</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">num</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
<span class="line-num">954</span>     <span class="ruby-identifier">values</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">k</span>, <span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
<span class="line-num">955</span>       <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">k</span>] = <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">?</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">v</span>
<span class="line-num">956</span>     <span class="ruby-keyword">end</span>
<span class="line-num">957</span>   <span class="ruby-keyword">end</span>
<span class="line-num">958</span>   <span class="ruby-identifier">num</span>
<span class="line-num">959</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_last_activity'>
<a name='method-i-update_last_activity'></a>
<div class='synopsis'>
<span class='name'>update_last_activity</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_last_activity-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_last_activity-source'>   <span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb</span>
<span class="line-num">43</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_last_activity</span>
<span class="line-num">44</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">session_value</span>
<span class="line-num">45</span>     <span class="ruby-identifier">update_activity</span>(<span class="ruby-identifier">session_value</span>, <span class="ruby-identifier">account_activity_last_activity_column</span>)
<span class="line-num">46</span>   <span class="ruby-keyword">end</span>
<span class="line-num">47</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_last_login'>
<a name='method-i-update_last_login'></a>
<div class='synopsis'>
<span class='name'>update_last_login</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_last_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_last_login-source'>   <span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb</span>
<span class="line-num">39</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_last_login</span>
<span class="line-num">40</span>   <span class="ruby-identifier">update_activity</span>(<span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">account_activity_last_login_column</span>, <span class="ruby-identifier">account_activity_last_activity_column</span>)
<span class="line-num">41</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_login'>
<a name='method-i-update_login'></a>
<div class='synopsis'>
<span class='name'>update_login</span><span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_login-source'>   <span class="ruby-comment"># File lib/rodauth/features/change_login.rb</span>
<span class="line-num">79</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_login</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">80</span>   <span class="ruby-identifier">_update_login</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">81</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_password_changed_at'>
<a name='method-i-update_password_changed_at'></a>
<div class='synopsis'>
<span class='name'>update_password_changed_at</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_password_changed_at-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_password_changed_at-source'>   <span class="ruby-comment"># File lib/rodauth/features/password_expiration.rb</span>
<span class="line-num">52</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_password_changed_at</span>
<span class="line-num">53</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">password_expiration_ds</span>
<span class="line-num">54</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">password_expiration_changed_at_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
<span class="line-num">55</span>     <span class="ruby-comment"># Ignoring the violation is safe here, since a concurrent insert would also set it to the</span>
<span class="line-num">56</span>     <span class="ruby-comment"># current timestamp.</span>
<span class="line-num">57</span>     <span class="ruby-identifier">ignore_uniqueness_violation</span>{<span class="ruby-identifier">ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">password_expiration_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>)}
<span class="line-num">58</span>   <span class="ruby-keyword">end</span>
<span class="line-num">59</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_password_hash-3F'>
<a name='method-i-update_password_hash-3F'></a>
<div class='synopsis'>
<span class='name'>update_password_hash?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_password_hash-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_password_hash-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/update_password_hash.rb</span>
<span class="line-num">18</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_password_hash?</span>
<span class="line-num">19</span>   <span class="ruby-identifier">password_hash_cost</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@current_password_hash_cost</span> <span class="ruby-operator">||</span> <span class="ruby-ivar">@update_password_hash</span>
<span class="line-num">20</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_session'>
<a name='method-i-update_session'></a>
<div class='synopsis'>
<span class='name'>update_session</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_session-source'>   <span class="ruby-comment"># File lib/rodauth/features/account_expiration.rb</span>
<span class="line-num">72</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_session</span>
<span class="line-num">73</span>   <span class="ruby-identifier">check_account_expiration</span>
<span class="line-num">74</span>   <span class="ruby-keyword">super</span>
<span class="line-num">75</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_single_session_key'>
<a name='method-i-update_single_session_key'></a>
<div class='synopsis'>
<span class='name'>update_single_session_key</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_single_session_key-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_single_session_key-source'>   <span class="ruby-comment"># File lib/rodauth/features/single_session.rb</span>
<span class="line-num">66</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_single_session_key</span>
<span class="line-num">67</span>   <span class="ruby-identifier">key</span> = <span class="ruby-identifier">random_key</span>
<span class="line-num">68</span>   <span class="ruby-identifier">set_single_session_key</span>(<span class="ruby-identifier">key</span>)
<span class="line-num">69</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">single_session_ds</span>.<span class="ruby-identifier">update</span>(<span class="ruby-identifier">single_session_key_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">key</span>) <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
<span class="line-num">70</span>     <span class="ruby-comment"># Don&#39;t handle uniqueness violations here.  While we could get the stored key from the</span>
<span class="line-num">71</span>     <span class="ruby-comment"># database, it could lead to two sessions sharing the same key, which this feature is</span>
<span class="line-num">72</span>     <span class="ruby-comment"># designed to prevent.</span>
<span class="line-num">73</span>     <span class="ruby-identifier">single_session_ds</span>.<span class="ruby-identifier">insert</span>(<span class="ruby-identifier">single_session_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">session_value</span>, <span class="ruby-identifier">single_session_key_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">key</span>)
<span class="line-num">74</span>   <span class="ruby-keyword">end</span>
<span class="line-num">75</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-update_sms'>
<a name='method-i-update_sms'></a>
<div class='synopsis'>
<span class='name'>update_sms</span><span class='arguments'>(values)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-update_sms-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-update_sms-source'>    <span class="ruby-comment"># File lib/rodauth/features/sms_codes.rb</span>
<span class="line-num">520</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">update_sms</span>(<span class="ruby-identifier">values</span>)
<span class="line-num">521</span>   <span class="ruby-identifier">update_hash_ds</span>(<span class="ruby-identifier">sms</span>, <span class="ruby-identifier">sms_ds</span>, <span class="ruby-identifier">values</span>)
<span class="line-num">522</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-use_database_authentication_functions-3F'>
<a name='method-i-use_database_authentication_functions-3F'></a>
<div class='synopsis'>
<span class='name'>use_database_authentication_functions?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-use_database_authentication_functions-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-use_database_authentication_functions-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">750</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">use_database_authentication_functions?</span>
<span class="line-num">751</span>   <span class="ruby-keyword">case</span> <span class="ruby-identifier">db</span>.<span class="ruby-identifier">database_type</span>
<span class="line-num">752</span>   <span class="ruby-keyword">when</span> <span class="ruby-value">:postgres</span>, <span class="ruby-value">:mysql</span>, <span class="ruby-value">:mssql</span>
<span class="line-num">753</span>     <span class="ruby-keyword">true</span>
<span class="line-num">754</span>   <span class="ruby-keyword">else</span>
<span class="line-num">755</span>     <span class="ruby-comment"># :nocov:</span>
<span class="line-num">756</span>     <span class="ruby-keyword">false</span>
<span class="line-num">757</span>     <span class="ruby-comment"># :nocov:</span>
<span class="line-num">758</span>   <span class="ruby-keyword">end</span>
<span class="line-num">759</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-use_date_arithmetic-3F'>
<a name='method-i-use_date_arithmetic-3F'></a>
<div class='synopsis'>
<span class='name'>use_date_arithmetic?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-use_date_arithmetic-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-use_date_arithmetic-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/active_sessions.rb</span>
<span class="line-num">204</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">use_date_arithmetic?</span>
<span class="line-num">205</span>   <span class="ruby-keyword">true</span>
<span class="line-num">206</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-use_json-3F'>
<a name='method-i-use_json-3F'></a>
<div class='synopsis'>
<span class='name'>use_json?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-use_json-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-use_json-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/json.rb</span>
<span class="line-num">60</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">use_json?</span>
<span class="line-num">61</span>   <span class="ruby-identifier">json_request?</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">only_json?</span>
<span class="line-num">62</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-use_jwt-3F'>
<a name='method-i-use_jwt-3F'></a>
<div class='synopsis'>
<span class='name'>use_jwt?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-use_jwt-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-use_jwt-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/jwt.rb</span>
<span class="line-num">90</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">use_jwt?</span>
<span class="line-num">91</span>   <span class="ruby-identifier">use_json?</span>
<span class="line-num">92</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-use_multi_phase_login-3F'>
<a name='method-i-use_multi_phase_login-3F'></a>
<div class='synopsis'>
<span class='name'>use_multi_phase_login?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-use_multi_phase_login-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-use_multi_phase_login-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/email_auth.rb</span>
<span class="line-num">156</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">use_multi_phase_login?</span>
<span class="line-num">157</span>   <span class="ruby-keyword">true</span>
<span class="line-num">158</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-use_request_specific_csrf_tokens-3F'>
<a name='method-i-use_request_specific_csrf_tokens-3F'></a>
<div class='synopsis'>
<span class='name'>use_request_specific_csrf_tokens?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-use_request_specific_csrf_tokens-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-use_request_specific_csrf_tokens-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">761</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">use_request_specific_csrf_tokens?</span>
<span class="line-num">762</span>   <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">opts</span>[<span class="ruby-value">:rodauth_route_csrf</span>] <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">use_request_specific_csrf_tokens?</span>
<span class="line-num">763</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-use_scope_clear_session-3F'>
<a name='method-i-use_scope_clear_session-3F'></a>
<div class='synopsis'>
<span class='name'>use_scope_clear_session?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-use_scope_clear_session-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-use_scope_clear_session-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">934</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">use_scope_clear_session?</span>
<span class="line-num">935</span>   <span class="ruby-identifier">scope</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:clear_session</span>)
<span class="line-num">936</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-uses_two_factor_authentication-3F'>
<a name='method-i-uses_two_factor_authentication-3F'></a>
<div class='synopsis'>
<span class='name'>uses_two_factor_authentication?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-uses_two_factor_authentication-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-uses_two_factor_authentication-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/two_factor_base.rb</span>
<span class="line-num">192</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">uses_two_factor_authentication?</span>
<span class="line-num">193</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">false</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">logged_in?</span>
<span class="line-num">194</span>   <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">two_factor_setup_session_key</span>, <span class="ruby-identifier">two_factor_authentication_setup?</span>) <span class="ruby-keyword">unless</span> <span class="ruby-identifier">session</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-identifier">two_factor_setup_session_key</span>)
<span class="line-num">195</span>   <span class="ruby-identifier">session</span>[<span class="ruby-identifier">two_factor_setup_session_key</span>]
<span class="line-num">196</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-valid_jwt-3F'>
<a name='method-i-valid_jwt-3F'></a>
<div class='synopsis'>
<span class='name'>valid_jwt?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-valid_jwt-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-valid_jwt-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/jwt.rb</span>
<span class="line-num"> 98</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">valid_jwt?</span>
<span class="line-num"> 99</span>   <span class="ruby-operator">!</span><span class="ruby-operator">!</span>(<span class="ruby-identifier">jwt_token</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">jwt_payload</span>)
<span class="line-num">100</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-valid_login_entered-3F'>
<a name='method-i-valid_login_entered-3F'></a>
<div class='synopsis'>
<span class='name'>valid_login_entered?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-valid_login_entered-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-valid_login_entered-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/login.rb</span>
<span class="line-num">126</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">valid_login_entered?</span>
<span class="line-num">127</span>   <span class="ruby-ivar">@valid_login_entered</span>
<span class="line-num">128</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-valid_new_webauthn_credential-3F'>
<a name='method-i-valid_new_webauthn_credential-3F'></a>
<div class='synopsis'>
<span class='name'>valid_new_webauthn_credential?</span><span class='arguments'>(webauthn_credential)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-valid_new_webauthn_credential-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-valid_new_webauthn_credential-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">314</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">valid_new_webauthn_credential?</span>(<span class="ruby-identifier">webauthn_credential</span>)
<span class="line-num">315</span>   <span class="ruby-identifier">_override_webauthn_credential_response_verify</span>(<span class="ruby-identifier">webauthn_credential</span>)
<span class="line-num">316</span>   (<span class="ruby-identifier">challenge</span> = <span class="ruby-identifier">param_or_nil</span>(<span class="ruby-identifier">webauthn_setup_challenge_param</span>)) <span class="ruby-operator">&amp;&amp;</span>
<span class="line-num">317</span>     (<span class="ruby-identifier">hmac</span> = <span class="ruby-identifier">param_or_nil</span>(<span class="ruby-identifier">webauthn_setup_challenge_hmac_param</span>)) <span class="ruby-operator">&amp;&amp;</span>
<span class="line-num">318</span>     (<span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">compute_hmac</span>(<span class="ruby-identifier">challenge</span>), <span class="ruby-identifier">hmac</span>) <span class="ruby-operator">||</span> (<span class="ruby-identifier">hmac_secret_rotation?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">compute_old_hmac</span>(<span class="ruby-identifier">challenge</span>), <span class="ruby-identifier">hmac</span>))) <span class="ruby-operator">&amp;&amp;</span>
<span class="line-num">319</span>     <span class="ruby-identifier">webauthn_credential</span>.<span class="ruby-identifier">verify</span>(<span class="ruby-identifier">challenge</span>)
<span class="line-num">320</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-valid_webauthn_credential_auth-3F'>
<a name='method-i-valid_webauthn_credential_auth-3F'></a>
<div class='synopsis'>
<span class='name'>valid_webauthn_credential_auth?</span><span class='arguments'>(webauthn_credential)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-valid_webauthn_credential_auth-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-valid_webauthn_credential_auth-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">362</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">valid_webauthn_credential_auth?</span>(<span class="ruby-identifier">webauthn_credential</span>)
<span class="line-num">363</span>   <span class="ruby-identifier">ds</span> = <span class="ruby-identifier">webauthn_keys_ds</span>.<span class="ruby-identifier">where</span>(<span class="ruby-identifier">webauthn_keys_webauthn_id_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">webauthn_credential</span>.<span class="ruby-identifier">id</span>)
<span class="line-num">364</span>   <span class="ruby-identifier">pub_key</span>, <span class="ruby-identifier">sign_count</span> = <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">get</span>([<span class="ruby-identifier">webauthn_keys_public_key_column</span>, <span class="ruby-identifier">webauthn_keys_sign_count_column</span>])
<span class="line-num">365</span> 
<span class="line-num">366</span>   <span class="ruby-identifier">_override_webauthn_credential_response_verify</span>(<span class="ruby-identifier">webauthn_credential</span>)
<span class="line-num">367</span>   (<span class="ruby-identifier">challenge</span> = <span class="ruby-identifier">param_or_nil</span>(<span class="ruby-identifier">webauthn_auth_challenge_param</span>)) <span class="ruby-operator">&amp;&amp;</span>
<span class="line-num">368</span>     (<span class="ruby-identifier">hmac</span> = <span class="ruby-identifier">param_or_nil</span>(<span class="ruby-identifier">webauthn_auth_challenge_hmac_param</span>)) <span class="ruby-operator">&amp;&amp;</span>
<span class="line-num">369</span>     (<span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">compute_hmac</span>(<span class="ruby-identifier">challenge</span>), <span class="ruby-identifier">hmac</span>) <span class="ruby-operator">||</span> (<span class="ruby-identifier">hmac_secret_rotation?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">timing_safe_eql?</span>(<span class="ruby-identifier">compute_old_hmac</span>(<span class="ruby-identifier">challenge</span>), <span class="ruby-identifier">hmac</span>))) <span class="ruby-operator">&amp;&amp;</span>
<span class="line-num">370</span>     <span class="ruby-identifier">webauthn_credential</span>.<span class="ruby-identifier">verify</span>(<span class="ruby-identifier">challenge</span>, <span class="ruby-value">public_key:</span> <span class="ruby-identifier">pub_key</span>, <span class="ruby-value">sign_count:</span> <span class="ruby-identifier">sign_count</span>) <span class="ruby-operator">&amp;&amp;</span>
<span class="line-num">371</span>     <span class="ruby-identifier">ds</span>.<span class="ruby-identifier">update</span>(
<span class="line-num">372</span>       <span class="ruby-identifier">webauthn_keys_sign_count_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Integer</span>(<span class="ruby-identifier">webauthn_credential</span>.<span class="ruby-identifier">sign_count</span>),
<span class="line-num">373</span>       <span class="ruby-identifier">webauthn_keys_last_use_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Sequel</span><span class="ruby-operator">::</span><span class="ruby-constant">CURRENT_TIMESTAMP</span>
<span class="line-num">374</span>     ) <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
<span class="line-num">375</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verified_account-3F'>
<a name='method-i-verified_account-3F'></a>
<div class='synopsis'>
<span class='name'>verified_account?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verified_account-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verified_account-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/verify_account_grace_period.rb</span>
<span class="line-num">17</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verified_account?</span>
<span class="line-num">18</span>   <span class="ruby-identifier">logged_in?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">session</span>[<span class="ruby-identifier">unverified_account_session_key</span>]
<span class="line-num">19</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_account'>
<a name='method-i-verify_account'></a>
<div class='synopsis'>
<span class='name'>verify_account</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_account-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_account-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_account.rb</span>
<span class="line-num">171</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_account</span>
<span class="line-num">172</span>   <span class="ruby-identifier">update_account</span>(<span class="ruby-identifier">account_status_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_open_status_value</span>) <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
<span class="line-num">173</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_account_check_already_logged_in'>
<a name='method-i-verify_account_check_already_logged_in'></a>
<div class='synopsis'>
<span class='name'>verify_account_check_already_logged_in</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_account_check_already_logged_in-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_account_check_already_logged_in-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_account.rb</span>
<span class="line-num">273</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_account_check_already_logged_in</span>
<span class="line-num">274</span>   <span class="ruby-identifier">check_already_logged_in</span>
<span class="line-num">275</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_account_ds'>
<a name='method-i-verify_account_ds'></a>
<div class='synopsis'>
<span class='name'>verify_account_ds</span><span class='arguments'>(id=account_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_account_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_account_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_account.rb</span>
<span class="line-num">298</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_account_ds</span>(<span class="ruby-identifier">id</span>=<span class="ruby-identifier">account_id</span>)
<span class="line-num">299</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">verify_account_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">verify_account_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">id</span>)
<span class="line-num">300</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_account_email_link'>
<a name='method-i-verify_account_email_link'></a>
<div class='synopsis'>
<span class='name'>verify_account_email_link</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_account_email_link-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_account_email_link-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_account.rb</span>
<span class="line-num">204</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_account_email_link</span>
<span class="line-num">205</span>   <span class="ruby-identifier">token_link</span>(<span class="ruby-identifier">verify_account_route</span>, <span class="ruby-identifier">verify_account_key_param</span>, <span class="ruby-identifier">verify_account_key_value</span>)
<span class="line-num">206</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_account_email_recently_sent-3F'>
<a name='method-i-verify_account_email_recently_sent-3F'></a>
<div class='synopsis'>
<span class='name'>verify_account_email_recently_sent?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_account_email_recently_sent-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_account_email_recently_sent-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_account.rb</span>
<span class="line-num">243</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_account_email_recently_sent?</span>
<span class="line-num">244</span>   <span class="ruby-identifier">account</span> <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-identifier">email_last_sent</span> = <span class="ruby-identifier">get_verify_account_email_last_sent</span>) <span class="ruby-operator">&amp;&amp;</span> (<span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">-</span> <span class="ruby-identifier">email_last_sent</span> <span class="ruby-operator">&lt;</span> <span class="ruby-identifier">verify_account_skip_resend_email_within</span>)
<span class="line-num">245</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_account_email_resend'>
<a name='method-i-verify_account_email_resend'></a>
<div class='synopsis'>
<span class='name'>verify_account_email_resend</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_account_email_resend-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_account_email_resend-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_account.rb</span>
<span class="line-num">175</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_account_email_resend</span>
<span class="line-num">176</span>   <span class="ruby-keyword">if</span> <span class="ruby-ivar">@verify_account_key_value</span> = <span class="ruby-identifier">get_verify_account_key</span>(<span class="ruby-identifier">account_id</span>)
<span class="line-num">177</span>     <span class="ruby-identifier">set_verify_account_email_last_sent</span>
<span class="line-num">178</span>     <span class="ruby-identifier">send_verify_account_email</span>
<span class="line-num">179</span>     <span class="ruby-keyword">true</span>
<span class="line-num">180</span>   <span class="ruby-keyword">end</span>
<span class="line-num">181</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_account_key_insert_hash'>
<a name='method-i-verify_account_key_insert_hash'></a>
<div class='synopsis'>
<span class='name'>verify_account_key_insert_hash</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_account_key_insert_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_account_key_insert_hash-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_account.rb</span>
<span class="line-num">294</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_account_key_insert_hash</span>
<span class="line-num">295</span>   {<span class="ruby-identifier">verify_account_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">verify_account_key_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">verify_account_key_value</span>}
<span class="line-num">296</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_account_set_password-3F'>
<a name='method-i-verify_account_set_password-3F'></a>
<div class='synopsis'>
<span class='name'>verify_account_set_password?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_account_set_password-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_account_set_password-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/verify_account_grace_period.rb</span>
<span class="line-num">29</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_account_set_password?</span>
<span class="line-num">30</span>   <span class="ruby-keyword">false</span>
<span class="line-num">31</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_account_view'>
<a name='method-i-verify_account_view'></a>
<div class='synopsis'>
<span class='name'>verify_account_view</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_account_view-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_account_view-source'>  <span class="ruby-comment"># File lib/rodauth/features/webauthn_verify_account.rb</span>
<span class="line-num">7</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_account_view</span>
<span class="line-num">8</span>   <span class="ruby-identifier">webauthn_setup_view</span>
<span class="line-num">9</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_login_change'>
<a name='method-i-verify_login_change'></a>
<div class='synopsis'>
<span class='name'>verify_login_change</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_login_change-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_login_change-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb</span>
<span class="line-num">112</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_login_change</span>
<span class="line-num">113</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">res</span> = <span class="ruby-identifier">_update_login</span>(<span class="ruby-identifier">verify_login_change_new_login</span>)
<span class="line-num">114</span>     <span class="ruby-identifier">remove_verify_login_change_key</span>
<span class="line-num">115</span>   <span class="ruby-keyword">end</span>
<span class="line-num">116</span> 
<span class="line-num">117</span>   <span class="ruby-identifier">res</span>
<span class="line-num">118</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_login_change_ds'>
<a name='method-i-verify_login_change_ds'></a>
<div class='synopsis'>
<span class='name'>verify_login_change_ds</span><span class='arguments'>(id=account_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_login_change_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_login_change_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb</span>
<span class="line-num">206</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_login_change_ds</span>(<span class="ruby-identifier">id</span>=<span class="ruby-identifier">account_id</span>)
<span class="line-num">207</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">verify_login_change_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">verify_login_change_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">id</span>)
<span class="line-num">208</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_login_change_email_body'>
<a name='method-i-verify_login_change_email_body'></a>
<div class='synopsis'>
<span class='name'>verify_login_change_email_body</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_login_change_email_body-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_login_change_email_body-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb</span>
<span class="line-num">202</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_login_change_email_body</span>
<span class="line-num">203</span>   <span class="ruby-identifier">render</span>(<span class="ruby-string">&#39;verify-login-change-email&#39;</span>)
<span class="line-num">204</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_login_change_email_link'>
<a name='method-i-verify_login_change_email_link'></a>
<div class='synopsis'>
<span class='name'>verify_login_change_email_link</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_login_change_email_link-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_login_change_email_link-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb</span>
<span class="line-num">128</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_login_change_email_link</span>
<span class="line-num">129</span>   <span class="ruby-identifier">token_link</span>(<span class="ruby-identifier">verify_login_change_route</span>, <span class="ruby-identifier">verify_login_change_key_param</span>, <span class="ruby-identifier">verify_login_change_key_value</span>)
<span class="line-num">130</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_login_change_key_insert_hash'>
<a name='method-i-verify_login_change_key_insert_hash'></a>
<div class='synopsis'>
<span class='name'>verify_login_change_key_insert_hash</span><span class='arguments'>(login)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_login_change_key_insert_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_login_change_key_insert_hash-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb</span>
<span class="line-num">192</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_login_change_key_insert_hash</span>(<span class="ruby-identifier">login</span>)
<span class="line-num">193</span>   <span class="ruby-identifier">hash</span> = {<span class="ruby-identifier">verify_login_change_id_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">account_id</span>, <span class="ruby-identifier">verify_login_change_key_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">verify_login_change_key_value</span>, <span class="ruby-identifier">verify_login_change_login_column</span><span class="ruby-operator">=&gt;</span><span class="ruby-identifier">login</span>}
<span class="line-num">194</span>   <span class="ruby-identifier">set_deadline_value</span>(<span class="ruby-identifier">hash</span>, <span class="ruby-identifier">verify_login_change_deadline_column</span>, <span class="ruby-identifier">verify_login_change_deadline_interval</span>)
<span class="line-num">195</span>   <span class="ruby-identifier">hash</span>
<span class="line-num">196</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-verify_login_change_old_login'>
<a name='method-i-verify_login_change_old_login'></a>
<div class='synopsis'>
<span class='name'>verify_login_change_old_login</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-verify_login_change_old_login-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-verify_login_change_old_login-source'>    <span class="ruby-comment"># File lib/rodauth/features/verify_login_change.rb</span>
<span class="line-num">140</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">verify_login_change_old_login</span>
<span class="line-num">141</span>   <span class="ruby-identifier">account_ds</span>.<span class="ruby-identifier">get</span>(<span class="ruby-identifier">login_column</span>)
<span class="line-num">142</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-view'>
<a name='method-i-view'></a>
<div class='synopsis'>
<span class='name'>view</span><span class='arguments'>(page, title)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-view-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-view-source'>    <span class="ruby-comment"># File lib/rodauth/features/base.rb</span>
<span class="line-num">424</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">view</span>(<span class="ruby-identifier">page</span>, <span class="ruby-identifier">title</span>)
<span class="line-num">425</span>   <span class="ruby-identifier">set_title</span>(<span class="ruby-identifier">title</span>)
<span class="line-num">426</span>   <span class="ruby-identifier">_view</span>(<span class="ruby-value">:view</span>, <span class="ruby-identifier">page</span>)
<span class="line-num">427</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_account_id'>
<a name='method-i-webauthn_account_id'></a>
<div class='synopsis'>
<span class='name'>webauthn_account_id</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_account_id-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_account_id-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">503</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_account_id</span>
<span class="line-num">504</span>   <span class="ruby-identifier">session_value</span>
<span class="line-num">505</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_allow'>
<a name='method-i-webauthn_allow'></a>
<div class='synopsis'>
<span class='name'>webauthn_allow</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_allow-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_allow-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">340</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_allow</span>
<span class="line-num">341</span>   <span class="ruby-identifier">account_webauthn_ids</span>
<span class="line-num">342</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_auth_additional_form_tags'>
<a name='method-i-webauthn_auth_additional_form_tags'></a>
<div class='synopsis'>
<span class='name'>webauthn_auth_additional_form_tags</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_auth_additional_form_tags-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_auth_additional_form_tags-source'>   <span class="ruby-comment"># File lib/rodauth/features/webauthn_login.rb</span>
<span class="line-num">43</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_auth_additional_form_tags</span>
<span class="line-num">44</span>   <span class="ruby-keyword">if</span> <span class="ruby-ivar">@webauthn_login</span>
<span class="line-num">45</span>     <span class="ruby-keyword">super</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">login_hidden_field</span>
<span class="line-num">46</span>   <span class="ruby-keyword">else</span>
<span class="line-num">47</span>     <span class="ruby-keyword">super</span>
<span class="line-num">48</span>   <span class="ruby-keyword">end</span>
<span class="line-num">49</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_auth_credential_from_form_submission'>
<a name='method-i-webauthn_auth_credential_from_form_submission'></a>
<div class='synopsis'>
<span class='name'>webauthn_auth_credential_from_form_submission</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_auth_credential_from_form_submission-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_auth_credential_from_form_submission-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">515</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_auth_credential_from_form_submission</span>
<span class="line-num">516</span>   <span class="ruby-keyword">begin</span>
<span class="line-num">517</span>     <span class="ruby-identifier">webauthn_credential</span> = <span class="ruby-identifier">webauthn_form_submission_call</span>(<span class="ruby-value">:from_get</span>, <span class="ruby-identifier">webauthn_auth_data</span>)
<span class="line-num">518</span> 
<span class="line-num">519</span>     <span class="ruby-keyword">unless</span> <span class="ruby-identifier">valid_webauthn_credential_auth?</span>(<span class="ruby-identifier">webauthn_credential</span>)
<span class="line-num">520</span>       <span class="ruby-identifier">throw_error_reason</span>(<span class="ruby-value">:invalid_webauthn_auth_param</span>, <span class="ruby-identifier">invalid_key_error_status</span>, <span class="ruby-identifier">webauthn_auth_param</span>, <span class="ruby-identifier">webauthn_invalid_auth_param_message</span>)
<span class="line-num">521</span>     <span class="ruby-keyword">end</span>
<span class="line-num">522</span>   <span class="ruby-keyword">rescue</span> <span class="ruby-constant">WebAuthn</span><span class="ruby-operator">::</span><span class="ruby-constant">SignCountVerificationError</span>
<span class="line-num">523</span>     <span class="ruby-identifier">handle_webauthn_sign_count_verification_error</span>
<span class="line-num">524</span>   <span class="ruby-keyword">rescue</span> <span class="ruby-constant">WebAuthn</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-constant">RuntimeError</span>, <span class="ruby-constant">NoMethodError</span>
<span class="line-num">525</span>     <span class="ruby-identifier">throw_error_reason</span>(<span class="ruby-value">:invalid_webauthn_auth_param</span>, <span class="ruby-identifier">invalid_field_error_status</span>, <span class="ruby-identifier">webauthn_auth_param</span>, <span class="ruby-identifier">webauthn_invalid_auth_param_message</span>) 
<span class="line-num">526</span>   <span class="ruby-keyword">end</span>
<span class="line-num">527</span> 
<span class="line-num">528</span>   <span class="ruby-identifier">webauthn_credential</span>
<span class="line-num">529</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_auth_data'>
<a name='method-i-webauthn_auth_data'></a>
<div class='synopsis'>
<span class='name'>webauthn_auth_data</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_auth_data-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_auth_data-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">531</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_auth_data</span>
<span class="line-num">532</span>   <span class="ruby-keyword">case</span> <span class="ruby-identifier">auth_data</span> = <span class="ruby-identifier">raw_param</span>(<span class="ruby-identifier">webauthn_auth_param</span>)
<span class="line-num">533</span>   <span class="ruby-keyword">when</span> <span class="ruby-constant">String</span>
<span class="line-num">534</span>     <span class="ruby-keyword">begin</span>
<span class="line-num">535</span>       <span class="ruby-constant">JSON</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">auth_data</span>)
<span class="line-num">536</span>     <span class="ruby-keyword">rescue</span>
<span class="line-num">537</span>       <span class="ruby-identifier">throw_error_reason</span>(<span class="ruby-value">:invalid_webauthn_auth_param</span>, <span class="ruby-identifier">invalid_field_error_status</span>, <span class="ruby-identifier">webauthn_auth_param</span>, <span class="ruby-identifier">webauthn_invalid_auth_param_message</span>) 
<span class="line-num">538</span>     <span class="ruby-keyword">end</span>
<span class="line-num">539</span>   <span class="ruby-keyword">when</span> <span class="ruby-constant">Hash</span>
<span class="line-num">540</span>     <span class="ruby-identifier">auth_data</span>
<span class="line-num">541</span>   <span class="ruby-keyword">else</span>
<span class="line-num">542</span>     <span class="ruby-identifier">throw_error_reason</span>(<span class="ruby-value">:invalid_webauthn_auth_param</span>, <span class="ruby-identifier">invalid_field_error_status</span>, <span class="ruby-identifier">webauthn_auth_param</span>, <span class="ruby-identifier">webauthn_invalid_auth_param_message</span>)
<span class="line-num">543</span>   <span class="ruby-keyword">end</span>
<span class="line-num">544</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_auth_form_path'>
<a name='method-i-webauthn_auth_form_path'></a>
<div class='synopsis'>
<span class='name'>webauthn_auth_form_path</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_auth_form_path-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_auth_form_path-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">247</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_auth_form_path</span>
<span class="line-num">248</span>   <span class="ruby-identifier">webauthn_auth_path</span>
<span class="line-num">249</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_authenticator_selection'>
<a name='method-i-webauthn_authenticator_selection'></a>
<div class='synopsis'>
<span class='name'>webauthn_authenticator_selection</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_authenticator_selection-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_authenticator_selection-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">263</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_authenticator_selection</span>
<span class="line-num">264</span>   {<span class="ruby-string">&#39;requireResidentKey&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-keyword">false</span>, <span class="ruby-string">&#39;userVerification&#39;</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">webauthn_user_verification</span>}
<span class="line-num">265</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_create_relying_party_opts'>
<a name='method-i-webauthn_create_relying_party_opts'></a>
<div class='synopsis'>
<span class='name'>webauthn_create_relying_party_opts</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_create_relying_party_opts-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_create_relying_party_opts-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">434</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_create_relying_party_opts</span>
<span class="line-num">435</span>   { <span class="ruby-value">:relying_party</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">webauthn_relying_party</span> }
<span class="line-num">436</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_credential_options_for_get'>
<a name='method-i-webauthn_credential_options_for_get'></a>
<div class='synopsis'>
<span class='name'>webauthn_credential_options_for_get</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_credential_options_for_get-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_credential_options_for_get-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">322</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_credential_options_for_get</span>
<span class="line-num">323</span>   <span class="ruby-constant">WebAuthn</span><span class="ruby-operator">::</span><span class="ruby-constant">Credential</span>.<span class="ruby-identifier">options_for_get</span>(
<span class="line-num">324</span>     <span class="ruby-value">:allow</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">webauthn_allow</span>,
<span class="line-num">325</span>     <span class="ruby-value">:timeout</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">webauthn_auth_timeout</span>,
<span class="line-num">326</span>     <span class="ruby-value">:user_verification</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">webauthn_user_verification</span>,
<span class="line-num">327</span>     <span class="ruby-value">:extensions</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">webauthn_extensions</span>,
<span class="line-num">328</span>     <span class="ruby-operator">**</span><span class="ruby-identifier">webauthn_get_relying_party_opts</span>
<span class="line-num">329</span>   )
<span class="line-num">330</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_extensions'>
<a name='method-i-webauthn_extensions'></a>
<div class='synopsis'>
<span class='name'>webauthn_extensions</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_extensions-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_extensions-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">267</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_extensions</span>
<span class="line-num">268</span>   {}
<span class="line-num">269</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_form_submission_call'>
<a name='method-i-webauthn_form_submission_call'></a>
<div class='synopsis'>
<span class='name'>webauthn_form_submission_call</span><span class='arguments'>(meth, arg)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_form_submission_call-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_form_submission_call-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">439</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_form_submission_call</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-identifier">arg</span>)
<span class="line-num">440</span>   <span class="ruby-constant">WebAuthn</span><span class="ruby-operator">::</span><span class="ruby-constant">Credential</span>.<span class="ruby-identifier">public_send</span>(<span class="ruby-identifier">meth</span>, <span class="ruby-identifier">arg</span>, <span class="ruby-value">:relying_party</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">webauthn_relying_party</span>)
<span class="line-num">441</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_key_insert_hash'>
<a name='method-i-webauthn_key_insert_hash'></a>
<div class='synopsis'>
<span class='name'>webauthn_key_insert_hash</span><span class='arguments'>(webauthn_credential)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_key_insert_hash-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_key_insert_hash-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">494</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_key_insert_hash</span>(<span class="ruby-identifier">webauthn_credential</span>)
<span class="line-num">495</span>   {
<span class="line-num">496</span>     <span class="ruby-identifier">webauthn_keys_account_id_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">webauthn_account_id</span>,
<span class="line-num">497</span>     <span class="ruby-identifier">webauthn_keys_webauthn_id_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">webauthn_credential</span>.<span class="ruby-identifier">id</span>,
<span class="line-num">498</span>     <span class="ruby-identifier">webauthn_keys_public_key_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">webauthn_credential</span>.<span class="ruby-identifier">public_key</span>,
<span class="line-num">499</span>     <span class="ruby-identifier">webauthn_keys_sign_count_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-constant">Integer</span>(<span class="ruby-identifier">webauthn_credential</span>.<span class="ruby-identifier">sign_count</span>)
<span class="line-num">500</span>   }
<span class="line-num">501</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_keys_ds'>
<a name='method-i-webauthn_keys_ds'></a>
<div class='synopsis'>
<span class='name'>webauthn_keys_ds</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_keys_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_keys_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">511</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_keys_ds</span>
<span class="line-num">512</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">webauthn_keys_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">webauthn_keys_account_id_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">webauthn_account_id</span>)
<span class="line-num">513</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_login_options-3F'>
<a name='method-i-webauthn_login_options-3F'></a>
<div class='synopsis'>
<span class='name'>webauthn_login_options?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_login_options-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_login_options-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/webauthn_autofill.rb</span>
<span class="line-num">60</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_login_options?</span>
<span class="line-num">61</span>   <span class="ruby-keyword">return</span> <span class="ruby-keyword">true</span> <span class="ruby-keyword">unless</span> <span class="ruby-identifier">param_or_nil</span>(<span class="ruby-identifier">login_param</span>)
<span class="line-num">62</span>   <span class="ruby-keyword">super</span>
<span class="line-num">63</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_login_verification_factor-3F'>
<a name='method-i-webauthn_login_verification_factor-3F'></a>
<div class='synopsis'>
<span class='name'>webauthn_login_verification_factor?</span><span class='arguments'>(webauthn_credential)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_login_verification_factor-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_login_verification_factor-3F-source'>   <span class="ruby-comment"># File lib/rodauth/features/webauthn_login.rb</span>
<span class="line-num">70</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_login_verification_factor?</span>(<span class="ruby-identifier">webauthn_credential</span>)
<span class="line-num">71</span>   <span class="ruby-identifier">webauthn_login_user_verification_additional_factor?</span> <span class="ruby-operator">&amp;&amp;</span>
<span class="line-num">72</span>     <span class="ruby-identifier">webauthn_credential</span>.<span class="ruby-identifier">response</span>.<span class="ruby-identifier">authenticator_data</span>.<span class="ruby-identifier">user_verified?</span> <span class="ruby-operator">&amp;&amp;</span>
<span class="line-num">73</span>     <span class="ruby-identifier">uses_two_factor_authentication?</span>
<span class="line-num">74</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_origin'>
<a name='method-i-webauthn_origin'></a>
<div class='synopsis'>
<span class='name'>webauthn_origin</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_origin-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_origin-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">336</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_origin</span>
<span class="line-num">337</span>   <span class="ruby-identifier">base_url</span>
<span class="line-num">338</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_relying_party'>
<a name='method-i-webauthn_relying_party'></a>
<div class='synopsis'>
<span class='name'>webauthn_relying_party</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_relying_party-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_relying_party-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">414</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_relying_party</span>
<span class="line-num">415</span>   <span class="ruby-comment"># No need to memoize, only called once per request</span>
<span class="line-num">416</span>   <span class="ruby-constant">WebAuthn</span><span class="ruby-operator">::</span><span class="ruby-constant">RelyingParty</span>.<span class="ruby-identifier">new</span>(
<span class="line-num">417</span>     <span class="ruby-value">allowed_origins:</span> [<span class="ruby-identifier">webauthn_origin</span>],
<span class="line-num">418</span>     <span class="ruby-value">id:</span> <span class="ruby-identifier">webauthn_rp_id</span>,
<span class="line-num">419</span>     <span class="ruby-value">name:</span> <span class="ruby-identifier">webauthn_rp_name</span>,
<span class="line-num">420</span>   )
<span class="line-num">421</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_remove_authenticated_session'>
<a name='method-i-webauthn_remove_authenticated_session'></a>
<div class='synopsis'>
<span class='name'>webauthn_remove_authenticated_session</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_remove_authenticated_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_remove_authenticated_session-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">255</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_remove_authenticated_session</span>
<span class="line-num">256</span>   <span class="ruby-identifier">remove_session_value</span>(<span class="ruby-identifier">authenticated_webauthn_id_session_key</span>)
<span class="line-num">257</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_rp_id'>
<a name='method-i-webauthn_rp_id'></a>
<div class='synopsis'>
<span class='name'>webauthn_rp_id</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_rp_id-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_rp_id-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">344</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_rp_id</span>
<span class="line-num">345</span>   <span class="ruby-identifier">webauthn_origin</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/\Ahttps?:\/\//</span>, <span class="ruby-string">&#39;&#39;</span>).<span class="ruby-identifier">sub</span>(<span class="ruby-regexp">/:\d+\z/</span>, <span class="ruby-string">&#39;&#39;</span>)
<span class="line-num">346</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_rp_name'>
<a name='method-i-webauthn_rp_name'></a>
<div class='synopsis'>
<span class='name'>webauthn_rp_name</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_rp_name-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_rp_name-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">348</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_rp_name</span>
<span class="line-num">349</span>   <span class="ruby-identifier">webauthn_rp_id</span>
<span class="line-num">350</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_setup-3F'>
<a name='method-i-webauthn_setup-3F'></a>
<div class='synopsis'>
<span class='name'>webauthn_setup?</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_setup-3F-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_setup-3F-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">386</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_setup?</span>
<span class="line-num">387</span>   <span class="ruby-operator">!</span><span class="ruby-identifier">webauthn_keys_ds</span>.<span class="ruby-identifier">empty?</span>
<span class="line-num">388</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_setup_credential_from_form_submission'>
<a name='method-i-webauthn_setup_credential_from_form_submission'></a>
<div class='synopsis'>
<span class='name'>webauthn_setup_credential_from_form_submission</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_setup_credential_from_form_submission-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_setup_credential_from_form_submission-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">546</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_setup_credential_from_form_submission</span>
<span class="line-num">547</span>   <span class="ruby-keyword">unless</span> <span class="ruby-identifier">two_factor_password_match?</span>(<span class="ruby-identifier">param</span>(<span class="ruby-identifier">password_param</span>))
<span class="line-num">548</span>     <span class="ruby-identifier">throw_error_reason</span>(<span class="ruby-value">:invalid_password</span>, <span class="ruby-identifier">invalid_password_error_status</span>, <span class="ruby-identifier">password_param</span>, <span class="ruby-identifier">invalid_password_message</span>)
<span class="line-num">549</span>   <span class="ruby-keyword">end</span>
<span class="line-num">550</span> 
<span class="line-num">551</span>   <span class="ruby-keyword">begin</span>
<span class="line-num">552</span>     <span class="ruby-identifier">webauthn_credential</span> = <span class="ruby-identifier">webauthn_form_submission_call</span>(<span class="ruby-value">:from_create</span>, <span class="ruby-identifier">webauthn_setup_data</span>)
<span class="line-num">553</span> 
<span class="line-num">554</span>     <span class="ruby-keyword">unless</span> <span class="ruby-identifier">valid_new_webauthn_credential?</span>(<span class="ruby-identifier">webauthn_credential</span>)
<span class="line-num">555</span>       <span class="ruby-identifier">throw_error_reason</span>(<span class="ruby-value">:invalid_webauthn_setup_param</span>, <span class="ruby-identifier">invalid_field_error_status</span>, <span class="ruby-identifier">webauthn_setup_param</span>, <span class="ruby-identifier">webauthn_invalid_setup_param_message</span>) 
<span class="line-num">556</span>     <span class="ruby-keyword">end</span>
<span class="line-num">557</span>   <span class="ruby-keyword">rescue</span> <span class="ruby-constant">WebAuthn</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-constant">RuntimeError</span>, <span class="ruby-constant">NoMethodError</span>
<span class="line-num">558</span>     <span class="ruby-identifier">throw_error_reason</span>(<span class="ruby-value">:invalid_webauthn_setup_param</span>, <span class="ruby-identifier">invalid_field_error_status</span>, <span class="ruby-identifier">webauthn_setup_param</span>, <span class="ruby-identifier">webauthn_invalid_setup_param_message</span>) 
<span class="line-num">559</span>   <span class="ruby-keyword">end</span>
<span class="line-num">560</span> 
<span class="line-num">561</span>   <span class="ruby-identifier">webauthn_credential</span>
<span class="line-num">562</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_setup_data'>
<a name='method-i-webauthn_setup_data'></a>
<div class='synopsis'>
<span class='name'>webauthn_setup_data</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_setup_data-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_setup_data-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">564</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_setup_data</span>
<span class="line-num">565</span>   <span class="ruby-keyword">case</span> <span class="ruby-identifier">setup_data</span> = <span class="ruby-identifier">raw_param</span>(<span class="ruby-identifier">webauthn_setup_param</span>)
<span class="line-num">566</span>   <span class="ruby-keyword">when</span> <span class="ruby-constant">String</span>
<span class="line-num">567</span>     <span class="ruby-keyword">begin</span>
<span class="line-num">568</span>       <span class="ruby-constant">JSON</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">setup_data</span>)
<span class="line-num">569</span>     <span class="ruby-keyword">rescue</span>
<span class="line-num">570</span>       <span class="ruby-identifier">throw_error_reason</span>(<span class="ruby-value">:invalid_webauthn_setup_param</span>, <span class="ruby-identifier">invalid_field_error_status</span>, <span class="ruby-identifier">webauthn_setup_param</span>, <span class="ruby-identifier">webauthn_invalid_setup_param_message</span>) 
<span class="line-num">571</span>     <span class="ruby-keyword">end</span>
<span class="line-num">572</span>   <span class="ruby-keyword">when</span> <span class="ruby-constant">Hash</span>
<span class="line-num">573</span>     <span class="ruby-identifier">setup_data</span>
<span class="line-num">574</span>   <span class="ruby-keyword">else</span>
<span class="line-num">575</span>     <span class="ruby-identifier">throw_error_reason</span>(<span class="ruby-value">:invalid_webauthn_setup_param</span>, <span class="ruby-identifier">invalid_field_error_status</span>, <span class="ruby-identifier">webauthn_setup_param</span>, <span class="ruby-identifier">webauthn_invalid_setup_param_message</span>)
<span class="line-num">576</span>   <span class="ruby-keyword">end</span>
<span class="line-num">577</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_update_session'>
<a name='method-i-webauthn_update_session'></a>
<div class='synopsis'>
<span class='name'>webauthn_update_session</span><span class='arguments'>(webauthn_id)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_update_session-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_update_session-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">259</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_update_session</span>(<span class="ruby-identifier">webauthn_id</span>)
<span class="line-num">260</span>   <span class="ruby-identifier">set_session_value</span>(<span class="ruby-identifier">authenticated_webauthn_id_session_key</span>, <span class="ruby-identifier">webauthn_id</span>)
<span class="line-num">261</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_user_ids_ds'>
<a name='method-i-webauthn_user_ids_ds'></a>
<div class='synopsis'>
<span class='name'>webauthn_user_ids_ds</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_user_ids_ds-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_user_ids_ds-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">507</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_user_ids_ds</span>
<span class="line-num">508</span>   <span class="ruby-identifier">db</span>[<span class="ruby-identifier">webauthn_user_ids_table</span>].<span class="ruby-identifier">where</span>(<span class="ruby-identifier">webauthn_user_ids_account_id_column</span> <span class="ruby-operator">=&gt;</span> <span class="ruby-identifier">webauthn_account_id</span>)
<span class="line-num">509</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_user_name'>
<a name='method-i-webauthn_user_name'></a>
<div class='synopsis'>
<span class='name'>webauthn_user_name</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_user_name-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_user_name-source'>    <span class="ruby-comment"># File lib/rodauth/features/webauthn.rb</span>
<span class="line-num">332</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_user_name</span>
<span class="line-num">333</span>   <span class="ruby-identifier">account!</span>[<span class="ruby-identifier">login_column</span>]
<span class="line-num">334</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
<div class='method public-instance' id='method-method-i-webauthn_user_verification'>
<a name='method-i-webauthn_user_verification'></a>
<div class='synopsis'>
<span class='name'>webauthn_user_verification</span><span class='arguments'>()</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-i-webauthn_user_verification-source&#39;); return false'>
[show source]
</a>
<pre id='method-i-webauthn_user_verification-source'>   <span class="ruby-comment"># File lib/rodauth/features/webauthn_autofill.rb</span>
<span class="line-num">25</span> <span class="ruby-keyword">def</span> <span class="ruby-identifier ruby-title">webauthn_user_verification</span>
<span class="line-num">26</span>   <span class="ruby-string">&#39;preferred&#39;</span>
<span class="line-num">27</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
</div>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/jeremyevans/hanna"><strong>Hanna</strong> RDoc template</a>
</div>
</body>
</html>
